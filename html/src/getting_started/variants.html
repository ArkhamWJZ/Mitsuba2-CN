<!-- Based on https://stackoverflow.com/a/25543713/1130282 -->

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>选择变体 &#8212; mitsuba2 0.1.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compiling the system" href="compiling.html" />
    <link rel="prev" title="Cloning the repository" href="cloning.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="compiling.html" title="Compiling the system"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cloning.html" title="Cloning the repository"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">选择变体</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../../index.html" class="text-logo">Mitsuba 2</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloning.html">Cloning the repository</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">选择变体</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#part-1-computational-backend">Part 1: Computational backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="#part-2-color-representation">Part 2: Color representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#part-3-polarization">Part 3: Polarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#part-4-precision">Part 4: Precision</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-mitsuba-conf">Configuring <span class="monosp">mitsuba.conf</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html">Compiling the system</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_format.html">Scene file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="differences.html">Differences to Mitsuba 0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Python interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/parsing_xml.html">Parsing XML code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/rendering_scene.html">Rendering a scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/bsdf_eval.html">Custom applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Inverse rendering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/diff_render.html">Differentiable rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/advanced.html">More advanced examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/pytorch.html">Integration with PyTorch</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/variants_cpp.html">Variants in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/writing_plugin.html">Plugins &amp; Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/building_documentation.html">Building the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/polarization.html">Polarization</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/custom_plugins.html">Custom plugins in Python</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugin reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugin_reference/intro.html">Plugin reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html">Shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#bsdfs">BSDFs 大大大</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#phase-functions">Phase functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#emitters">Emitters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#sensors">Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#textures">Textures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#spectra">Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#integrators">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#samplers">Samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#films">Films</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#reconstruction-filters">Reconstruction filters</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/core_api.html">Core API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/render_api.html">Render API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/python_api.html">Python API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zz_bibliography.html">Bibliography</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
              <li>选择变体</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="sec-variants">
<span id="id1"></span><h1>选择变体<a class="headerlink" href="#sec-variants" title="Permalink to this headline">¶</a></h1>
<p>Mitsuba 2是一个可被用户重新定义的渲染系统，通过提供一系列不同的 “<em>变体 variants</em>” 以改变系统在模拟时的表现，
诸如改变颜色的表现形式为单色光，RGB，频谱，甚至可以是偏振光照明（polarized illumination）。
类似的，在渲染过程下的数值处理形式也可以进行更换，如使用更高的准确度，矢量化一次处理多条光路，或者在数学上求解
反问题。 所有这些变体（variants）都是从通用代码库中自动创建的。</p>
<p>目前为止有多达36种不同的渲染器变体可用，如下面列表所示。 因此，在构建 Mitsuba 2之前，你需要确定其中哪些是
与你想要的应用功能相关的。</p>
<blockquote>
<div><div class="toggle docutils container">
<div class="header docutils container">
<p><strong>Show/hide available variants</strong></p>
</div>
<ul class="simple">
<li><p><span class="monosp">scalar_mono</span></p></li>
<li><p><span class="monosp">scalar_mono_double</span></p></li>
<li><p><span class="monosp">scalar_mono_polarized</span></p></li>
<li><p><span class="monosp">scalar_mono_polarized_double</span></p></li>
<li><p><span class="monosp">scalar_rgb</span></p></li>
<li><p><span class="monosp">scalar_rgb_double</span></p></li>
<li><p><span class="monosp">scalar_rgb_polarized</span></p></li>
<li><p><span class="monosp">scalar_rgb_polarized_double</span></p></li>
<li><p><span class="monosp">scalar_spectral</span></p></li>
<li><p><span class="monosp">scalar_spectral_double</span></p></li>
<li><p><span class="monosp">scalar_spectral_polarized</span></p></li>
<li><p><span class="monosp">scalar_spectral_polarized_double</span></p></li>
<li><p><span class="monosp">packet_mono</span></p></li>
<li><p><span class="monosp">packet_mono_double</span></p></li>
<li><p><span class="monosp">packet_mono_polarized</span></p></li>
<li><p><span class="monosp">packet_mono_polarized_double</span></p></li>
<li><p><span class="monosp">packet_rgb</span></p></li>
<li><p><span class="monosp">packet_rgb_double</span></p></li>
<li><p><span class="monosp">packet_rgb_polarized</span></p></li>
<li><p><span class="monosp">packet_rgb_polarized_double</span></p></li>
<li><p><span class="monosp">packet_spectral</span></p></li>
<li><p><span class="monosp">packet_spectral_double</span></p></li>
<li><p><span class="monosp">packet_spectral_polarized</span></p></li>
<li><p><span class="monosp">packet_spectral_polarized_double</span></p></li>
<li><p><span class="monosp">gpu_mono</span></p></li>
<li><p><span class="monosp">gpu_mono_polarized</span></p></li>
<li><p><span class="monosp">gpu_rgb</span></p></li>
<li><p><span class="monosp">gpu_rgb_polarized</span></p></li>
<li><p><span class="monosp">gpu_spectral</span></p></li>
<li><p><span class="monosp">gpu_spectral_polarized</span></p></li>
<li><p><span class="monosp">gpu_autodiff_mono</span></p></li>
<li><p><span class="monosp">gpu_autodiff_mono_polarized</span></p></li>
<li><p><span class="monosp">gpu_autodiff_rgb</span></p></li>
<li><p><span class="monosp">gpu_autodiff_rgb_polarized</span></p></li>
<li><p><span class="monosp">gpu_autodiff_spectral</span></p></li>
<li><p><span class="monosp">gpu_autodiff_spectral_polarized</span></p></li>
</ul>
</div>
</div></blockquote>
<p>需要注意的是，编译时间和编译内存的占用量与启用的变体数目成正比， 因此包含过多的变体数目（如超过5个）
是不可取的。 Mitsuba 2 开发者通常会想要限制当前实验使用1-2个系统变体，以最大程度的减少编辑后的重新编译时间。
每一个变体都与一个标识名称相关联，该名称由几个部分组成：</p>
<a class="reference internal image-reference" href="../../_images/variant.svg"><img alt="../../_images/variant.svg" class="align-center" src="../../_images/variant.svg" width="80%" /></a>
<p>接下来我们将依次讨论每一部分的含义。</p>
<div class="section" id="part-1-computational-backend">
<h2>Part 1: Computational backend<a class="headerlink" href="#part-1-computational-backend" title="Permalink to this headline">¶</a></h2>
<p>计算后端部分控制系统如何去实现加法或者乘法等基本运算模块。有以下选项可以选择：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scalar</span></code> 后端在 CPU 上使用和旧版 Mitsuba 类似的普通浮点数运算。</p></li>
</ul>
<blockquote>
<div><p>这是在命令行上使用 <span class="monosp">mitsuba</span> 指令或者通过图形用户界面生成渲染图时的默认设置。</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">packet</span></code> 后端使用SSE4.2、AVX、AVX2 及 AVX512扩展指令集，可以高效的对4、8或16的</p></li>
</ul>
<blockquote>
<div><p>浮点数组进行计算。因此在 packet 模式下, 渲染算法中的每个单一操作（光线追踪， BSDF 采样等）
将一次对多个输入进行操作。下面👇可视化出来的光路很好的展示出了scalar 和 packet 两种模式的
不同之处：</p>
<a class="reference internal image-reference" href="../../_images/vectorization.jpg"><img alt="../../_images/vectorization.jpg" class="align-center" src="../../_images/vectorization.jpg" style="width: 100%;" /></a>
<p>然而，需要注意的是，packet 模式不是万能解药：标准算法不会就此简单的加快8倍或16倍。
Packet 模式需要特殊的算法设计，而且意在给那些能利用并行特性的软件开发者使用。</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code> 后端通过使用 <a class="reference external" href="https://github.com/mitsuba-renderer/enoki">Enoki’s</a></p></li>
</ul>
<blockquote>
<div><p>just-in-time (JIT) 编译器将计算转移到 CUDA 内核中。 通过使用这个后端，每个操作通常需要
同时操作数百万个输入。之后 Mitsuba 就变成了我们熟知的 <em>波阵面(wavefront)路径追踪器</em> 其中</p>
<blockquote>
<div><p>GPU 上的光线追踪部分委托给了 NVIDIA 的 OptiX 库。 需要注意的是，我们需要相对较新的 NVIDIA GPU 架构:</p>
</div></blockquote>
<p>最好是 <em>Turing</em> 或者其他更新的版本。较旧的 <em>Pascal</em> 架构也是支持的，但速度往往会比较慢，因为它
缺乏光线跟踪的硬件加速。</p>
</div></blockquote>
<ul>
<li><p>在 <code class="docutils literal notranslate"><span class="pre">gpu</span></code> 后端构建项目时，此外可以使用 <code class="docutils literal notranslate"><span class="pre">gpu_autodiff</span></code> 通过模拟器传播导数信息, 这是渲染算法
解决 <em>逆问题</em> 的关键要素。</p>
<p>下面展示了来自 :cite:<a href="#id2"><span class="problematic" id="id3">`</span></a>NimierDavidVicini2019Mitsuba2`的示例。在这里，Mitsuba 2 被用来计算透明玻璃
板的高度轮廓，该玻璃板可以折射红、绿、蓝光，以此来重现指定的彩色图像。</p>
<p><span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span> 将输入 <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> (场景描述信息) 转化为输出 <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> (渲染结果)。
随后对此函数 <span class="math notranslate nohighlight">\(f\)</span> 求微分得到 <span class="math notranslate nohighlight">\(\frac{\mathrm{d}\mathbf{y}}{\mathrm{d}\mathbf{x}}\)</span>，这提供了一个
关于输出 <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> (渲染结果) 随着输入 <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> (场景描述信息) 改变而理想化改变的一阶近似。
再加上一个可微 <em>目标函数</em> <span class="math notranslate nohighlight">\(g(\mathbf{y})\)</span> 来量化场景参数的适用性再再搞一个梯度优化算法，这样一个可微渲染器就
可以用来解决涉及到光的复杂逆问题了。</p>
<a class="reference internal image-reference" href="../../_images/autodiff.jpg"><img alt="../../_images/autodiff.jpg" class="align-center" src="../../_images/autodiff.jpg" style="width: 100%;" /></a>
<p>文档提供了几个关于 <a class="reference internal" href="../inverse_rendering/intro.html#sec-inverse-rendering"><span class="std std-ref">differentiable and inverse rendering</span></a>。的应用示例。</p>
</li>
</ul>
<p>一个关于 <code class="docutils literal notranslate"><span class="pre">packet</span></code>， <code class="docutils literal notranslate"><span class="pre">gpu</span></code>，和 <code class="docutils literal notranslate"><span class="pre">gpu_autodiff</span></code> 模式的吸引人的地方在于，它们公开了对任意大的输入集进行矢量化操作
的 Python 接口（即使在小容量序列上工作 <code class="docutils literal notranslate"><span class="pre">packet</span></code> 模式下，C++ 还是实现覆盖了较大的输入）。 这意味着可以通过
一个 Python 函数调用执行数百万次光线追踪操作或 BSDF 计算，从而在 Python 或 Jupyter notebook中实现高效的原型设计，
而无需对许多元素进行昂贵的迭代操作。</p>
<div class="section" id="id4">
<h3>如何去选择合适的变体模式？<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>我们一般建议通过命令行渲染时编译 <code class="docutils literal notranslate"><span class="pre">scalar</span></code> 变体，至于 <code class="docutils literal notranslate"><span class="pre">packet</span></code> 或 <code class="docutils literal notranslate"><span class="pre">gpu_autodiff</span></code> 变体则是为 Python 开发准备
的—而后者只有在用到可微渲染时才会被需要。</p>
</div>
</div>
<div class="section" id="part-2-color-representation">
<h2>Part 2: Color representation<a class="headerlink" href="#part-2-color-representation" title="Permalink to this headline">¶</a></h2>
<p>下一部分决定了 Mitsuba 如何表示颜色信息。有以下选项可供选择：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mono</span></code> 模式完全禁用了颜色的概念，这在模拟具有固定单一颜色的场景时会十分有用（例如激光照明）。
这种模式非常适合编写那些颜色完全不相关的测试用例。当输入场景提供颜色信息时，<span class="monosp">mono</span>
模式会自动将其转换为灰度。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgb</span></code> 模式使用基于 RGB 的颜色表示。这是一个个合乎逻辑的默认选项，并且符合上一代 Mitsuba 的默认
行为。而在另一方面，RGB 模式可能与现实世界中的颜色工作方式不太接近。 请点击以下内容查看更详细的解释。</p>
<blockquote>
<div><div class="toggle docutils container">
<div class="header docutils container">
<p><strong>基于 RGB 渲染的问题 (点击展开)</strong></p>
</div>
<p><strong>基于 RGB 表示 的颜色存在的问题：</strong> RGB 渲染算法通常执行两种与颜色相关的操作:逐分量相加以组
合不同的光源，在模型间相互反射时 RGB 颜色向量逐分量相乘。虽然加法很好，但 RGB 乘法结果是一个荒
谬的操作，根据底层 RGB 颜色空间，它可以给出非常不同的答案。</p>
<p>假设我们在 sRGB 颜色空间中渲染一个场景，有一个辐射度为:math:<code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1]</span></code> 的绿色光源，其在一个
绿色平面上的反射率是 <span class="math notranslate nohighlight">\([0, 0, 1]\)</span>。逐分量相乘 <span class="math notranslate nohighlight">\([0, 0, 1] \otimes [0, 0, 1] = [0, 0, 1]\)</span>
的结果诉我们没有光被该绿色表面吸收。到目前为止还不错。</p>
<p>接下来让我们切换到一个更大一些的颜色空间 <em>Rec. 2020</em>。这时同样的绿色不在位于色域的边界上，而是处于色域内部的
某个地方。</p>
<a class="reference internal image-reference" href="../../_images/rgb-mode-issue.svg"><img alt="../../_images/rgb-mode-issue.svg" class="align-center" src="../../_images/rgb-mode-issue.svg" width="100%" /></a>
<p>简单起见，我们假设其坐标为 <span class="math notranslate nohighlight">\([0, 0, \frac{1}{2}]\)</span> 。根据与之前相同的计算过程 <span class="math notranslate nohighlight">\([0, 0, \frac{1}{2}]\otimes[0, 0, \frac{1}{2}]=[0, 0, \frac{1}{4}]\)</span>
我们能得到一个结论：有一半的光被表面吸收掉了，而这恰恰说明了 RGB 乘法的问题。这个问题的解决方案就是在光谱域中进行颜色相乘。</p>
</div>
</div></blockquote>
</li>
<li><p>最后要说的是，<code class="docutils literal notranslate"><span class="pre">spectral</span></code> 模式下生成了一个横贯可见范围的全光谱颜色表示 <span class="math notranslate nohighlight">\((360\ldots 830 \mathrm{nm})\)</span>。
波长的维度可以被简单地看作是渲染算法整合的光路空间的另一个维度。</p>
<p>这提高了计算的精度，特别是在光谱测量数据可用的情况下。例如，以下两个 Cornell box 的渲染结果：
左侧的渲染图，首先将所有材质的光谱反射率数据转换成 RGB ，随后使用 <code class="docutils literal notranslate"><span class="pre">scalar_rgb</span></code> 变体进行渲染，
从而生成了具有欺骗性的彩色渲染图。相比之下，能够正确解释光谱特性的 <code class="docutils literal notranslate"><span class="pre">scalar_spectral</span></code> 变体模式，
渲染出来的结果更为柔和。</p>
<div class="figure compound align-center" id="fig-cbox-spectral">
<div style="width: 49%" class="subfigure align-center" id="id7">
<a class="reference internal image-reference" href="../../_images/variants_cbox_rgb.jpg"><img alt="../../_images/variants_cbox_rgb.jpg" src="../../_images/variants_cbox_rgb.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">RGB Mode</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/variants_cbox_spectral.jpg"><img alt="../../_images/variants_cbox_spectral.jpg" src="../../_images/variants_cbox_spectral.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Spectral Mode</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-cbox-spectral">需要注意的是，即使在光谱模式被激活时，Mitsuba 在默认情况下仍会生成 RGB 输出图像。除此之外，许多
现有的 Mitsuba 场景只提供 RGB 颜色信息。不过光谱模式下 Mitsuba 仍然可以渲染这些的场景，
它可以确定指定 RGB 颜色所对应的近似平滑光谱 <a class="bibtex reference internal" href="../../zz_bibliography.html#jakob2019spectral" id="id5">[JH19]</a>。</p>
</li>
</ul>
</div>
<div class="section" id="part-3-polarization">
<h2>Part 3: Polarization<a class="headerlink" href="#part-3-polarization" title="Permalink to this headline">¶</a></h2>
<p>如果需要的话，Mitsuba 2 可以追踪光的整个偏振状态。偏振是指光的振荡方向垂直于传播方向的特性，属于电磁波特性。
振荡的形状有无数多种，下面的图片展示的是 <em>水平型</em> 和 <em>椭圆型</em> 偏振的例子。</p>
<a class="reference internal image-reference" href="../../_images/polarization_wave_variations.svg"><img alt="../../_images/polarization_wave_variations.svg" class="align-center" src="../../_images/polarization_wave_variations.svg" width="90%" /></a>
<p>因为人类感觉不到偏振，所以在渲染视觉效果逼真的图像时，通常不需要考虑偏振。然而，使用各种测量设备和
摄像机可以很容易地观察到偏振，并且偏振往往可以提供丰富的关于可见物体材料和形状之类的信息。因此，偏
振是解决渲染逆问题的有力工具，这也是我们在 Mitsuba 2 中选择支持这一功能特性的原因之一。需要注意的是，
让系统考虑到偏振是有时间代价的—大约要花费渲染时间的1.5到2倍。</p>
<dl class="simple">
<dt>在光传播的模拟中，<em>Stokes vectors</em> 被用来模拟横向椭圆型振动的参数化，</dt><dd><p><em>Mueller matrices</em> 被用来计算表面散射对偏振对影响 <a class="bibtex reference internal" href="../../zz_bibliography.html#collett1993polarizedlight" id="id6">[Col93]</a>。</p>
</dd>
</dl>
<p>更多有关偏振渲染模式的实现细节，请参考开发者手册 <a class="reference internal" href="../developer_guide/polarization.html#developer-guide-polarization"><span class="std std-ref">Polarization</span></a> 章节。</p>
</div>
<div class="section" id="part-4-precision">
<h2>Part 4: Precision<a class="headerlink" href="#part-4-precision" title="Permalink to this headline">¶</a></h2>
<p>Mitsuba 2通常依赖于单精度(32位)运算，但也可以选择双精度(64位)。我们发现这在 debug 时会特别有用：
在切换到双精度后，通常可以确定观察到的问题是否是由于浮点不精确而引发的。需要注意的是，双精度目前不适
用于 <code class="docutils literal notranslate"><span class="pre">gpu_*</span></code> 变体。这是因为 OptiX 是以单精度执行光线追踪部分的。</p>
</div>
<div class="section" id="configuring-mitsuba-conf">
<h2>Configuring <span class="monosp">mitsuba.conf</span><a class="headerlink" href="#configuring-mitsuba-conf" title="Permalink to this headline">¶</a></h2>
<p>Mitsuba 2 的变体模式在 <span class="monosp">mitsuba.conf</span> 文件中指定。开始之前，首先将默认模板复制到 Mitsuba 2
本地存储仓库的根目录。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> &lt;..mitsuba repository..&gt;
cp resources/mitsuba.conf.template mitsuba.conf
</pre></div>
</div>
<p>接下来，在你喜欢的文本编辑器中打开 <span class="monosp">mitsuba.conf</span> ，然后滚动到启用变体的声明
部分（第70行附近）</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;enabled&quot;: [
    # The &quot;scalar_rgb&quot; variant *must* be included at the moment.
    &quot;scalar_rgb&quot;,
    &quot;scalar_spectral&quot;
],
</pre></div>
</div>
<p>默认情况下，指定了两个 scalar 变体，你可能想要根据你的需要和上面的解释来扩展这两个变体。
请注意，可以移除 <code class="docutils literal notranslate"><span class="pre">scalar_spectral</span></code> ，但``scalar_rgb`` <em>目前必须</em> 是列表的一部分，
因为 Mitsuba 的一些核心组件依赖于它。你也许想要改变在没有显式指定变体时执行的 <em>默认变体</em>
（这必须在 <code class="docutils literal notranslate"><span class="pre">enabled</span></code> 列表中）</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># If mitsuba is launched without any specific mode parameter,
# the configuration below will be used by default

&quot;default&quot;: &quot;scalar_spectral&quot;,
</pre></div>
</div>
<p>该配置文件的其余部分定义的是 C++ 类型的可用变体，你可以安全地忽略它们。</p>
<p>简单的讲：如果你计划在 Python 中使用 Mitsuba，我们建议在 CPU 渲染时添加
<code class="docutils literal notranslate"><span class="pre">packet_rgb</span></code> 或 <code class="docutils literal notranslate"><span class="pre">packet_spectral</span></code> 其中之一，相应的对于 GPU 渲染添加
<code class="docutils literal notranslate"><span class="pre">gpu_autodiff_rgb</span></code> 或 <code class="docutils literal notranslate"><span class="pre">gpu_autodiff_spectral</span></code> 之一。</p>
<p>一旦你完成了 <span class="monosp">mitsuba.conf</span> 中变体的设置，请继续下一节 <a class="reference internal" href="compiling.html#sec-compiling"><span class="std std-ref">编译整个系统</span></a>。</p>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="cloning.html" title="previous chapter (use the left arrow)">Cloning the repository</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="compiling.html" title="next chapter (use the right arrow)">Compiling the system</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="compiling.html" title="Compiling the system"
             >next</a> |</li>
        <li class="right" >
          <a href="cloning.html" title="Cloning the repository"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">选择变体</a></li> 
      </ul>
    </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>