<!-- Based on https://stackoverflow.com/a/25543713/1130282 -->

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>偏振 &#8212; mitsuba2 0.1.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="在 Python 中自定义插件" href="../advanced_topics/custom_plugins.html" />
    <link rel="prev" title="Building the documentation" href="building_documentation.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../advanced_topics/custom_plugins.html" title="在 Python 中自定义插件"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="building_documentation.html" title="Building the documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">偏振</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../../index.html" class="text-logo">Mitsuba 2</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/cloning.html">Cloning the repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/variants.html">Choosing variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/compiling.html">编译系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/file_format.html">场景文件格式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/differences.html">Differences to Mitsuba 0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/faq.html">常见问题概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Python interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/intro.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/parsing_xml.html">XML 代码解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/rendering_scene.html">渲染场景</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_interface/bsdf_eval.html">自定义应用</a></li>
</ul>
<p class="caption"><span class="caption-text">Inverse rendering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/diff_render.html">Differentiable rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/advanced.html">More advanced examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inverse_rendering/pytorch.html">Integration with PyTorch</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="variants_cpp.html">C++ 中的变体</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_plugin.html">插件 &amp; 宏</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">调试 Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_documentation.html">Building the documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">偏振</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/custom_plugins.html">在 Python 中自定义插件</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugin reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugin_reference/intro.html">Plugin 参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html">形状插件 Shape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#bsdfs">BSDFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#phase-functions">Phase functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#emitters">Emitters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#sensors">Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#textures">Textures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#spectra">Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#integrators">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#samplers">Samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#films">Films</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/plugins.html#reconstruction-filters">Reconstruction filters</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/core_api.html">Core API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/render_api.html">Render API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/python_api.html">Python API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zz_bibliography.html">Bibliography</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
              <li>偏振</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="developer-guide-polarization">
<span id="id1"></span><h1>偏振<a class="headerlink" href="#developer-guide-polarization" title="Permalink to this headline">¶</a></h1>
<p>当在 <em>polarized</em> 模式下（例如， <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">scalar_spectral_polarized</span></code> ）渲染模型时， Mitsuba 2将会在整个模拟过程中一直追踪光线的偏振状态。
这些偏振状态会记录在四维的 <em>Stokes vector</em> <span class="math notranslate nohighlight">\(\mathbf{s} = [s_0, s_1, s_2, s_3]\)</span> 中，此向量将振荡截面参数化为椭圆形状 <a class="bibtex reference internal" href="../../zz_bibliography.html#collett1993polarizedlight" id="id2">[Col93]</a>。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s_0\)</span> 相当于辐射度，不携带有关偏振的信息。</p></li>
<li><p><span class="math notranslate nohighlight">\(s_1\)</span> 用于区分水平偏振和垂直偏振，其中 <span class="math notranslate nohighlight">\(s_1 = \pm 1\)</span> 分别代表完全水平偏振或垂直偏振。</p></li>
<li><p><span class="math notranslate nohighlight">\(s_2\)</span> 类似于:math:<code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s_1</span></code> ，但是是在 45 度对角线上区分偏振。</p></li>
<li><p><span class="math notranslate nohighlight">\(s_3\)</span> 用于区分左右圆偏振，其中 <span class="math notranslate nohighlight">\(s_3 = \pm 1\)</span> 分别代表完全右或左圆偏振。</p></li>
<li><p>物理上合理的 stokes vector 需要满足条件 <span class="math notranslate nohighlight">\(s_0 \ge \sqrt{s_1^2 + s_2^2 + s_3^2}\)</span>。</p></li>
</ul>
<p>值得注意的是，此信息需要按照波长单独跟踪。</p>
<a class="reference internal image-reference" href="../../_images/polarization_stokes_vector.svg"><img alt="../../_images/polarization_stokes_vector.svg" class="align-center" src="../../_images/polarization_stokes_vector.svg" width="90%" /></a>
<p>这里的一个关键细节是如何选择执行测量过程的参考坐标系（或标架）？只要与光束正交即可，这纯粹是一种规定。
Mitsuba 2遵循标准教科书中对于偏振的描述，并且选择 Z 轴沿着光线传播方向的右手系，如下所示：</p>
<a class="reference internal image-reference" href="../../_images/polarization_wave.svg"><img alt="../../_images/polarization_wave.svg" class="align-center" src="../../_images/polarization_wave.svg" width="60%" /></a>
<p>换句话说，当使用 Stokes vector 描述偏振状态时，我们是从传感器一侧观察光束内部的。
下面所示的水平偏振光（形式如：<span class="math notranslate nohighlight">\(\mathbf{s} = [1, 1, 0, 0]\)</span>）只是在特定的 <span class="math notranslate nohighlight">\({\mathbf{x}, \mathbf{y}}\)</span>
标架下描述的。完全等价于在另一个不同标架 <span class="math notranslate nohighlight">\(\mathbf{x}', \mathbf{y}'\)</span> 中的另一种相应描述，此时用 Stokes vector
描述的偏振状态被替代为 <span class="math notranslate nohighlight">\(\mathbf{s} = [1, 0, -1, 0]\)</span> ：</p>
<a class="reference internal image-reference" href="../../_images/polarization_stokes_rotation.svg"><img alt="../../_images/polarization_stokes_rotation.svg" class="align-center" src="../../_images/polarization_stokes_rotation.svg" width="50%" /></a>
<p>在渲染过程中，光线当然也会与其他影响偏振的物体发生交互。这些变更由 <em>Mueller matrix</em> <span class="math notranslate nohighlight">\(\mathbf{M} \in \mathbb{R}^{4\times4}\)</span>
描述。在发生反射（或透射）之后，入射（<span class="math notranslate nohighlight">\(\mathbf{s}_i\)</span>）和出射（<span class="math notranslate nohighlight">\(\mathbf{s}_o\)</span>）的 Stokes vector 值可以被
替换为 <span class="math notranslate nohighlight">\(\mathbf{s}_o = \mathbf{M}\mathbf{s}_i\)</span>。这引发了与 Stokes vector 下关于参考标架相同的问题，只是现在
需要为交互中的入射方向和出射方向定义 <em>两个标架</em>：</p>
<a class="reference internal image-reference" href="../../_images/polarization_mueller_matrix.svg"><img alt="../../_images/polarization_mueller_matrix.svg" class="align-center" src="../../_images/polarization_mueller_matrix.svg" width="100%" /></a>
<p>（需要注意的是，这里 <span class="math notranslate nohighlight">\(\omega_i\)</span> 是指向光源的向量，因此标架应该基于 <span class="math notranslate nohighlight">\(-\omega_i\)</span> 建立，这是沿着光的传播方向的）</p>
<p>对于 Mueller 矩阵，非极化渲染中使用的标准 BSDF 定义 <span class="math notranslate nohighlight">\(f_r(\lambda, \omega_i, \omega_o)\)</span> 可以被推广为极化 pBSDF  <span class="math notranslate nohighlight">\(\mathbf{M}(\lambda, \omega_i, \omega_o)\)</span>。
Mitsuba 2中包含了导体和绝缘体 pBSDF 的实现（遵循了 polarized Fresnel equations），以及一些标准光学元件，例如线性偏振器和延迟器。</p>
<p>具有多相互作用的完整光线传播模拟会让事情变得更加复杂。只有当它们的参考标架与光路匹配时，后续光路上的米勒矩阵乘法才有意义。
在实践中，需要通过额外的坐标系旋转（下图中的红色箭头）来确保这一点。</p>
<a class="reference internal image-reference" href="../../_images/polarization_light_transport.svg"><img alt="../../_images/polarization_light_transport.svg" class="align-center" src="../../_images/polarization_light_transport.svg" width="100%" /></a>
<p>幸运的是，标架旋转本身就可以用一个简单的 Mueller matrix 表示。在 Mitsuba 2中，pBSDFs 的采样或估算程序总是返回已
经在出射入射两端预旋转对齐了的矩阵，使整个过程更为简单。</p>
<p>极化渲染中的最后一个重要细节就是 reciprocity 问题。不幸的是，pBSDFs 一般不会像标准 BSDFs 一样遵循 <em>Helmholtz reciprocity</em>，
pBSDFs 只会沿着光线方向定义。这使得一些渲染算法（如双向 BRDF）的实现略有复杂 <a class="bibtex reference internal" href="../../zz_bibliography.html#jarabo2018bidirectionalpol" id="id3">[JA18]</a> <a class="bibtex reference internal" href="../../zz_bibliography.html#mojzik2016bidirectionalpol" id="id4">[MSWK16]</a>:</p>
<ul class="simple">
<li><p>当跟踪光源发出的辐射时（例如，光线追踪器），一切都遵循标准的光线传播流程。在这里模拟过程可以简单的追踪 Stokes vectors 而不是</p></li>
</ul>
<p>辐射度，并且执行必要的 Mueller matrix 乘法。
- 与追踪从传感器 “发出” 光线时（例如，在路径追踪器中）的情况恰恰相反，我们需要从传感器一端追踪发射量（Mueller matrix 的值）。
为了在光线相交的曲面乘以 Mueller matrices 时能保持正确的运算顺序，这一点需要额外注意。</p>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="building_documentation.html" title="previous chapter (use the left arrow)">Building the documentation</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="../advanced_topics/custom_plugins.html" title="next chapter (use the right arrow)">在 Python 中自定义插件</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../advanced_topics/custom_plugins.html" title="在 Python 中自定义插件"
             >next</a> |</li>
        <li class="right" >
          <a href="building_documentation.html" title="Building the documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">偏振</a></li> 
      </ul>
    </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>