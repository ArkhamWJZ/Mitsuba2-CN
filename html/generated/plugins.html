<!-- Based on https://stackoverflow.com/a/25543713/1130282 -->

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>形状插件 Shape &#8212; mitsuba2 0.1.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction" href="../src/api_reference/intro.html" />
    <link rel="prev" title="Plugin 参考" href="../src/plugin_reference/intro.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../src/api_reference/intro.html" title="Introduction"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../src/plugin_reference/intro.html" title="Plugin 参考"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">形状插件 Shape</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">Mitsuba 2</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/cloning.html">Cloning the repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/variants.html">Choosing variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/compiling.html">编译系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/file_format.html">场景文件格式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/differences.html">Differences to Mitsuba 0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/getting_started/faq.html">常见问题概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Python interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/python_interface/intro.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/python_interface/parsing_xml.html">XML 代码解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/python_interface/rendering_scene.html">渲染场景</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/python_interface/bsdf_eval.html">自定义应用</a></li>
</ul>
<p class="caption"><span class="caption-text">Inverse rendering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/inverse_rendering/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/inverse_rendering/diff_render.html">Differentiable rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/inverse_rendering/advanced.html">More advanced examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/inverse_rendering/pytorch.html">Integration with PyTorch</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/intro.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/variants_cpp.html">C++ 中的变体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/writing_plugin.html">插件 &amp; 宏</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/testing.html">测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/debugging.html">调试 Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/building_documentation.html">Building the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/developer_guide/polarization.html">偏振</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/advanced_topics/custom_plugins.html">在 Python 中自定义插件</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugin reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../src/plugin_reference/intro.html">Plugin 参考</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">形状插件 Shape</a></li>
<li class="toctree-l1"><a class="reference internal" href="#bsdfs">BSDFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-phase">相位函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-emitters">光源</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-sensors">传感器</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-textures">纹理</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-spectra">光谱</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-integrators">积分器</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-samplers">采样器</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-films">胶片</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sec-rfilters">重构滤波器</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/api_reference/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_api.html">Core API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="render_api.html">Render API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">Python API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zz_bibliography.html">Bibliography</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
              <li>形状插件 Shape</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="shape">
<span id="sec-shapes"></span><h1>形状插件 Shape<a class="headerlink" href="#shape" title="Permalink to this headline">¶</a></h1>
<p>本小节呈现的是 Shape 类插件的概览，这些插件随着渲染器发布。</p>
<p>在 Mitsuba 2中，shape 定义了不同类型材质间转换的曲面。例如，shape 可以描述空气和固体介质（如一块岩石）之间的边界。
或者，一个 shape 可以标记一块非固态空间区域的开始，这个空间区域中是粒子介质，如烟雾或蒸汽等。最后，一个 shape 可以
用于创建自发光的对象。</p>
<p>Shape 通常情况下和名为 <em>BSDF</em> 的表面散射模型一起进行声明（详情请参阅 <a class="reference internal" href="#sec-bsdfs"><span class="std std-ref">respective section</span></a> 章节）。
BSDF 描述了曲面与光的交互。在 XML 场景描述语言中可以如下编写：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;.. shape type ..&quot;</span><span class="nt">&gt;</span>
        .. shape parameters ..

        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span><span class="nt">&gt;</span>
            .. bsdf parameters ..
        <span class="nt">&lt;/bsdf&gt;</span>

        <span class="c">&lt;!-- Alternatively: reference a named BSDF that</span>
<span class="c">             has been declared previously</span>

<span class="c">             &lt;ref id=&quot;my_bsdf&quot;/&gt;</span>
<span class="c">        --&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>接下来的小节更加详细的讨论了可用的 shape 类型。</p>
<div class="section" id="wavefront-obj-mesh-loader-obj">
<span id="shape-obj"></span><h2>Wavefront OBJ mesh loader (<span class="monosp">obj</span>)<a class="headerlink" href="#wavefront-obj-mesh-loader-obj" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">filename</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Filename of the OBJ file that should be loaded</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">face_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>When set to <span class="monosp">true</span>, any existing or computed vertex normals are
discarded and <em>face normals</em> will instead be used during rendering.
This gives the rendered object a faceted appearance. (Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">flip_tex_coords</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Treat the vertical component of the texture as inverted? Most OBJ files use this convention. (Default: <span class="monosp">true</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional linear object-to-world transformation.
(Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a simple loader for Wavefront OBJ files. It handles
meshes containing triangles and quadrilaterals, and it also imports vertex normals
and texture coordinates.</p>
<p>Loading an ordinary OBJ file is as simple as writing:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;obj&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;my_shape.obj&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Importing geometry via OBJ files should only be used as an absolutely
last resort. Due to inherent limitations of this format, the files
tend to be unreasonably large, and parsing them requires significant
amounts of memory and processing power. What’s worse is that the
internally stored data is often truncated, causing a loss of
precision. If possible, use the <a class="reference internal" href="#shape-ply"><span class="std std-ref">ply</span></a> or
<a class="reference internal" href="#shape-serialized"><span class="std std-ref">serialized</span></a> plugins instead.</p>
</div>
</div>
<div class="section" id="ply-stanford-triangle-format-mesh-loader-ply">
<span id="shape-ply"></span><h2>PLY (Stanford Triangle Format) mesh loader (<span class="monosp">ply</span>)<a class="headerlink" href="#ply-stanford-triangle-format-mesh-loader-ply" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">filename</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Filename of the PLY file that should be loaded</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">face_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>When set to <span class="monosp">true</span>, any existing or computed vertex normals are
discarded and <em>face normals</em> will instead be used during rendering.
This gives the rendered object a faceted appearance. (Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional linear object-to-world transformation.
(Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-ply">
<div style="width: 49%" class="subfigure align-center" id="id31">
<a class="reference internal image-reference" href="../_images/shape_ply_bunny.jpg"><img alt="../_images/shape_ply_bunny.jpg" src="../_images/shape_ply_bunny.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The Stanford bunny loaded with <span class="monosp">face_normals=false</span>.</span><a class="headerlink" href="#id31" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id32">
<a class="reference internal image-reference" href="../_images/shape_ply_bunny_facet.jpg"><img alt="../_images/shape_ply_bunny_facet.jpg" src="../_images/shape_ply_bunny_facet.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The Stanford bunny loaded with <span class="monosp">face_normals=true</span>. Note the faceted appearance.</span><a class="headerlink" href="#id32" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-ply">This plugin implements a fast loader for the Stanford PLY format (both the
ASCII and binary format, which is preferred for performance reasons). The
current plugin implementation supports triangle meshes with optional UV
coordinates, vertex normals and other custom vertex or face attributes.</p>
<p>Consecutive attributes with names sharing a common prefix and using one of the following schemes:</p>
<p><code class="docutils literal notranslate"><span class="pre">{prefix}_{x|y|z|w}</span></code>, <code class="docutils literal notranslate"><span class="pre">{prefix}_{r|g|b|a}</span></code>, <code class="docutils literal notranslate"><span class="pre">{prefix}_{0|1|2|3}</span></code>, <code class="docutils literal notranslate"><span class="pre">{prefix}_{1|2|3|4}</span></code></p>
<p>will be group together under a single multidimentional attribute named <code class="docutils literal notranslate"><span class="pre">{vertex|face}_{prefix}</span></code>.</p>
<p>RGB color attributes can also be defined without a prefix, following the naming scheme <code class="docutils literal notranslate"><span class="pre">{r|g|b|a}</span></code>
or <code class="docutils literal notranslate"><span class="pre">{red|green|blue|alpha}</span></code>. Those attributes will be group together under a single
multidimentional attribute named <code class="docutils literal notranslate"><span class="pre">{vertex|face}_color</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Values stored in a RBG color attribute will automatically be converted into spectal model
coefficients when using a spectral variant of the renderer.</p>
</div>
</div>
<div class="section" id="serialized-mesh-loader-serialized">
<span id="shape-serialized"></span><h2>Serialized mesh loader (<span class="monosp">serialized</span>)<a class="headerlink" href="#serialized-mesh-loader-serialized" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">filename</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Filename of the OBJ file that should be loaded</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">shape_index</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>A <span class="monosp">.serialized</span> file may contain several separate meshes. This parameter
specifies which one should be loaded. (Default: 0, i.e. the first one)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">face_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>When set to <span class="monosp">true</span>, any existing or computed vertex normals are
discarded and emph{face normals} will instead be used during rendering.
This gives the rendered object a faceted appearance.(Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional linear object-to-world transformation.
(Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<p>The serialized mesh format represents the most space and time-efficient way
of getting geometry information into Mitsuba 2. It stores indexed triangle meshes
in a lossless gzip-based encoding that (after decompression) nicely matches up
with the internally used data structures. Loading such files is considerably
faster than the <a class="reference internal" href="#shape-ply"><span class="std std-ref">ply</span></a> plugin and orders of magnitude faster than
the <a class="reference internal" href="#shape-obj"><span class="std std-ref">obj</span></a> plugin.</p>
<div class="section" id="format-description">
<h3>Format description<a class="headerlink" href="#format-description" title="Permalink to this headline">¶</a></h3>
<p>The <span class="monosp">serialized</span> file format uses the little endian encoding, hence
all fields below should be interpreted accordingly. The contents are structured as
follows:</p>
<div class="figure align-center" id="table-serialized-format">
<center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="monosp">uint16</span></p></td>
<td><p>File format identifier: <code class="code docutils literal notranslate"><span class="pre">0x041C</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">uint16</span></p></td>
<td><p>File version identifier. Currently set to <code class="code docutils literal notranslate"><span class="pre">0x0004</span></code></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p>From this point on, the stream is compressed by the <span class="monosp">DEFLATE</span> algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p>The used encoding is that of the <span class="monosp">zlib</span> library.</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">uint32</span></p></td>
<td><p>An 32-bit integer whose bits can be used to specify the following flags:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">0x0001</span></code>: The mesh data includes per-vertex normals</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">0x0002</span></code>: The mesh data includes texture coordinates</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">0x0008</span></code>: The mesh data includes vertex colors</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">0x0010</span></code>: Use face normals instead of smothly interpolated vertex normals.
Equivalent to specifying <span class="monosp">face_normals=true</span> to the plugin.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">0x1000</span></code>: The subsequent content is represented in single precision</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">0x2000</span></code>: The subsequent content is represented in double precision</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">string</span></p></td>
<td><p>A null-terminated string (utf-8), which denotes the name of the shape.</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">uint64</span></p></td>
<td><p>Number of vertices in the mesh</p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">uint64</span></p></td>
<td><p>Number of triangles in the mesh</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">array</span></p></td>
<td><p>Array of all vertex positions (X, Y, Z, X, Y, Z, …) specified in binary single or
double precision format (as denoted by the flags)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">array</span></p></td>
<td><p>Array of all vertex normal directions (X, Y, Z, X, Y, Z, …) specified in binary single
or double precision format. When the mesh has no vertex normals, this field is omitted.</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">array</span></p></td>
<td><p>Array of all vertex texture coordinates (U, V, U, V, …) specified in binary single or
double precision format. When the mesh has no texture coordinates, this field is omitted.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">array</span></p></td>
<td><p>Array of all vertex colors (R, G, B, R, G, B, …) specified in binary single or double
precision format. When the mesh has no vertex colors, this field is omitted.</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">array</span></p></td>
<td><p>Indexed triangle data (<code class="code docutils literal notranslate"><span class="pre">[i1,</span> <span class="pre">i2,</span> <span class="pre">i3]</span></code>, <code class="code docutils literal notranslate"><span class="pre">[i1,</span> <span class="pre">i2,</span> <span class="pre">i3]</span></code>, ..) specified in
<span class="monosp">uint32</span> or in <span class="monosp">uint64</span> format (the latter is used when the number of
vertices exceeds <code class="code docutils literal notranslate"><span class="pre">0xFFFFFFFF</span></code>).</p></td>
</tr>
</tbody>
</table>
</center></div></div>
<div class="section" id="multiple-shapes">
<span id="table-serialized-format"></span><h3>Multiple shapes<a class="headerlink" href="#multiple-shapes" title="Permalink to this headline">¶</a></h3>
<p>It is possible to store multiple meshes in a single <span class="monosp">.serialized</span>
file. This is done by simply concatenating their data streams,
where every one is structured according to the above description.
Hence, after each mesh, the stream briefly reverts back to an
uncompressed format, followed by an uncompressed header, and so on.
This is neccessary for efficient read access to arbitrary sub-meshes.</p>
</div>
<div class="section" id="end-of-file-dictionary">
<h3>End-of-file dictionary<a class="headerlink" href="#end-of-file-dictionary" title="Permalink to this headline">¶</a></h3>
<p>In addition to the previous table, a <span class="monosp">.serialized</span> file also concludes with a brief summary
at the end of the file, which specifies the starting position of each sub-mesh:</p>
<div class="figure align-center" id="table-serialized-end-of-file">
<center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="monosp">uint64</span></p></td>
<td><p>File offset of the first mesh (in bytes)—this is always zero.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">uint64</span></p></td>
<td><p>File offset of the second mesh</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="monosp">uint64</span></p></td>
<td><p>File offset of the last sub-shape</p></td>
</tr>
<tr class="row-even"><td><p><span class="monosp">uint32</span></p></td>
<td><p>Total number of meshes in the <span class="monosp">.serialized</span> file</p></td>
</tr>
</tbody>
</table>
</center></div></div>
</div>
<div class="section" id="sphere-sphere">
<span id="shape-sphere"></span><span id="table-serialized-end-of-file"></span><h2>Sphere (<span class="monosp">sphere</span>)<a class="headerlink" href="#sphere-sphere" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">center</span></p></td>
<td><p><span class="paramtype">point</span></p></td>
<td><p>Center of the sphere (Default: (0, 0, 0))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">radius</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Radius of the sphere (Default: 1)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">flip_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Is the sphere inverted, i.e. should the normal vectors be flipped? (Default:<span class="monosp">false</span>, i.e.
the normals point outside)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional linear object-to-world transformation.
Note that non-uniform scales and shears are not permitted!
(Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-sphere">
<div style="width: 49%" class="subfigure align-center" id="id33">
<a class="reference internal image-reference" href="../_images/shape_sphere_basic.jpg"><img alt="../_images/shape_sphere_basic.jpg" src="../_images/shape_sphere_basic.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Basic example</span><a class="headerlink" href="#id33" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id34">
<a class="reference internal image-reference" href="../_images/shape_sphere_parameterization.jpg"><img alt="../_images/shape_sphere_parameterization.jpg" src="../_images/shape_sphere_parameterization.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A textured sphere with the default parameterization</span><a class="headerlink" href="#id34" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-sphere">This shape plugin describes a simple sphere intersection primitive. It should
always be preferred over sphere approximations modeled using triangles.</p>
<p>A sphere can either be configured using a linear <span class="monosp">to_world</span> transformation or the <span class="monosp">center</span> and <span class="monosp">radius</span> parameters (or both).
The two declarations below are equivalent.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;scale</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;translate</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transform&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/shape&gt;</span>

<span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;center&quot;</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;radius&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
<p>When a <a class="reference internal" href="#shape-sphere"><span class="std std-ref">sphere</span></a> shape is turned into an <a class="reference internal" href="#emitter-area"><span class="std std-ref">area</span></a>
light source, Mitsuba 2 switches to an efficient
<a class="reference external" href="https://www.akalin.com/sampling-visible-sphere">sampling strategy</a> by Fred Akalin that
has particularly low variance.
This makes it a good default choice for lighting new scenes.</p>
<div class="figure compound align-center" id="fig-sphere-light">
<div style="width: 49%" class="subfigure align-center" id="id35">
<a class="reference internal image-reference" href="../_images/shape_sphere_light_mesh.jpg"><img alt="../_images/shape_sphere_light_mesh.jpg" src="../_images/shape_sphere_light_mesh.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Spherical area light modeled using triangles</span><a class="headerlink" href="#id35" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id36">
<a class="reference internal image-reference" href="../_images/shape_sphere_light_analytic.jpg"><img alt="../_images/shape_sphere_light_analytic.jpg" src="../_images/shape_sphere_light_analytic.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Spherical area light modeled using the <a class="reference internal" href="#shape-sphere"><span class="std std-ref">sphere</span></a> plugin</span><a class="headerlink" href="#id36" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="cylinder-cylinder">
<span id="shape-cylinder"></span><span id="fig-sphere-light"></span><h2>Cylinder (<span class="monosp">cylinder</span>)<a class="headerlink" href="#cylinder-cylinder" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">p0</span></p></td>
<td><p><span class="paramtype">point</span></p></td>
<td><p>Object-space starting point of the cylinder’s centerline.
(Default: (0, 0, 0))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">p1</span></p></td>
<td><p><span class="paramtype">point</span></p></td>
<td><p>Object-space endpoint of the cylinder’s centerline (Default: (0, 0, 1))</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">radius</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Radius of the cylinder in object-space units (Default: 1)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">flip_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Is the cylinder inverted, i.e. should the normal vectors
be flipped? (Default: <span class="monosp">false</span>, i.e. the normals point outside)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional linear object-to-world transformation. Note that non-uniform scales are
not permitted! (Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-cylinder">
<div style="width: 49%" class="subfigure align-center" id="id37">
<a class="reference internal image-reference" href="../_images/shape_cylinder_onesided.jpg"><img alt="../_images/shape_cylinder_onesided.jpg" src="../_images/shape_cylinder_onesided.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Cylinder with the default one-sided shading</span><a class="headerlink" href="#id37" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id38">
<a class="reference internal image-reference" href="../_images/shape_cylinder_twosided.jpg"><img alt="../_images/shape_cylinder_twosided.jpg" src="../_images/shape_cylinder_twosided.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Cylinder with two-sided shading</span><a class="headerlink" href="#id38" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-cylinder">This shape plugin describes a simple cylinder intersection primitive.
It should always be preferred over approximations modeled using
triangles. Note that the cylinder does not have endcaps – also,
its normals point outward, which means that the inside will be treated
as fully absorbing by most material models. If this is not
desirable, consider using the <a class="reference internal" href="#bsdf-twosided"><span class="std std-ref">twosided</span></a> plugin.</p>
<p>A simple example for instantiating a cylinder, whose interior is visible:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;cylinder&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;radius&quot;</span> <span class="na">value=</span><span class="s">&quot;0.3&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;twosided&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="disk-disk">
<span id="shape-disk"></span><h2>Disk (<span class="monosp">disk</span>)<a class="headerlink" href="#disk-disk" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">flip_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Is the disk inverted, i.e. should the normal vectors be flipped? (Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies a linear object-to-world transformation. Note that non-uniform scales are not
permitted! (Default: none, i.e. object space = world space)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-disk">
<div style="width: 49%" class="subfigure align-center" id="id39">
<a class="reference internal image-reference" href="../_images/shape_disk.jpg"><img alt="../_images/shape_disk.jpg" src="../_images/shape_disk.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Basic example</span><a class="headerlink" href="#id39" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id40">
<a class="reference internal image-reference" href="../_images/shape_disk_parameterization.jpg"><img alt="../_images/shape_disk_parameterization.jpg" src="../_images/shape_disk_parameterization.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A textured disk with the default parameterization</span><a class="headerlink" href="#id40" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-disk">This shape plugin describes a simple disk intersection primitive. It is
usually preferable over discrete approximations made from triangles.</p>
<p>By default, the disk has unit radius and is located at the origin. Its
surface normal points into the positive Z-direction.
To change the disk scale, rotation, or translation, use the
<span class="monosp">to_world</span> parameter.</p>
<p>The following XML snippet instantiates an example of a textured disk shape:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;disk&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span> <span class="na">type=</span><span class="s">&quot;checkerboard&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_uv&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;scale</span> <span class="na">x=</span><span class="s">&quot;2&quot;</span> <span class="na">y=</span><span class="s">&quot;10&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/transform&gt;</span>
        <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="rectangle-rectangle">
<span id="shape-rectangle"></span><h2>Rectangle (<span class="monosp">rectangle</span>)<a class="headerlink" href="#rectangle-rectangle" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">flip_normals</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Is the rectangle inverted, i.e. should the normal vectors be flipped? (Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies a linear object-to-world transformation. (Default: none (i.e. object space = world space))</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-rectangle">
<div style="width: 49%" class="subfigure align-center" id="id41">
<a class="reference internal image-reference" href="../_images/shape_rectangle.jpg"><img alt="../_images/shape_rectangle.jpg" src="../_images/shape_rectangle.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Basic example</span><a class="headerlink" href="#id41" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id42">
<a class="reference internal image-reference" href="../_images/shape_rectangle_parameterization.jpg"><img alt="../_images/shape_rectangle_parameterization.jpg" src="../_images/shape_rectangle_parameterization.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A textured rectangle with the default parameterization</span><a class="headerlink" href="#id42" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-rectangle">This shape plugin describes a simple rectangular shape primitive.
It is mainly provided as a convenience for those cases when creating and
loading an external mesh with two triangles is simply too tedious, e.g.
when an area light source or a simple ground plane are needed.
By default, the rectangle covers the XY-range <span class="math notranslate nohighlight">\([-1,1]\times[-1,1]\)</span>
and has a surface normal that points into the positive Z-direction.
To change the rectangle scale, rotation, or translation, use the
<span class="monosp">to_world</span> parameter.</p>
<p>The following XML snippet showcases a simple example of a textured rectangle:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;rectangle&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span> <span class="na">type=</span><span class="s">&quot;checkerboard&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_uv&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;scale</span> <span class="na">x=</span><span class="s">&quot;5&quot;</span> <span class="na">y=</span><span class="s">&quot;5&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/transform&gt;</span>
        <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="shape-group-shapegroup">
<span id="shape-shapegroup"></span><h2>Shape group (<span class="monosp">shapegroup</span>)<a class="headerlink" href="#shape-group-shapegroup" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">shape</span></p></td>
<td><p>One or more shapes that should be made available for geometry instancing</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a container for shapes that should be made available for geometry instancing.
Any shapes placed in a shapegroup will not be visible on their own—instead, the renderer will
precompute ray intersection acceleration data structures so that they can efficiently be referenced
many times using the <a class="reference internal" href="#shape-instance"><span class="std std-ref">Instance (instance)</span></a> plugin. This is useful for rendering things like forests,
where only a few distinct types of trees have to be kept in memory. An example is given below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Declare a named shape group containing two objects --&gt;</span>
<span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;shapegroup&quot;</span> <span class="na">id=</span><span class="s">&quot;my_shape_group&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;ply&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;data.ply&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughconductor&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;scale</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;translate</span> <span class="na">y=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/transform&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
<span class="nt">&lt;/shape&gt;</span>

<span class="c">&lt;!-- Instantiate the shape group without any kind of transformation --&gt;</span>
<span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;instance&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ref</span> <span class="na">id=</span><span class="s">&quot;my_shape_group&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/shape&gt;</span>

<span class="c">&lt;!-- Create instance of the shape group, but rotated, scaled, and translated --&gt;</span>
<span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;instance&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ref</span> <span class="na">id=</span><span class="s">&quot;my_shape_group&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;rotate</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">angle=</span><span class="s">&quot;45&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;scale</span> <span class="na">value=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;translate</span> <span class="na">z=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transform&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="instance-instance">
<span id="shape-instance"></span><h2>Instance (<span class="monosp">instance</span>)<a class="headerlink" href="#instance-instance" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">shapegroup</span></p></td>
<td><p>A reference to a shape group that should be instantiated.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies a linear object-to-world transformation. (Default: none (i.e. object space = world space))</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a geometry instance used to efficiently replicate geometry many times. For
details on how to create instances, refer to the <a class="reference internal" href="#shape-shapegroup"><span class="std std-ref">Shape group (shapegroup)</span></a> plugin.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/shape_instance_fractal.jpg"><img alt="../_images/shape_instance_fractal.jpg" class="align-center" src="../_images/shape_instance_fractal.jpg" style="width: 100%;" /></a>
<p>The Stanford bunny loaded a single time and instanciated 1365 times (equivalent to 100 million
triangles)</p>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Note that it is not possible to assign a different material to each instance — the material
assignment specified within the shape group is the one that matters.</p></li>
<li><p>Shape groups cannot be used to replicate shapes with attached emitters, sensors, or
subsurface scattering models.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="bsdfs">
<span id="sec-bsdfs"></span><h1>BSDFs<a class="headerlink" href="#bsdfs" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/bsdf_overview.jpg"><img alt="../_images/bsdf_overview.jpg" class="align-center" src="../_images/bsdf_overview.jpg" style="width: 100%;" /></a>
<p>上面的图解概括了 Mitsuba2 中最重要的表面散射模型。箭头表示了光线与各自模型表面交互的可能出射结果。</p>
</div></blockquote>
<p>表面散射模型描述了光线与场景中的各种介质表面交互的行为。该模型很方便地总结了材料内部发生的微观散射过程，并使它
看起来非常自然。这种表示方式是 Mitsuba 2 材质系统的核心组件之一，渲染器关注的另一部分是光线在表面介质间的交互
时发生了什么。关于这方面更多的信息，请参阅 participating media 这一章节。该章节介绍的是所有支持的表面散射模型
以及它们对应的参数。</p>
<p>为了达到真是感渲染的效果，Mitsuba 2 提供了一个通用介质的表面散射模型库，包括 玻璃材质、金属材质以及塑料材质。
一些模型插件也可以作为编辑器应用在一个或多个散射模型的文件的顶部。</p>
<p>尽管在文档中和场景描述语言中，BSDF 这个单词和 <em>表面散射模型</em> 是等价的，但这实际上是 <em>双向散射分布</em> 的缩写，在
技术上更精准一点的话。</p>
<p>在 Mitsuba 2 中，BSDF 与描述场景中可见表面的 <em>shapes</em> 相关联。在场景描述语言中，关联的过程可以通过将 BSDF 嵌
套到 shape 中来进行，也可以对它们进行命名，随后再根据它们的名称进行引用。下面的代码片段展示了这两种用法的示例：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Creating a named BSDF for later use --&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span> <span class="na">id=</span><span class="s">&quot;my_named_material&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- BSDF parameters go here --&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>

    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Example of referencing a named material --&gt;</span>
        <span class="nt">&lt;ref</span> <span class="na">id=</span><span class="s">&quot;my_named_material&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>

    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Example of instantiating an unnamed material --&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- BSDF parameters go here --&gt;</span>
        <span class="nt">&lt;/bsdf&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>当在多个地方使用已命名的 BSDF 时，通常使用引用的方法会更经济，因为这样可以减少内存的使用。</p>
<div class="section" id="correctness-considerations">
<span id="bsdf-correctness"></span><h2>Correctness considerations<a class="headerlink" href="#correctness-considerations" title="Permalink to this headline">¶</a></h2>
<p>在基于物理渲染场景的一个至关重要的考量是，不能违反物理规则，并且每个安排都要是有意义的。
例如，想象一个建筑场景的内部，这个场景视觉效果很棒，除了有一张白桌子看上去有点暗。仔细一点观察发现，
它使用的 Lambertian 材质的漫发射系数是 0.9。</p>
<p>在许多渲染系统中，针对这种情况将反射率调整到 1.0 以上是可行的。但是在 Mitsuba 中，即使是一个很小的
表面反射出比自身接收到的还要多的光强都是不允许的，这可能会破坏渲染算法的可用性导致预计之外的结果。
事实上，这种情况的正确解决方案是调整光源的设置，使桌子能够接受到更多的光照明，除此之外还要 <em>减少材质的反射率</em>
毕竟在真实世界中找到一张能反射 90% 入射光的桌子还是挺困难的一件事。</p>
<p>关于材料描述要有意义这一观点必要性的另一个例子是下图所示的玻璃模型。在这里，需要仔细思考不同渲染介质之间折射率变化的边界。
如果做的不正确，一束光可能潜在通过一系列的不可能的折射率变化（例如 1.00 到 1.33 其次是 1.50 到 1.33），这种情况下的输出是未定义的，
从而相当程度上在场景中可能存在一些错误，导致渲染结果远远不像是玻璃。</p>
<div class="figure align-center" id="fig-glass-explanation">
<center><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/glass_explanation.svg"><img alt="Glass interfaces explanation" src="../_images/glass_explanation.svg" width="95%" /></a>
</div>
<p class="caption"><span class="caption-text">Mitsuba 中的一些散射模型需要知道介质表面向外部和面向内部的折射率参数。因此，根据折射率的变化，将网格分解为有意义的独立表面
是很重要的。这里的例子展示了一个装满水的玻璃杯的分解过程。</span></p>
</center></div></div>
<div class="section" id="smooth-diffuse-material-diffuse">
<span id="bsdf-diffuse"></span><span id="fig-glass-explanation"></span><h2>Smooth diffuse material (<span class="monosp">diffuse</span>)<a class="headerlink" href="#smooth-diffuse-material-diffuse" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Specifies the diffuse albedo of the material (Default: 0.5)</p></td>
</tr>
</tbody>
</table>
<p>The smooth diffuse material (also referred to as <em>Lambertian</em>)
represents an ideally diffuse material with a user-specified amount of
reflectance. Any received illumination is scattered so that the surface
looks the same independently of the direction of observation.</p>
<div class="figure compound align-center" id="fig-diffuse">
<div style="width: 49%" class="subfigure align-center" id="id43">
<a class="reference internal image-reference" href="../_images/bsdf_diffuse_plain.jpg"><img alt="../_images/bsdf_diffuse_plain.jpg" src="../_images/bsdf_diffuse_plain.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Homogeneous reflectance</span><a class="headerlink" href="#id43" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id44">
<a class="reference internal image-reference" href="../_images/bsdf_diffuse_textured.jpg"><img alt="../_images/bsdf_diffuse_textured.jpg" src="../_images/bsdf_diffuse_textured.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Textured reflectance</span><a class="headerlink" href="#id44" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-diffuse">Apart from a homogeneous reflectance value, the plugin can also accept
a nested or referenced texture map to be used as the source of reflectance
information, which is then mapped onto the shape based on its UV
parameterization. When no parameters are specified, the model uses the default
of 50% reflectance.</p>
<p>Note that this material is one-sided—that is, observed from the
back side, it will be completely black. If this is undesirable,
consider using the <a class="reference internal" href="#bsdf-twosided"><span class="std std-ref">twosided</span></a> BRDF adapter plugin.
The following XML snippet describes a diffuse material,
whose reflectance is specified as an sRGB color:</p>
<div class="highlight-xml notranslate" id="diffuse-srgb"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rgb</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span> <span class="na">value=</span><span class="s">&quot;0.2, 0.25, 0.7&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>Alternatively, the reflectance can be textured:</p>
<div class="highlight-xml notranslate" id="diffuse-texture"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;wood.jpg&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="smooth-dielectric-material-dielectric">
<span id="bsdf-dielectric"></span><h2>Smooth dielectric material (<span class="monosp">dielectric</span>)<a class="headerlink" href="#smooth-dielectric-material-dielectric" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">int_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Interior index of refraction specified numerically or using a known material name. (Default: bk7 / 1.5046)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">ext_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Exterior index of refraction specified numerically or using a known material name.  (Default: air / 1.000277)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component. Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">specular_transmittance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular transmission component. Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-dielectric">
<div style="width: 49%" class="subfigure align-center" id="id45">
<a class="reference internal image-reference" href="../_images/bsdf_dielectric_glass.jpg"><img alt="../_images/bsdf_dielectric_glass.jpg" src="../_images/bsdf_dielectric_glass.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Air ↔ Water (IOR: 1.33) interface.</span><a class="headerlink" href="#id45" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id46">
<a class="reference internal image-reference" href="../_images/bsdf_dielectric_diamond.jpg"><img alt="../_images/bsdf_dielectric_diamond.jpg" src="../_images/bsdf_dielectric_diamond.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Air ↔ Diamond (IOR: 2.419)</span><a class="headerlink" href="#id46" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-dielectric">This plugin models an interface between two dielectric materials having mismatched
indices of refraction (for instance, water ↔ air). Exterior and interior IOR values
can be specified independently, where “exterior” refers to the side that contains
the surface normal. When no parameters are given, the plugin activates the defaults, which
describe a borosilicate glass (BK7) ↔ air interface.</p>
<p>In this model, the microscopic structure of the surface is assumed to be perfectly
smooth, resulting in a degenerate BSDF described by a Dirac delta distribution.
This means that for any given incoming ray of light, the model always scatters into
a discrete set of directions, as opposed to a continuum. For a similar model that
instead describes a rough surface microstructure, take a look at the
<a class="reference internal" href="#bsdf-roughdielectric"><span class="std std-ref">roughdielectric</span></a> plugin.</p>
<p>This snippet describes a simple air-to-water interface</p>
<div class="highlight-xml notranslate" id="dielectric-water"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;...&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;dielectric&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;int_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;water&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;ext_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;air&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;shape&gt;</span>
</pre></div>
</div>
<p>When using this model, it is crucial that the scene contains
meaningful and mutually compatible indices of refraction changes—see the
section about <a class="reference internal" href="#bsdf-correctness"><span class="std std-ref">correctness considerations</span></a> for a
description of what this entails.</p>
<p>In many cases, we will want to additionally describe the <em>medium</em> within a
dielectric material. This requires the use of a rendering technique that is
aware of media (e.g. the <a class="reference internal" href="#integrator-volpath"><span class="std std-ref">volumetric path tracer</span></a>).
An example of how one might describe a slightly absorbing piece of glass is shown below:</p>
<div class="highlight-xml notranslate" id="dielectric-glass"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;...&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;dielectric&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;int_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;1.504&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;ext_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>

    <span class="nt">&lt;medium</span> <span class="na">type=</span><span class="s">&quot;homogeneous&quot;</span> <span class="na">name=</span><span class="s">&quot;interior&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;scale&quot;</span> <span class="na">value=</span><span class="s">&quot;4&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;rgb</span> <span class="na">name=</span><span class="s">&quot;sigma_t&quot;</span> <span class="na">value=</span><span class="s">&quot;1, 1, 0.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;rgb</span> <span class="na">name=</span><span class="s">&quot;albedo&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0, 0.0, 0.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/medium&gt;</span>
<span class="nt">&lt;shape&gt;</span>
</pre></div>
</div>
<p>In <em>polarized</em> rendering modes, the material automatically switches to a polarized
implementation of the underlying Fresnel equations that quantify the reflectance and
transmission.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dispersion is currently unsupported but will be enabled in a future release.</p>
</div>
<p>Instead of specifying numerical values for the indices of refraction, Mitsuba 2
comes with a list of presets that can be specified with the <span class="paramtype">material</span>
parameter:</p>
<div class="figure align-center" id="ior-table-list">
<center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 21%" />
<col style="width: 29%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">vacuum</span></p></td>
<td><p>1.0</p></td>
<td><p><span class="paramtype">acetone</span></p></td>
<td><p>1.36</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">bromine</span></p></td>
<td><p>1.661</p></td>
<td><p><span class="paramtype">bk7</span></p></td>
<td><p>1.5046</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">helium</span></p></td>
<td><p>1.00004</p></td>
<td><p><span class="paramtype">ethanol</span></p></td>
<td><p>1.361</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">water ice</span></p></td>
<td><p>1.31</p></td>
<td><p><span class="paramtype">sodium chloride</span></p></td>
<td><p>1.544</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">hydrogen</span></p></td>
<td><p>1.00013</p></td>
<td><p><span class="paramtype">carbon tetrachloride</span></p></td>
<td><p>1.461</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fused quartz</span></p></td>
<td><p>1.458</p></td>
<td><p><span class="paramtype">amber</span></p></td>
<td><p>1.55</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">air</span></p></td>
<td><p>1.00028</p></td>
<td><p><span class="paramtype">glycerol</span></p></td>
<td><p>1.4729</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">pyrex</span></p></td>
<td><p>1.470</p></td>
<td><p><span class="paramtype">pet</span></p></td>
<td><p>1.575</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">carbon dioxide</span></p></td>
<td><p>1.00045</p></td>
<td><p><span class="paramtype">benzene</span></p></td>
<td><p>1.501</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">acrylic glass</span></p></td>
<td><p>1.49</p></td>
<td><p><span class="paramtype">diamond</span></p></td>
<td><p>2.419</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">water</span></p></td>
<td><p>1.3330</p></td>
<td><p><span class="paramtype">silicone oil</span></p></td>
<td><p>1.52045</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">polypropylene</span></p></td>
<td><p>1.49</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p class="caption"><span class="caption-text">This table lists all supported material names
along with along with their associated index of refraction at standard conditions.
These material names can be used with the plugins <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a>,
<a class="reference internal" href="#bsdf-roughdielectric"><span class="std std-ref">roughdielectric</span></a>, <a class="reference internal" href="#bsdf-plastic"><span class="std std-ref">plastic</span></a>
, as well as <a class="reference internal" href="#bsdf-roughplastic"><span class="std std-ref">roughplastic</span></a>.</span></p>
</center></div></div>
<div class="section" id="thin-dielectric-material-thindielectric">
<span id="bsdf-thindielectric"></span><span id="ior-table-list"></span><h2>Thin dielectric material (<span class="monosp">thindielectric</span>)<a class="headerlink" href="#thin-dielectric-material-thindielectric" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">int_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Interior index of refraction specified numerically or using a known material name. (Default: bk7 / 1.5046)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">ext_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Exterior index of refraction specified numerically or using a known material name.  (Default: air / 1.000277)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component. Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">specular_transmittance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular transmission component. Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-comparison-thindielectric">
<div style="width: 49%" class="subfigure align-center" id="id47">
<a class="reference internal image-reference" href="../_images/bsdf_dielectric_glass.jpg"><img alt="../_images/bsdf_dielectric_glass.jpg" src="../_images/bsdf_dielectric_glass.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Dielectric</span><a class="headerlink" href="#id47" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id48">
<a class="reference internal image-reference" href="../_images/bsdf_thindielectric_glass.jpg"><img alt="../_images/bsdf_thindielectric_glass.jpg" src="../_images/bsdf_thindielectric_glass.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Thindielectric</span><a class="headerlink" href="#id48" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-comparison-thindielectric">This plugin models a <strong>thin</strong> dielectric material that is embedded inside another
dielectric—for instance, glass surrounded by air. The interior of the material
is assumed to be so thin that its effect on transmitted rays is negligible,
Hence, light exits such a material without any form of angular deflection
(though there is still specular reflection).
This model should be used for things like glass windows that were modeled using only a
single sheet of triangles or quads. On the other hand, when the window consists of
proper closed geometry, <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> is the right choice.
This is illustrated below:</p>
<div class="figure compound align-center" id="fig-bsdf-thindielectric">
<div style="width: 49%" class="subfigure align-center" id="id49">
<a class="reference internal image-reference" href="../_images/dielectric_figure.svg"><img alt="../_images/dielectric_figure.svg" src="../_images/dielectric_figure.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">The <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> plugin models a single transition from one index of refraction to another</span><a class="headerlink" href="#id49" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id50">
<a class="reference internal image-reference" href="../_images/thindielectric_figure.svg"><img alt="../_images/thindielectric_figure.svg" src="../_images/thindielectric_figure.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">The <a class="reference internal" href="#bsdf-thindielectric"><span class="std std-ref">thindielectric</span></a> plugin models a pair of interfaces causing a transient index of refraction change</span><a class="headerlink" href="#id50" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-thindielectric">The implementation correctly accounts for multiple internal reflections
inside the thin dielectric at <strong>no significant extra cost</strong>, i.e. paths
of the type <span class="math notranslate nohighlight">\(R, TRT, TR^3T, ..\)</span> for reflection and <span class="math notranslate nohighlight">\(TT, TR^2, TR^4T, ..\)</span> for
refraction, where <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(R\)</span> denote individual reflection and refraction
events, respectively.</p>
<p>Similar to the <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> plugin, IOR values can either
be specified numerically, or based on a list of known materials (see the
corresponding table in the <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> reference).
When no parameters are given, the plugin activates the default settings,
which describe a borosilicate glass (BK7) ↔ air interface.</p>
</div>
<div class="section" id="rough-dielectric-material-roughdielectric">
<span id="bsdf-roughdielectric"></span><h2>Rough dielectric material (<span class="monosp">roughdielectric</span>)<a class="headerlink" href="#rough-dielectric-material-roughdielectric" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">int_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Interior index of refraction specified numerically or using a known material name. (Default: bk7 / 1.5046)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">ext_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Exterior index of refraction specified numerically or using a known material name.  (Default: air / 1.000277)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance, specular_transmittance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection/transmission components.
Note that for physical realism, these parameters should never be touched. (Default: 1.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">distribution</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies the type of microfacet normal distribution used to model the surface roughness.</p>
<ul class="simple">
<li><p><span class="monosp">beckmann</span>: Physically-based distribution derived from Gaussian random surfaces.
This is the default.</p></li>
<li><p><span class="monosp">ggx</span>: The GGX <a class="bibtex reference internal" href="../zz_bibliography.html#walter07microfacet" id="id1">[WMLT07]</a> distribution (also known as Trowbridge-Reitz
<a class="bibtex reference internal" href="../zz_bibliography.html#trowbridge19975average" id="id2">[TR75]</a> distribution) was designed to better approximate the long
tails observed in measurements of ground surfaces, which are not modeled by the Beckmann
distribution.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">alpha, alpha_u, alpha_v</span></p></td>
<td><p><span class="paramtype">texture</span> or <span class="paramtype">float</span></p></td>
<td><p>Specifies the roughness of the unresolved surface micro-geometry along the tangent and
bitangent directions. When the Beckmann distribution is used, this parameter is equal to the
<em>root mean square</em> (RMS) slope of the microfacets. <span class="monosp">alpha</span> is a convenience
parameter to initialize both <span class="monosp">alpha_u</span> and <span class="monosp">alpha_v</span> to the same value. (Default: 0.1)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">sample_visible</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Enables a sampling technique proposed by Heitz and D’Eon <a class="bibtex reference internal" href="../zz_bibliography.html#heitz1014importance" id="id3">[HDEon14]</a>, which
focuses computation on the visible parts of the microfacet normal distribution, considerably
reducing variance in some cases. (Default: <span class="monosp">true</span>, i.e. use visible normal sampling)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a realistic microfacet scattering model for rendering
rough interfaces between dielectric materials, such as a transition from air to
ground glass. Microfacet theory describes rough surfaces as an arrangement of
unresolved and ideally specular facets, whose normal directions are given by
a specially chosen <em>microfacet distribution</em>. By accounting for shadowing
and masking effects between these facets, it is possible to reproduce the important
off-specular reflections peaks observed in real-world measurements of such
materials.</p>
<div class="figure compound align-center" id="fig-bsdf-roughdielectric">
<div style="width: 49%" class="subfigure align-center" id="id51">
<a class="reference internal image-reference" href="../_images/bsdf_roughdielectric_glass.jpg"><img alt="../_images/bsdf_roughdielectric_glass.jpg" src="../_images/bsdf_roughdielectric_glass.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Anti-glare glass (Beckmann, <span class="math notranslate nohighlight">\(\alpha=0.02\)</span>)</span><a class="headerlink" href="#id51" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id52">
<a class="reference internal image-reference" href="../_images/bsdf_roughdielectric_rough.jpg"><img alt="../_images/bsdf_roughdielectric_rough.jpg" src="../_images/bsdf_roughdielectric_rough.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rough glass (Beckmann, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span>)</span><a class="headerlink" href="#id52" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id53">
<a class="reference internal image-reference" href="../_images/bsdf_roughdielectric_textured.jpg"><img alt="../_images/bsdf_roughdielectric_textured.jpg" src="../_images/bsdf_roughdielectric_textured.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rough glass with textured alpha</span><a class="headerlink" href="#id53" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-roughdielectric">This plugin is essentially the <em>roughened</em> equivalent of the (smooth) plugin
<a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a>. For very low values of <span class="math notranslate nohighlight">\(\alpha\)</span>, the two will
be identical, though scenes using this plugin will take longer to render
due to the additional computational burden of tracking surface roughness.</p>
<p>The implementation is based on the paper <em>Microfacet Models
for Refraction through Rough Surfaces</em> by Walter et al.
<a class="bibtex reference internal" href="../zz_bibliography.html#walter07microfacet" id="id4">[WMLT07]</a> and supports two different types of microfacet
distributions. Exterior and interior IOR values can be specified independently,
where <em>exterior</em> refers to the side that contains the surface normal. Similar to the
<a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> plugin, IOR values can either be specified
numerically, or based on a list of known materials (see the
corresponding table in the <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> reference).
When no parameters are given, the plugin activates the default settings,
which describe a borosilicate glass (BK7) ↔ air interface with a light amount of
roughness modeled using a Beckmann distribution.</p>
<p>To get an intuition about the effect of the surface roughness parameter
<span class="math notranslate nohighlight">\(\alpha\)</span>, consider the following approximate classification: a value of
<span class="math notranslate nohighlight">\(\alpha=0.001-0.01\)</span> corresponds to a material with slight imperfections
on an otherwise smooth surface finish, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span> is relatively rough,
and <span class="math notranslate nohighlight">\(\alpha=0.3-0.7\)</span> is <strong>extremely</strong> rough (e.g. an etched or ground
finish). Values significantly above that are probably not too realistic.</p>
<p>Please note that when using this plugin, it is crucial that the scene contains
meaningful and mutually compatible index of refraction changes—see the
section about <a class="reference internal" href="#bsdf-correctness"><span class="std std-ref">correctness considerations</span></a> for a
description of what this entails.</p>
<p>The following XML snippet describes a material definition for rough glass:</p>
<div class="highlight-xml notranslate" id="roughdielectric-roughglass"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughdielectric&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;distribution&quot;</span> <span class="na">value=</span><span class="s">&quot;beckmann&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;alpha&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;int_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;bk7&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;ext_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;air&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<div class="section" id="technical-details">
<h3>Technical details<a class="headerlink" href="#technical-details" title="Permalink to this headline">¶</a></h3>
<p>All microfacet distributions allow the specification of two distinct
roughness values along the tangent and bitangent directions. This can be
used to provide a material with a <em>brushed</em> appearance. The alignment
of the anisotropy will follow the UV parameterization of the underlying
mesh. This means that such an anisotropic material cannot be applied to
triangle meshes that are missing texture coordinates.</p>
<p>Since Mitsuba 0.5.1, this plugin uses a new importance sampling technique
contributed by Eric Heitz and Eugene D’Eon, which restricts the sampling
domain to the set of visible (unmasked) microfacet normals. The previous
approach of sampling all normals is still available and can be enabled
by setting <span class="monosp">sample_visible</span> to <span class="monosp">false</span>. However this will lead
to significantly slower convergence.</p>
</div>
</div>
<div class="section" id="smooth-conductor-conductor">
<span id="bsdf-conductor"></span><h2>Smooth conductor (<span class="monosp">conductor</span>)<a class="headerlink" href="#smooth-conductor-conductor" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">material</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Name of the material preset, see <a href="#conductor-ior-list">conductor-ior-list</a>. (Default: none)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">eta, k</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Real and imaginary components of the material’s index of refraction. (Default: based on the value of <span class="paramtype">material</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component.
Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-conductor">
<div style="width: 49%" class="subfigure align-center" id="id54">
<a class="reference internal image-reference" href="../_images/bsdf_conductor_gold.jpg"><img alt="../_images/bsdf_conductor_gold.jpg" src="../_images/bsdf_conductor_gold.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Gold</span><a class="headerlink" href="#id54" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id55">
<a class="reference internal image-reference" href="../_images/bsdf_conductor_aluminium.jpg"><img alt="../_images/bsdf_conductor_aluminium.jpg" src="../_images/bsdf_conductor_aluminium.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Aluminium</span><a class="headerlink" href="#id55" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-conductor">This plugin implements a perfectly smooth interface to a conducting material,
such as a metal that is described using a Dirac delta distribution. For a
similar model that instead describes a rough surface microstructure, take a look
at the separately available <a class="reference internal" href="#bsdf-roughconductor"><span class="std std-ref">roughconductor</span></a> plugin.
In contrast to dielectric materials, conductors do not transmit
any light. Their index of refraction is complex-valued and tends to undergo
considerable changes throughout the visible color spectrum.</p>
<p>When using this plugin, you should ideally enable one of the <span class="monosp">spectral</span>
modes of the renderer to get the most accurate results. While it also works
in RGB mode, the computations will be more approximate in nature.
Also note that this material is one-sided—that is, observed from the
back side, it will be completely black. If this is undesirable,
consider using the <a class="reference internal" href="#bsdf-twosided"><span class="std std-ref">twosided</span></a> BRDF adapter plugin.</p>
<p>The following XML snippet describes a material definition for gold:</p>
<div class="highlight-xml notranslate" id="lst-conductor-gold"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;conductor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;material&quot;</span> <span class="na">value=</span><span class="s">&quot;Au&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>It is also possible to load spectrally varying index of refraction data from
two external files containing the real and imaginary components,
respectively (see <a class="reference internal" href="../src/getting_started/file_format.html#sec-file-format"><span class="std std-ref">Scene format</span></a> for details on the file format):</p>
<div class="highlight-xml notranslate" id="lst-conductor-files"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;conductor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;eta&quot;</span> <span class="na">filename=</span><span class="s">&quot;conductorIOR.eta.spd&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;k&quot;</span> <span class="na">filename=</span><span class="s">&quot;conductorIOR.k.spd&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>In <em>polarized</em> rendering modes, the material automatically switches to a polarized
implementation of the underlying Fresnel equations.</p>
<p>To facilitate the tedious task of specifying spectrally-varying index of
refraction information, Mitsuba 2 ships with a set of measured data for several
materials, where visible-spectrum information was publicly
available:</p>
<div class="figure align-center" id="conductor-ior-list">
<center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 33%" />
<col style="width: 17%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Preset(s)</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Preset(s)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">a-C</span></p></td>
<td><p>Amorphous carbon</p></td>
<td><p><span class="paramtype">Na_palik</span></p></td>
<td><p>Sodium</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Ag</span></p></td>
<td><p>Silver</p></td>
<td><p><span class="paramtype">Nb</span>, <span class="paramtype">Nb_palik</span></p></td>
<td><p>Niobium</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">Al</span></p></td>
<td><p>Aluminium</p></td>
<td><p><span class="paramtype">Ni_palik</span></p></td>
<td><p>Nickel</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">AlAs</span>, <span class="paramtype">AlAs_palik</span></p></td>
<td><p>Cubic aluminium arsenide</p></td>
<td><p><span class="paramtype">Rh</span>, <span class="paramtype">Rh_palik</span></p></td>
<td><p>Rhodium</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">AlSb</span>, <span class="paramtype">AlSb_palik</span></p></td>
<td><p>Cubic aluminium antimonide</p></td>
<td><p><span class="paramtype">Se</span>, <span class="paramtype">Se_palik</span></p></td>
<td><p>Selenium</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Au</span></p></td>
<td><p>Gold</p></td>
<td><p><span class="paramtype">SiC</span>, <span class="paramtype">SiC_palik</span></p></td>
<td><p>Hexagonal silicon carbide</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">Be</span>, <span class="paramtype">Be_palik</span></p></td>
<td><p>Polycrystalline beryllium</p></td>
<td><p><span class="paramtype">SnTe</span>, <span class="paramtype">SnTe_palik</span></p></td>
<td><p>Tin telluride</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Cr</span></p></td>
<td><p>Chromium</p></td>
<td><p><span class="paramtype">Ta</span>, <span class="paramtype">Ta_palik</span></p></td>
<td><p>Tantalum</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">CsI</span>, <span class="paramtype">CsI_palik</span></p></td>
<td><p>Cubic caesium iodide</p></td>
<td><p><span class="paramtype">Te</span>, <span class="paramtype">Te_palik</span></p></td>
<td><p>Trigonal tellurium</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Cu</span>, <span class="paramtype">Cu_palik</span></p></td>
<td><p>Copper</p></td>
<td><p><span class="paramtype">ThF4</span>, <span class="paramtype">ThF4_palik</span></p></td>
<td><p>Polycryst. thorium (IV) fluoride</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">Cu2O</span>, <span class="paramtype">Cu2O_palik</span></p></td>
<td><p>Copper (I) oxide</p></td>
<td><p><span class="paramtype">TiC</span>, <span class="paramtype">TiC_palik</span></p></td>
<td><p>Polycrystalline titanium carbide</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">CuO</span>, <span class="paramtype">CuO_palik</span></p></td>
<td><p>Copper (II) oxide</p></td>
<td><p><span class="paramtype">TiN</span>, <span class="paramtype">TiN_palik</span></p></td>
<td><p>Titanium nitride</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">d-C</span>, <span class="paramtype">d-C_palik</span></p></td>
<td><p>Cubic diamond</p></td>
<td><p><span class="paramtype">TiO2</span>, <span class="paramtype">TiO2_palik</span></p></td>
<td><p>Tetragonal titan. dioxide</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Hg</span>, <span class="paramtype">Hg_palik</span></p></td>
<td><p>Mercury</p></td>
<td><p><span class="paramtype">VC</span>, <span class="paramtype">VC_palik</span></p></td>
<td><p>Vanadium carbide</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">HgTe</span>, <span class="paramtype">HgTe_palik</span></p></td>
<td><p>Mercury telluride</p></td>
<td><p><span class="paramtype">V_palik</span></p></td>
<td><p>Vanadium</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Ir</span>, <span class="paramtype">Ir_palik</span></p></td>
<td><p>Iridium</p></td>
<td><p><span class="paramtype">VN</span>, <span class="paramtype">VN_palik</span></p></td>
<td><p>Vanadium nitride</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">K</span>, <span class="paramtype">K_palik</span></p></td>
<td><p>Polycrystalline potassium</p></td>
<td><p><span class="paramtype">W</span></p></td>
<td><p>Tungsten</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Li</span>, <span class="paramtype">Li_palik</span></p></td>
<td><p>Lithium</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">MgO</span>, <span class="paramtype">MgO_palik</span></p></td>
<td><p>Magnesium oxide</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">Mo</span>, <span class="paramtype">Mo_palik</span></p></td>
<td><p>Molybdenum</p></td>
<td><p><span class="paramtype">none</span></p></td>
<td><p>No mat. profile (100% reflecting mirror)</p></td>
</tr>
</tbody>
</table>
<p class="caption"><span class="caption-text">This table lists all supported materials that can be passed into the
<a class="reference internal" href="#bsdf-conductor"><span class="std std-ref">conductor</span></a> and <a class="reference internal" href="#bsdf-roughconductor"><span class="std std-ref">roughconductor</span></a>
plugins. Note that some of them are not actually conductors—this is not a
problem, they can be used regardless (though only the reflection component
and no transmission will be simulated). In most cases, there are multiple
entries for each material, which represent measurements by different
authors.</span></p>
</center></div><p id="conductor-ior-list">These index of refraction values are identical to the data distributed
with PBRT. They are originally from the <a class="reference external" href="http://www.luxpop.com">Luxpop database</a>
and are based on data by Palik et al. <a class="bibtex reference internal" href="../zz_bibliography.html#palik1998handbook" id="id5">[PG98]</a> and measurements
of atomic scattering factors made by the Center For X-Ray Optics (CXRO) at
Berkeley and the Lawrence Livermore National Laboratory (LLNL).</p>
<p>There is also a special material profile named <span class="paramtype">none</span>, which disables
the computation of Fresnel reflectances and produces an idealized
100% reflecting mirror.</p>
</div>
<div class="section" id="rough-conductor-material-roughconductor">
<span id="bsdf-roughconductor"></span><h2>Rough conductor material (<span class="monosp">roughconductor</span>)<a class="headerlink" href="#rough-conductor-material-roughconductor" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">material</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Name of the material preset, see <a href="#conductor-ior-list">conductor-ior-list</a>. (Default: none)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">eta, k</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Real and imaginary components of the material’s index of refraction. (Default: based on the value of <span class="monosp">material</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component.
Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">distribution</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies the type of microfacet normal distribution used to model the surface roughness.</p>
<ul class="simple">
<li><p><span class="monosp">beckmann</span>: Physically-based distribution derived from Gaussian random surfaces.
This is the default.</p></li>
<li><p><span class="monosp">ggx</span>: The GGX <a class="bibtex reference internal" href="../zz_bibliography.html#walter07microfacet" id="id6">[WMLT07]</a> distribution (also known as Trowbridge-Reitz
<a class="bibtex reference internal" href="../zz_bibliography.html#trowbridge19975average" id="id7">[TR75]</a> distribution) was designed to better approximate the long
tails observed in measurements of ground surfaces, which are not modeled by the Beckmann
distribution.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">alpha, alpha_u, alpha_v</span></p></td>
<td><p><span class="paramtype">texture</span> or <span class="paramtype">float</span></p></td>
<td><p>Specifies the roughness of the unresolved surface micro-geometry along the tangent and
bitangent directions. When the Beckmann distribution is used, this parameter is equal to the
<strong>root mean square</strong> (RMS) slope of the microfacets. <span class="monosp">alpha</span> is a convenience
parameter to initialize both <span class="monosp">alpha_u</span> and <span class="monosp">alpha_v</span> to the same value. (Default: 0.1)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">sample_visible</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Enables a sampling technique proposed by Heitz and D’Eon <a class="bibtex reference internal" href="../zz_bibliography.html#heitz1014importance" id="id8">[HDEon14]</a>, which
focuses computation on the visible parts of the microfacet normal distribution, considerably
reducing variance in some cases. (Default: <span class="monosp">true</span>, i.e. use visible normal sampling)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a realistic microfacet scattering model for rendering
rough conducting materials, such as metals.</p>
<div class="figure compound align-center" id="fig-bsdf-roughconductor">
<div style="width: 49%" class="subfigure align-center" id="id56">
<a class="reference internal image-reference" href="../_images/bsdf_roughconductor_copper.jpg"><img alt="../_images/bsdf_roughconductor_copper.jpg" src="../_images/bsdf_roughconductor_copper.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rough copper (Beckmann, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span>)</span><a class="headerlink" href="#id56" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id57">
<a class="reference internal image-reference" href="../_images/bsdf_roughconductor_anisotropic_aluminium.jpg"><img alt="../_images/bsdf_roughconductor_anisotropic_aluminium.jpg" src="../_images/bsdf_roughconductor_anisotropic_aluminium.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Vertically brushed aluminium (Anisotropic Beckmann, <span class="math notranslate nohighlight">\(\alpha_u=0.05,\ \alpha_v=0.3\)</span>)</span><a class="headerlink" href="#id57" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id58">
<a class="reference internal image-reference" href="../_images/bsdf_roughconductor_textured_carbon.jpg"><img alt="../_images/bsdf_roughconductor_textured_carbon.jpg" src="../_images/bsdf_roughconductor_textured_carbon.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Carbon fiber using two inverted checkerboard textures for <code class="docutils literal notranslate"><span class="pre">alpha_u</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha_v</span></code></span><a class="headerlink" href="#id58" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-roughconductor">Microfacet theory describes rough surfaces as an arrangement of unresolved
and ideally specular facets, whose normal directions are given by a
specially chosen <em>microfacet distribution</em>. By accounting for shadowing
and masking effects between these facets, it is possible to reproduce the
important off-specular reflections peaks observed in real-world measurements
of such materials.</p>
<p>This plugin is essentially the <em>roughened</em> equivalent of the (smooth) plugin
<a class="reference internal" href="#bsdf-conductor"><span class="std std-ref">conductor</span></a>. For very low values of <span class="math notranslate nohighlight">\(\alpha\)</span>, the two will
be identical, though scenes using this plugin will take longer to render
due to the additional computational burden of tracking surface roughness.</p>
<p>The implementation is based on the paper <em>Microfacet Models
for Refraction through Rough Surfaces</em> by Walter et al.
<a class="bibtex reference internal" href="../zz_bibliography.html#walter07microfacet" id="id9">[WMLT07]</a> and it supports two different types of microfacet
distributions.</p>
<p>To facilitate the tedious task of specifying spectrally-varying index of
refraction information, this plugin can access a set of measured materials
for which visible-spectrum information was publicly available
(see the corresponding table in the <a class="reference internal" href="#bsdf-conductor"><span class="std std-ref">conductor</span></a> reference).</p>
<p>When no parameters are given, the plugin activates the default settings,
which describe a 100% reflective mirror with a medium amount of roughness modeled
using a Beckmann distribution.</p>
<p>To get an intuition about the effect of the surface roughness parameter
<span class="math notranslate nohighlight">\(\alpha\)</span>, consider the following approximate classification: a value of
<span class="math notranslate nohighlight">\(\alpha=0.001-0.01\)</span> corresponds to a material with slight imperfections
on an otherwise smooth surface finish, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span> is relatively rough,
and <span class="math notranslate nohighlight">\(\alpha=0.3-0.7\)</span> is <strong>extremely</strong> rough (e.g. an etched or ground
finish). Values significantly above that are probably not too realistic.</p>
<p>The following XML snippet describes a material definition for brushed aluminium:</p>
<div class="highlight-xml notranslate" id="lst-roughconductor-aluminium"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughconductor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;material&quot;</span> <span class="na">value=</span><span class="s">&quot;Al&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;distribution&quot;</span> <span class="na">value=</span><span class="s">&quot;ggx&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;alphaU&quot;</span> <span class="na">value=</span><span class="s">&quot;0.05&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;alphaV&quot;</span> <span class="na">value=</span><span class="s">&quot;0.3&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<div class="section" id="id10">
<h3>Technical details<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>All microfacet distributions allow the specification of two distinct
roughness values along the tangent and bitangent directions. This can be
used to provide a material with a <em>brushed</em> appearance. The alignment
of the anisotropy will follow the UV parameterization of the underlying
mesh. This means that such an anisotropic material cannot be applied to
triangle meshes that are missing texture coordinates.</p>
<p>Since Mitsuba 0.5.1, this plugin uses a new importance sampling technique
contributed by Eric Heitz and Eugene D’Eon, which restricts the sampling
domain to the set of visible (unmasked) microfacet normals. The previous
approach of sampling all normals is still available and can be enabled
by setting <span class="monosp">sample_visible</span> to <span class="monosp">false</span>. However this will lead
to significantly slower convergence.</p>
<p>When using this plugin, you should ideally compile Mitsuba with support for
spectral rendering to get the most accurate results. While it also works
in RGB mode, the computations will be more approximate in nature.
Also note that this material is one-sided—that is, observed from the
back side, it will be completely black. If this is undesirable,
consider using the <a class="reference internal" href="#bsdf-twosided"><span class="std std-ref">twosided</span></a> BRDF adapter.</p>
<p>In <em>polarized</em> rendering modes, the material automatically switches to a polarized
implementation of the underlying Fresnel equations.</p>
</div>
</div>
<div class="section" id="smooth-plastic-material-plastic">
<span id="bsdf-plastic"></span><h2>Smooth plastic material (<span class="monosp">plastic</span>)<a class="headerlink" href="#smooth-plastic-material-plastic" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">diffuse_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor used to modulate the diffuse reflection component. (Default: 0.5)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">nonlinear</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Account for nonlinear color shifts due to internal scattering? See the main text for details..
(Default: Don’t account for them and preserve the texture colors, i.e. <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">int_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Interior index of refraction specified numerically or using a known material name.
(Default: polypropylene / 1.49)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">ext_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Exterior index of refraction specified numerically or using a known material name.
(Default: air / 1.000277)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component. Note that for
physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-plastic">
<div style="width: 49%" class="subfigure align-center" id="id59">
<a class="reference internal image-reference" href="../_images/bsdf_plastic_default.jpg"><img alt="../_images/bsdf_plastic_default.jpg" src="../_images/bsdf_plastic_default.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A rendering with the default parameters</span><a class="headerlink" href="#id59" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id60">
<a class="reference internal image-reference" href="../_images/bsdf_plastic_shiny.jpg"><img alt="../_images/bsdf_plastic_shiny.jpg" src="../_images/bsdf_plastic_shiny.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A rendering with custom parameters</span><a class="headerlink" href="#id60" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-plastic">This plugin describes a smooth plastic-like material with internal scattering. It uses the Fresnel
reflection and transmission coefficients to provide direction-dependent specular and diffuse
components. Since it is simple, realistic, and fast, this model is often a better choice than the
<a class="reference internal" href="#bsdf-roughplastic"><span class="std std-ref">roughplastic</span></a> plugins when rendering smooth plastic-like materials.
For convenience, this model allows to specify IOR values either numerically, or based on a list of
known materials (see the corresponding table in the <a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> reference).
When no parameters are given, the plugin activates the defaults, which describe a white polypropylene
plastic material.</p>
<p>The following XML snippet describes a shiny material whose diffuse reflectance is specified using
sRGB:</p>
<div class="highlight-xml notranslate" id="plastic-shiny"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;plastic&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rgb</span> <span class="na">name=</span><span class="s">&quot;diffuse_reflectance&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1, 0.27, 0.36&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;int_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;1.9&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<div class="section" id="internal-scattering">
<h3>Internal scattering<a class="headerlink" href="#internal-scattering" title="Permalink to this headline">¶</a></h3>
<p>Internally, this model simulates the interaction of light with a diffuse
base surface coated by a thin dielectric layer. This is a convenient
abstraction rather than a restriction. In other words, there are many
materials that can be rendered with this model, even if they might not
fit this description perfectly well.</p>
<div class="figure compound align-center" id="fig-bsdf-plastic-intscat">
<div style="width: 49%" class="subfigure align-center" id="fig-plastic-intscat-a">
<a class="reference internal image-reference" href="../_images/plastic_intscat_1.svg"><img alt="../_images/plastic_intscat_1.svg" src="../_images/plastic_intscat_1.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">(<strong>a</strong>) At the boundary, incident illumination is partly reflected and refracted</span><a class="headerlink" href="#fig-plastic-intscat-a" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="fig-plastic-intscat-b">
<a class="reference internal image-reference" href="../_images/plastic_intscat_2.svg"><img alt="../_images/plastic_intscat_2.svg" src="../_images/plastic_intscat_2.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">(<strong>b</strong>) The refracted portion scatters diffusely at the base layer</span><a class="headerlink" href="#fig-plastic-intscat-b" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="fig-plastic-intscat-c">
<a class="reference internal image-reference" href="../_images/plastic_intscat_3.svg"><img alt="../_images/plastic_intscat_3.svg" src="../_images/plastic_intscat_3.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">(<strong>c</strong>) An illustration of the scattering events that are internally handled by this plugin</span><a class="headerlink" href="#fig-plastic-intscat-c" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-plastic-intscat">Given illumination that is incident upon such a material, a portion
of the illumination is specularly reflected at the material
boundary, which results in a sharp reflection in the mirror direction (<strong>a</strong>).
The remaining illumination refracts into the material, where it
scatters from the diffuse base layer (<strong>b</strong>).
While some of the diffusely scattered illumination is able to
directly refract outwards again, the remainder is reflected from the
interior side of the dielectric boundary and will in fact remain
trapped inside the material for some number of internal scattering
events until it is finally able to escape (<strong>c</strong>).</p>
<p>Due to the mathematical simplicity of this setup, it is possible to work
out the correct form of the model without actually having to simulate
the potentially large number of internal scattering events.</p>
<p>Note that due to the internal scattering, the diffuse color of the
material is in practice slightly different from the color of the
base layer on its own—in particular, the material color will tend to shift towards
darker colors with higher saturation. Since this can be counter-intuitive when
using bitmap textures, these color shifts are disabled by default. Specify
the parameter <code class="code docutils literal notranslate"><span class="pre">nonlinear=true</span></code> to enable them. The following renderings
illustrate the resulting change:</p>
<div class="figure compound align-center" id="fig-bsdf-plastic-nonlinear">
<div style="width: 49%" class="subfigure align-center" id="id61">
<a class="reference internal image-reference" href="../_images/bsdf_plastic_diffuse.jpg"><img alt="../_images/bsdf_plastic_diffuse.jpg" src="../_images/bsdf_plastic_diffuse.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Diffuse textured rendering</span><a class="headerlink" href="#id61" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id62">
<a class="reference internal image-reference" href="../_images/bsdf_plastic_preserve.jpg"><img alt="../_images/bsdf_plastic_preserve.jpg" src="../_images/bsdf_plastic_preserve.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Plastic model, <code class="code docutils literal notranslate"><span class="pre">nonlinear=false</span></code></span><a class="headerlink" href="#id62" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id63">
<a class="reference internal image-reference" href="../_images/bsdf_plastic_nopreserve.jpg"><img alt="../_images/bsdf_plastic_nopreserve.jpg" src="../_images/bsdf_plastic_nopreserve.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Plastic model, <code class="code docutils literal notranslate"><span class="pre">nonlinear=true</span></code></span><a class="headerlink" href="#id63" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-plastic-nonlinear">This effect is also seen in real life,
for instance a piece of wood will look slightly darker after coating it
with a layer of varnish.</p>
</div>
</div>
<div class="section" id="rough-plastic-material-roughplastic">
<span id="bsdf-roughplastic"></span><h2>Rough plastic material (<span class="monosp">roughplastic</span>)<a class="headerlink" href="#rough-plastic-material-roughplastic" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">diffuse_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor used to modulate the diffuse reflection component. (Default: 0.5)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">nonlinear</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Account for nonlinear color shifts due to internal scattering? See the
<a class="reference internal" href="#bsdf-plastic"><span class="std std-ref">plastic</span></a> plugin for details.
default{Don’t account for them and preserve the texture colors. (Default: <span class="monosp">false</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">int_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Interior index of refraction specified numerically or using a known material name. (Default: polypropylene / 1.49)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">ext_ior</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">string</span></p></td>
<td><p>Exterior index of refraction specified numerically or using a known material name.  (Default: air / 1.000277)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">specular_reflectance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular reflection component.
Note that for physical realism, this parameter should never be touched. (Default: 1.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">distribution</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies the type of microfacet normal distribution used to model the surface roughness.</p>
<ul class="simple">
<li><p><span class="monosp">beckmann</span>: Physically-based distribution derived from Gaussian random surfaces.
This is the default.</p></li>
<li><p><span class="monosp">ggx</span>: The GGX <a class="bibtex reference internal" href="../zz_bibliography.html#walter07microfacet" id="id11">[WMLT07]</a> distribution (also known as Trowbridge-Reitz
<a class="bibtex reference internal" href="../zz_bibliography.html#trowbridge19975average" id="id12">[TR75]</a> distribution) was designed to better approximate the long
tails observed in measurements of ground surfaces, which are not modeled by the Beckmann
distribution.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">alpha</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Specifies the roughness of the unresolved surface micro-geometry along the tangent and
bitangent directions. When the Beckmann distribution is used, this parameter is equal to the
<strong>root mean square</strong> (RMS) slope of the microfacets. (Default: 0.1)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">sample_visible</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Enables a sampling technique proposed by Heitz and D’Eon <a class="bibtex reference internal" href="../zz_bibliography.html#heitz1014importance" id="id13">[HDEon14]</a>, which
focuses computation on the visible parts of the microfacet normal distribution, considerably
reducing variance in some cases. (Default: <span class="monosp">true</span>, i.e. use visible normal sampling)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a realistic microfacet scattering model for rendering
rough dielectric materials with internal scattering, such as plastic.</p>
<p>Microfacet theory describes rough surfaces as an arrangement of unresolved and ideally specular
facets, whose normal directions are given by a specially chosen <em>microfacet distribution</em>.
By accounting for shadowing and masking effects between these facets, it is possible to reproduce
the important off-specular reflections peaks observed in real-world measurements of such materials.</p>
<div class="figure compound align-center" id="fig-bsdf-roughplastic">
<div style="width: 49%" class="subfigure align-center" id="id64">
<a class="reference internal image-reference" href="../_images/bsdf_roughplastic_beckmann.jpg"><img alt="../_images/bsdf_roughplastic_beckmann.jpg" src="../_images/bsdf_roughplastic_beckmann.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Beckmann, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span></span><a class="headerlink" href="#id64" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id65">
<a class="reference internal image-reference" href="../_images/bsdf_roughplastic_ggx.jpg"><img alt="../_images/bsdf_roughplastic_ggx.jpg" src="../_images/bsdf_roughplastic_ggx.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">GGX, <span class="math notranslate nohighlight">\(\alpha=0.3\)</span></span><a class="headerlink" href="#id65" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-roughplastic">This plugin is essentially the <em>roughened</em> equivalent of the (smooth) plugin
<a class="reference internal" href="#bsdf-plastic"><span class="std std-ref">plastic</span></a>. For very low values of <span class="math notranslate nohighlight">\(\alpha\)</span>, the two will
be identical, though scenes using this plugin will take longer to render
due to the additional computational burden of tracking surface roughness.</p>
<p>For convenience, this model allows to specify IOR values either numerically, or
based on a list of known materials (see the corresponding table in the
<a class="reference internal" href="#bsdf-dielectric"><span class="std std-ref">dielectric</span></a> reference). When no parameters are given,
the plugin activates the defaults, which describe a white polypropylene plastic
material with a light amount of roughness modeled using the Beckmann distribution.</p>
<p>To get an intuition about the effect of the surface roughness parameter
<span class="math notranslate nohighlight">\(\alpha\)</span>, consider the following approximate classification: a value of
<span class="math notranslate nohighlight">\(\alpha=0.001-0.01\)</span> corresponds to a material with slight imperfections
on an otherwise smooth surface finish, <span class="math notranslate nohighlight">\(\alpha=0.1\)</span> is relatively rough,
and <span class="math notranslate nohighlight">\(\alpha=0.3-0.7\)</span> is <strong>extremely</strong> rough (e.g. an etched or ground
finish). Values significantly above that are probably not too realistic.</p>
<p>The following XML snippet describes a material definition for black plastic material.</p>
<div class="highlight-xml notranslate" id="lst-roughplastic-black"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughplastic&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;distribution&quot;</span> <span class="na">value=</span><span class="s">&quot;beckmann&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;int_ior&quot;</span> <span class="na">value=</span><span class="s">&quot;1.61&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;diffuse_reflectance&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>Like the <a class="reference internal" href="#bsdf-plastic"><span class="std std-ref">plastic</span></a> material, this model internally simulates the
interaction of light with a diffuse base surface coated by a thin dielectric
layer (where the coating layer is now <strong>rough</strong>). This is a convenient
abstraction rather than a restriction. In other words, there are many
materials that can be rendered with this model, even if they might not
fit this description perfectly well.</p>
<p>The simplicity of this setup makes it possible to account for interesting
nonlinear effects due to internal scattering, which is controlled by
the <span class="monosp">nonlinear</span> parameter:</p>
<div class="figure compound align-center" id="fig-bsdf-roughplastic-nonlinear">
<div style="width: 49%" class="subfigure align-center" id="fig-roughplastic-diffuse">
<a class="reference internal image-reference" href="../_images/bsdf_roughplastic_diffuse.jpg"><img alt="../_images/bsdf_roughplastic_diffuse.jpg" src="../_images/bsdf_roughplastic_diffuse.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Diffuse textured rendering</span><a class="headerlink" href="#fig-roughplastic-diffuse" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="fig-roughplastic-preserve">
<a class="reference internal image-reference" href="../_images/bsdf_roughplastic_preserve.jpg"><img alt="../_images/bsdf_roughplastic_preserve.jpg" src="../_images/bsdf_roughplastic_preserve.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rough plastic model with <span class="monosp">nonlinear=false</span></span><a class="headerlink" href="#fig-roughplastic-preserve" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="fig-roughplastic-nopreserve">
<a class="reference internal image-reference" href="../_images/bsdf_roughplastic_nopreserve.jpg"><img alt="../_images/bsdf_roughplastic_nopreserve.jpg" src="../_images/bsdf_roughplastic_nopreserve.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Textured rough plastic model with <span class="monosp">nonlinear=true</span></span><a class="headerlink" href="#fig-roughplastic-nopreserve" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-roughplastic-nonlinear">For more details, please refer to the description
of this parameter given in the <a class="reference internal" href="#bsdf-plastic"><span class="std std-ref">plastic</span></a> plugin section.</p>
</div>
<div class="section" id="bump-map-bsdf-adapter-bumpmap">
<span id="bsdf-bumpmap"></span><h2>Bump map BSDF adapter (<span class="monosp">bumpmap</span>)<a class="headerlink" href="#bump-map-bsdf-adapter-bumpmap" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">texture</span></p></td>
<td><p>Specifies the bump map texture.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">bsdf</span></p></td>
<td><p>A BSDF model that should be affected by the bump map</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">scale</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Bump map gradient multiplier. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<p>Bump mapping is a simple technique for cheaply adding surface detail to a rendering. This is done
by perturbing the shading coordinate frame based on a displacement height field provided as a
texture. This method can lend objects a highly realistic and detailed appearance (e.g. wrinkled
or covered by scratches and other imperfections) without requiring any changes to the input geometry.
The implementation in Mitsuba uses the common approach of ignoring the usually negligible
texture-space derivative of the base mesh surface normal. As side effect of this decision,
it is invariant to constant offsets in the height field texture: only variations in its luminance
cause changes to the shading frame.</p>
<p>Note that the magnitude of the height field variations influences the scale of the displacement.</p>
<div class="figure compound align-center" id="fig-bumpmap">
<div style="width: 49%" class="subfigure align-center" id="id66">
<a class="reference internal image-reference" href="../_images/bsdf_bumpmap_without.jpg"><img alt="../_images/bsdf_bumpmap_without.jpg" src="../_images/bsdf_bumpmap_without.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Roughplastic BSDF</span><a class="headerlink" href="#id66" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id67">
<a class="reference internal image-reference" href="../_images/bsdf_bumpmap_with.jpg"><img alt="../_images/bsdf_bumpmap_with.jpg" src="../_images/bsdf_bumpmap_with.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Roughplastic BSDF with bump mapping</span><a class="headerlink" href="#id67" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bumpmap">The following XML snippet describes a rough plastic material affected by a bump
map. Note the we set the <code class="docutils literal notranslate"><span class="pre">raw</span></code> properties of the bump map <code class="docutils literal notranslate"><span class="pre">bitmap</span></code> object to
<code class="docutils literal notranslate"><span class="pre">true</span></code> in order to disable the transformation from sRGB to linear encoding:</p>
<div class="highlight-xml notranslate" id="bumpmap"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;bumpmap&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;arbitrary&quot;</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;boolean</span> <span class="na">name=</span><span class="s">&quot;raw&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;textures/bumpmap.jpg&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughplastic&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="normal-map-bsdf-normalmap">
<span id="bsdf-normalmap"></span><h2>Normal map BSDF (<span class="monosp">normalmap</span>)<a class="headerlink" href="#normal-map-bsdf-normalmap" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">normalmap</span></p></td>
<td><p><span class="paramtype">texture</span></p></td>
<td><p>The color values of this texture specify the perturbed normals relative in the local surface coordinate system</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">bsdf</span></p></td>
<td><p>A BSDF model that should be affected by the normal map</p></td>
</tr>
</tbody>
</table>
<p>Normal mapping is a simple technique for cheaply adding surface detail to a rendering. This is done
by perturbing the shading coordinate frame based on a normal map provided as a texture. This method
can lend objects a highly realistic and detailed appearance (e.g. wrinkled or covered by scratches
and other imperfections) without requiring any changes to the input geometry.</p>
<div class="figure compound align-center" id="fig-normalmap">
<div style="width: 49%" class="subfigure align-center" id="id68">
<a class="reference internal image-reference" href="../_images/bsdf_normalmap_without.jpg"><img alt="../_images/bsdf_normalmap_without.jpg" src="../_images/bsdf_normalmap_without.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Roughplastic BSDF</span><a class="headerlink" href="#id68" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id69">
<a class="reference internal image-reference" href="../_images/bsdf_normalmap_with.jpg"><img alt="../_images/bsdf_normalmap_with.jpg" src="../_images/bsdf_normalmap_with.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Roughplastic BSDF with normal mapping</span><a class="headerlink" href="#id69" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-normalmap">A normal map is a RGB texture, whose color channels encode the XYZ coordinates of the desired
surface normals. These are specified <strong>relative</strong> to the local shading frame, which means that a
normal map with a value of <span class="math notranslate nohighlight">\((0,0,1)\)</span> everywhere causes no changes to the surface. To turn the
3D normal directions into (nonnegative) color values suitable for this plugin, the mapping
<span class="math notranslate nohighlight">\(x \mapsto (x+1)/2\)</span> must be applied to each component.</p>
<p>The following XML snippet describes a smooth mirror material affected by a normal map. Note the we set the
<code class="docutils literal notranslate"><span class="pre">raw</span></code> properties of the normal map <code class="docutils literal notranslate"><span class="pre">bitmap</span></code> object to <code class="docutils literal notranslate"><span class="pre">true</span></code> in order to disable the
transformation from sRGB to linear encoding:</p>
<div class="highlight-xml notranslate" id="normalmap"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;normalmap&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;normalmap&quot;</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;boolean</span> <span class="na">name=</span><span class="s">&quot;raw&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;textures/normalmap.jpg&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughplastic&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="blended-material-blendbsdf">
<span id="bsdf-blendbsdf"></span><h2>Blended material (<span class="monosp">blendbsdf</span>)<a class="headerlink" href="#blended-material-blendbsdf" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">weight</span></p></td>
<td><p><span class="paramtype">float</span> or <span class="paramtype">texture</span></p></td>
<td><p>A floating point value or texture with values between zero and one. The extreme values zero and
one activate the first and second nested BSDF respectively, and inbetween values interpolate
accordingly. (Default: 0.5)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">bsdf</span></p></td>
<td><p>Two nested BSDF instances that should be mixed according to the specified blending weight</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-blendbsdf">
<div style="width: 49%" class="subfigure align-center" id="id70">
<a class="reference internal image-reference" href="../_images/bsdf_blendbsdf.jpg"><img alt="../_images/bsdf_blendbsdf.jpg" src="../_images/bsdf_blendbsdf.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A material created by blending between rough plastic and smooth metal based on a binary bitmap texture</span><a class="headerlink" href="#id70" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-blendbsdf">This plugin implements a <em>blend</em> material, which represents
linear combinations of two BSDF instances. Any surface scattering model in Mitsuba 2 (be it smooth,
rough, reflecting, or transmitting) can be mixed with others in this manner to synthesize new models.</p>
<p>The following XML snippet describes the material shown above:</p>
<div class="highlight-xml notranslate" id="blendbsdf"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;blendbsdf&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;weight&quot;</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;pattern.png&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;conductor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;roughplastic&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;diffuse_reflectance&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="opacity-mask-mask">
<span id="bsdf-mask"></span><h2>Opacity mask (<span class="monosp">mask</span>)<a class="headerlink" href="#opacity-mask-mask" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">opacity</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Specifies the opacity (where 1=completely opaque) (Default: 0.5)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">bsdf</span></p></td>
<td><p>A base BSDF model that represents the non-transparent portion of the scattering</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-mask">
<div style="width: 49%" class="subfigure align-center" id="id71">
<a class="reference internal image-reference" href="../_images/bsdf_mask_before.jpg"><img alt="../_images/bsdf_mask_before.jpg" src="../_images/bsdf_mask_before.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rendering without an opacity mask</span><a class="headerlink" href="#id71" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id72">
<a class="reference internal image-reference" href="../_images/bsdf_mask_after.jpg"><img alt="../_images/bsdf_mask_after.jpg" src="../_images/bsdf_mask_after.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Rendering <strong>with</strong> an opacity mask</span><a class="headerlink" href="#id72" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-mask">This plugin applies an opacity mask to add nested BSDF instance. It interpolates
between perfectly transparent and completely opaque based on the <span class="monosp">opacity</span> parameter.</p>
<p>The transparency is internally implemented as a forward-facing Dirac delta distribution.
Note that the standard <a class="reference internal" href="#integrator-path"><span class="std std-ref">path tracer</span></a> does not have a good sampling strategy to deal with this,
but the (<a class="reference internal" href="#integrator-volpath"><span class="std std-ref">volumetric path tracer</span></a>) does. It may thus be preferable when rendering
scenes that contain the <a class="reference internal" href="#bsdf-mask"><span class="std std-ref">mask</span></a> plugin, even if there is nothing <em>volumetric</em> in the scene.</p>
<p>The following XML snippet describes a material configuration for a transparent leaf:</p>
<div class="highlight-xml notranslate" id="mask-leaf"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;mask&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Base material: a two-sided textured diffuse BSDF --&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;twosided&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;texture</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;leaf.png&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/texture&gt;</span>
        <span class="nt">&lt;/bsdf&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>

    <span class="c">&lt;!-- Fetch the opacity mask from a monochromatic texture --&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">type=</span><span class="s">&quot;bitmap&quot;</span> <span class="na">name=</span><span class="s">&quot;opacity&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;leaf_mask.png&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="two-sided-brdf-adapter-twosided">
<span id="bsdf-twosided"></span><h2>Two-sided BRDF adapter (<span class="monosp">twosided</span>)<a class="headerlink" href="#two-sided-brdf-adapter-twosided" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">bsdf</span></p></td>
<td><p>A nested BRDF that should be turned into a two-sided scattering model. If two BRDFs are specified, they will be placed on the front and back side, respectively</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-bsdf-twosided">
<div style="width: 49%" class="subfigure align-center" id="id73">
<a class="reference internal image-reference" href="../_images/bsdf_twosided_cbox_onesided.jpg"><img alt="../_images/bsdf_twosided_cbox_onesided.jpg" src="../_images/bsdf_twosided_cbox_onesided.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">From this angle, the Cornell box scene shows visible back-facing geometry</span><a class="headerlink" href="#id73" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id74">
<a class="reference internal image-reference" href="../_images/bsdf_twosided_cbox.jpg"><img alt="../_images/bsdf_twosided_cbox.jpg" src="../_images/bsdf_twosided_cbox.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Applying the <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">twosided</span></code> plugin fixes the rendering</span><a class="headerlink" href="#id74" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-bsdf-twosided">By default, all non-transmissive scattering models in Mitsuba 2
are <em>one-sided</em> — in other words, they absorb all light
that is received on the interior-facing side of any associated
surfaces. Holes and visible back-facing parts are thus exposed
as black regions.</p>
<p>Usually, this is a good idea, since it will reveal modeling
issues early on. But sometimes one is forced to deal with
improperly closed geometry, where the one-sided behavior is
bothersome. In that case, this plugin can be used to turn
one-sided scattering models into proper two-sided versions of
themselves. The plugin has no parameters other than a required
nested BSDF specification. It is also possible to supply two
different BRDFs that should be placed on the front and back
side, respectively.</p>
<p>The following snippet describes a two-sided diffuse material:</p>
<div class="highlight-xml notranslate" id="twosided"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;twosided&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span> <span class="na">value=</span><span class="s">&quot;0.4&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="null-material-null">
<span id="bsdf-null"></span><h2>Null material (<span class="monosp">null</span>)<a class="headerlink" href="#null-material-null" title="Permalink to this headline">¶</a></h2>
<p>This plugin models a completely invisible surface material.
Light will not interact with this BSDF in any way.</p>
<p>Internally, this is implemented as a forward-facing Dirac delta distribution.
Note that the standard <a class="reference internal" href="#integrator-path"><span class="std std-ref">path tracer</span></a> does not have a good sampling strategy to deal with this,
but the (<a class="reference internal" href="#integrator-volpath"><span class="std std-ref">volumetric path tracer</span></a>) does.</p>
<p>The main purpose of this material is to be used as the BSDF of a shape enclosing a participating medium.</p>
</div>
<div class="section" id="linear-polarizer-material-polarizer">
<span id="bsdf-polarizer"></span><h2>Linear polarizer material (<span class="monosp">polarizer</span>)<a class="headerlink" href="#linear-polarizer-material-polarizer" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">theta</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Specifies the rotation angle (in degrees) of the polarizer around the optical axis (Default: 0.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">transmittance</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Optional factor that can be used to modulate the specular transmission. (Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<p>This material simulates an ideal linear polarizer useful to test polarization aware
light transport or to conduct virtual optical experiments. The aborbing axis of the
polarizer is aligned with the <em>V</em>-direction of the underlying surface parameterization.
To rotate the polarizer, either the parameter <code class="docutils literal notranslate"><span class="pre">theta</span></code> can be used, or alternative
a rotation can be applied directly to the associated shape.</p>
<div class="figure compound align-center" id="fig-polarizer">
<div style="width: 49%" class="subfigure align-center" id="id75">
<a class="reference internal image-reference" href="../_images/bsdf_polarizer_aligned.jpg"><img alt="../_images/bsdf_polarizer_aligned.jpg" src="../_images/bsdf_polarizer_aligned.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Two aligned polarizers. The average intensity is reduced by a factor of 2.</span><a class="headerlink" href="#id75" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id76">
<a class="reference internal image-reference" href="../_images/bsdf_polarizer_absorbing.jpg"><img alt="../_images/bsdf_polarizer_absorbing.jpg" src="../_images/bsdf_polarizer_absorbing.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Two polarizers offset by 90 degrees. All trasmitted light is aborbed.</span><a class="headerlink" href="#id76" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id77">
<a class="reference internal image-reference" href="../_images/bsdf_polarizer_middle.jpg"><img alt="../_images/bsdf_polarizer_middle.jpg" src="../_images/bsdf_polarizer_middle.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Two polarizers offset by 90 degrees, with a third polarizer in between at 45 degrees. Some light is transmitted again.</span><a class="headerlink" href="#id77" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-polarizer">The following XML snippet describes a linear polarizer material with a rotation
of 90 degrees.</p>
<div class="highlight-xml notranslate" id="polarizer"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;polarizer&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;theta&quot;</span> <span class="na">value=</span><span class="s">&quot;90&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>Apart from a change of polarization, light does not interact with this material
in any way and does not change its direction.
Internally, this is implemented as a forward-facing Dirac delta distribution.
Note that the standard <a class="reference internal" href="#integrator-path"><span class="std std-ref">path tracer</span></a> does not have a good sampling strategy to deal with this,
but the (<a class="reference internal" href="#integrator-volpath"><span class="std std-ref">volumetric path tracer</span></a>) does.</p>
<p>In <em>unpolarized</em> rendering modes, the behaviour defaults to a non-polarizing
transmitting material that absorbs 50% of the incident illumination.</p>
</div>
<div class="section" id="linear-retarder-material-retarder">
<span id="bsdf-retarder"></span><h2>Linear retarder material (<span class="monosp">retarder</span>)<a class="headerlink" href="#linear-retarder-material-retarder" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">theta</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Specifies the rotation angle (in degrees) of the retarder around the optical axis (Default: 0.0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">delta</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Specifies the retardance (in degrees) where 360 degrees is equivalent to a full wavelength. (Default: 90.0)</p></td>
</tr>
</tbody>
</table>
<p>This material simulates an ideal linear retarder useful to test polarization aware
light transport or to conduct virtual optical experiments. The fast axis of the
retarder is aligned with the <em>U</em>-direction of the underlying surface parameterization.
For non-perpendicular incidence, a cosine falloff term is applied to the retardance.</p>
<p>This plugin can be used to instantiate the  common special cases of
<em>half-wave plates</em> (with <code class="docutils literal notranslate"><span class="pre">delta=180</span></code>) and <em>quarter-wave plates</em> (with <code class="docutils literal notranslate"><span class="pre">delta=90</span></code>).</p>
<p>The following XML snippet describes a quarter-wave plate material:</p>
<div class="highlight-xml notranslate" id="retarder"><div class="highlight"><pre><span></span><span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;retarder&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;delta&quot;</span> <span class="na">value=</span><span class="s">&quot;90&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bsdf&gt;</span>
</pre></div>
</div>
<p>Apart from a change of polarization, light does not interact with this material
in any way and does not change its direction.
Internally, this is implemented as a forward-facing Dirac delta distribution.
Note that the standard <a class="reference internal" href="#integrator-path"><span class="std std-ref">path tracer</span></a> does not have a good sampling strategy to deal with this,
but the (<a class="reference internal" href="#integrator-volpath"><span class="std std-ref">volumetric path tracer</span></a>) does.</p>
<p>In <em>unpolarized</em> rendering modes, the behaviour defaults to non-polarizing
transparent material similar to the <a class="reference internal" href="#bsdf-null"><span class="std std-ref">null</span></a> BSDF plugin.</p>
</div>
</div>
<div class="section" id="sec-phase">
<span id="id14"></span><h1>相位函数<a class="headerlink" href="#sec-phase" title="Permalink to this headline">¶</a></h1>
<p>本节包含了有关所有介质散射模型实现的描述，这也被称作相位函数（phase function）。
在原则上这些模型与表面散射模型（或 BSDF）非常相似，本质上描述了光在击中介质中一个粒子后的传播路径。
目前为止，只有大部分常见烟、雾和其他均匀介质是被实现了的。</p>
<div class="section" id="isotropic-phase-function-isotropic">
<span id="phase-isotropic"></span><h2>Isotropic phase function (<span class="monosp">isotropic</span>)<a class="headerlink" href="#isotropic-phase-function-isotropic" title="Permalink to this headline">¶</a></h2>
<p>This phase function simulates completely uniform scattering,
where all directionality is lost after a single scattering
interaction. It does not have any parameters.</p>
</div>
<div class="section" id="henyey-greenstein-phase-function-hg">
<span id="phase-hg"></span><h2>Henyey-Greenstein phase function (<span class="monosp">hg</span>)<a class="headerlink" href="#henyey-greenstein-phase-function-hg" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-given paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>g</p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>This parameter must be somewhere in the range -1 to 1
(but not equal to -1 or 1). It denotes the <em>mean cosine</em> of scattering
interactions. A value greater than zero indicates that medium interactions
predominantly scatter incident light into a similar direction (i.e. the
medium is <em>forward-scattering</em>), whereas values smaller than zero cause
the medium to be scatter more light in the opposite direction.</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements the phase function model proposed by
Henyey and Greenstein <a class="bibtex reference internal" href="../zz_bibliography.html#henyey1941diffuse" id="id15">[HG41]</a>. It is
parameterizable from backward- (g&lt;0) through
isotropic- (g=0) to forward (g&gt;0) scattering.</p>
</div>
</div>
<div class="section" id="sec-emitters">
<span id="id16"></span><h1>光源<a class="headerlink" href="#sec-emitters" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/emitter_overview.jpg"><img alt="../_images/emitter_overview.jpg" class="align-center" src="../_images/emitter_overview.jpg" style="width: 70%;" /></a>
<p>Schematic overview of the emitters in Mitsuba 2. The arrows indicate
the directional distribution of light.</p>
</div></blockquote>
<p>Mitsuba 2 支持大量不同类型的光源，这些光源大致上可以分成两类：坐落在场景内的光源，围绕在场景外模拟在远处的光源。</p>
<p>一般来说，光源是 <code class="docutils literal notranslate"><span class="pre">&lt;scene&gt;</span></code> 这一元素的子类；例如，下面的代码片段实例化了一个点光源发射器：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">&quot;2.0.0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;emitter</span> <span class="na">type=</span><span class="s">&quot;point&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;intensity&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;position&quot;</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;-2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/emitter&gt;</span>

    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>有一个例外是面光源，面光源是将一个几何物体变为了光源。所以它们被指定为 <code class="docutils literal notranslate"><span class="pre">&lt;shape&gt;</span></code> 这一元素的子类：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">&quot;2.0.0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;emitter</span> <span class="na">type=</span><span class="s">&quot;area&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;radiance&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/emitter&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<div class="section" id="area-light-area">
<span id="emitter-area"></span><h2>Area light (<span class="monosp">area</span>)<a class="headerlink" href="#area-light-area" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">radiance</span></p></td>
<td><p><span class="paramtype">spectrum</span></p></td>
<td><p>Specifies the emitted radiance in units of power per unit area per unit steradian.</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements an area light, i.e. a light source that emits
diffuse illumination from the exterior of an arbitrary shape.
Since the emission profile of an area light is completely diffuse, it
has the same apparent brightness regardless of the observer’s viewing
direction. Furthermore, since it occupies a nonzero amount of space, an
area light generally causes scene objects to cast soft shadows.</p>
<p>To create an area light source, simply instantiate the desired
emitter shape and specify an <span class="monosp">area</span> instance as its child:</p>
<div class="highlight-xml notranslate" id="sphere-light"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;emitter</span> <span class="na">type=</span><span class="s">&quot;area&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;spectrum</span> <span class="na">name=</span><span class="s">&quot;radiance&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/emitter&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="point-light-source-point">
<span id="emitter-point"></span><h2>Point light source (<span class="monosp">point</span>)<a class="headerlink" href="#point-light-source-point" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">intensity</span></p></td>
<td><p><span class="paramtype">spectrum</span></p></td>
<td><p>Specifies the radiant intensity in units of power per unit steradian.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">position</span></p></td>
<td><p><span class="paramtype">point</span></p></td>
<td><p>Alternative parameter for specifying the light source position.
Note that only one of the parameters <span class="monosp">to_world</span> and
<span class="monosp">position</span> can be used at a time.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional emitter-to-world transformation.  (Default: none,
i.e. emitter space = world space)</p></td>
</tr>
</tbody>
</table>
<p>This emitter plugin implements a simple point light source, which
uniformly radiates illumination into all directions.</p>
</div>
<div class="section" id="constant-environment-emitter-constant">
<span id="emitter-constant"></span><h2>Constant environment emitter (<span class="monosp">constant</span>)<a class="headerlink" href="#constant-environment-emitter-constant" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">radiance</span></p></td>
<td><p><span class="paramtype">spectrum</span></p></td>
<td><p>Specifies the emitted radiance in units of power per unit area per unit steradian.</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements a constant environment emitter, which surrounds
the scene and radiates diffuse illumination towards it. This is often
a good default light source when the goal is to visualize some loaded
geometry that uses basic (e.g. diffuse) materials.</p>
</div>
<div class="section" id="environment-emitter-envmap">
<span id="emitter-envmap"></span><h2>Environment emitter (<span class="monosp">envmap</span>)<a class="headerlink" href="#environment-emitter-envmap" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">filename</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Filename of the radiance-valued input image to be loaded; must be in latitude-longitude format.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">scale</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>A scale factor that is applied to the radiance values stored in the input image. (Default: 1.0)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional emitter-to-world transformation.  (Default: none, i.e. emitter space = world space)</p></td>
</tr>
</tbody>
</table>
<p>This plugin provides a HDRI (high dynamic range imaging) environment map,
which is a type of light source that is well-suited for representing “natural”
illumination.</p>
<p>The implementation loads a captured illumination environment from a image in
latitude-longitude format and turns it into an infinitely distant emitter. The
conventions of this mapping are shown in this image:</p>
<div class="figure compound align-center" id="fig-envmap-mapping">
<div style="width: 49%" class="subfigure align-center" id="id78">
<a class="reference internal image-reference" href="../_images/emitter_envmap_example.jpg"><img alt="../_images/emitter_envmap_example.jpg" src="../_images/emitter_envmap_example.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The museum environment map by Bernhard Vogl that is used in
many example renderings in this documentation.</span><a class="headerlink" href="#id78" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id79">
<a class="reference internal image-reference" href="../_images/emitter_envmap_axes.jpg"><img alt="../_images/emitter_envmap_axes.jpg" src="../_images/emitter_envmap_axes.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Coordinate conventions used when mapping the input image onto the sphere.</span><a class="headerlink" href="#id79" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-envmap-mapping">The plugin can work with all types of images that are natively supported by Mitsuba
(i.e. JPEG, PNG, OpenEXR, RGBE, TGA, and BMP). In practice, a good environment
map will contain high-dynamic range data that can only be represented using the
OpenEXR or RGBE file formats.
High quality free light probes are available on
<a class="reference external" href="http://gl.ict.usc.edu/Data/HighResProbes">Paul Debevec’s</a> and
<a class="reference external" href="http://dativ.at/lightprobes/">Bernhard Vogl’s</a> websites.</p>
</div>
<div class="section" id="spot-light-source-spot">
<span id="emitter-spot"></span><h2>Spot light source (<span class="monosp">spot</span>)<a class="headerlink" href="#spot-light-source-spot" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">intensity</span></p></td>
<td><p><span class="paramtype">spectrum</span></p></td>
<td><p>Specifies the maximum radiant intensity at the center in units of power per unit steradian. (Default: 1).
This cannot be spatially varying (e.g. have bitmap as type).</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">cutoff_angle</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Cutoff angle, beyond which the spot light is completely black (Default: 20 degrees)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">beam_width</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Subtended angle of the central beam portion (Default: <span class="math notranslate nohighlight">\(cutoff_angle \times 3/4\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">texture</span></p></td>
<td><p><span class="paramtype">texture</span></p></td>
<td><p>An optional texture to be projected along the spot light. This must be spatially varying (e.g. have bitmap as type).</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional emitter-to-world transformation.  (Default: none, i.e. emitter space = world space)</p></td>
</tr>
</tbody>
</table>
<p>This plugin provides a spot light with a linear falloff. In its local coordinate system, the spot light is
positioned at the origin and points along the positive Z direction. It can be conveniently reoriented
using the lookat tag, e.g.:</p>
<div class="highlight-xml notranslate" id="spot-light"><div class="highlight"><pre><span></span><span class="nt">&lt;emitter</span> <span class="na">type=</span><span class="s">&quot;spot&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Orient the light so that points from (1, 1, 1) towards (1, 2, 1) --&gt;</span>
        <span class="nt">&lt;lookat</span> <span class="na">origin=</span><span class="s">&quot;1, 1, 1&quot;</span> <span class="na">target=</span><span class="s">&quot;1, 2, 1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transform&gt;</span>
<span class="nt">&lt;/emitter&gt;</span>
</pre></div>
</div>
<p>The intensity linearly ramps up from cutoff_angle to beam_width (both specified in degrees),
after which it remains at the maximum value. A projection texture may optionally be supplied.</p>
<div class="figure compound align-center" id="fig-spot-light">
<div style="width: 49%" class="subfigure align-center" id="id80">
<a class="reference internal image-reference" href="../_images/emitter_spot_no_texture.jpg"><img alt="../_images/emitter_spot_no_texture.jpg" src="../_images/emitter_spot_no_texture.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Two spot lights with different colors and no texture specified.</span><a class="headerlink" href="#id80" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id81">
<a class="reference internal image-reference" href="../_images/emitter_spot_texture.jpg"><img alt="../_images/emitter_spot_texture.jpg" src="../_images/emitter_spot_texture.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A spot light with a texture specified.</span><a class="headerlink" href="#id81" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="projection-light-source-projector">
<span id="emitter-projector"></span><span id="fig-spot-light"></span><h2>Projection light source (<span class="monosp">projector</span>)<a class="headerlink" href="#projection-light-source-projector" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">irradiance</span></p></td>
<td><p><span class="paramtype">texture</span></p></td>
<td><p>2D texture specifying irradiance on the emitter’s virtual image plane,
which lies at a distance of <span class="math notranslate nohighlight">\(z=1\)</span> from the pinhole. Note that this
does not directly correspond to emitted radiance due to the presence of an
additional directionally varying scale factor equal to to the inverse
sensitivity profile (a.k.a. importance) of a perspective camera. This
ensures that a projection of a constant texture onto a plane is truly
constant.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">scale</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>A scale factor that is applied to the radiance values stored in the above
parameter. (Default: 1.0)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional camera-to-world transformation.
(Default: none (i.e. camera space = world space))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fov</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Denotes the camera’s field of view in degrees—must be between 0 and 180,
excluding the extremes. Alternatively, it is also possible to specify a
field of view using the <span class="monosp">focal_length</span> parameter.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">focal_length</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Denotes the camera’s focal length specified using <em>35mm</em> film
equivalent units. Alternatively, it is also possible to specify a field of
view using the <span class="monosp">fov</span> parameter. See the main description for further
details. (Default: <span class="monosp">50mm</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fov_axis</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>When the parameter <span class="monosp">fov</span> is given (and only then), this parameter further specifies
the image axis, to which it applies.</p>
<ol class="arabic simple">
<li><p><span class="monosp">x</span>: <span class="monosp">fov</span> maps to the <span class="monosp">x</span>-axis in screen space.</p></li>
<li><p><span class="monosp">y</span>: <span class="monosp">fov</span> maps to the <span class="monosp">y</span>-axis in screen space.</p></li>
<li><p><span class="monosp">diagonal</span>: <span class="monosp">fov</span> maps to the screen diagonal.</p></li>
<li><p><span class="monosp">smaller</span>: <span class="monosp">fov</span> maps to the smaller dimension
(e.g. <span class="monosp">x</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
<li><p><span class="monosp">larger</span>: <span class="monosp">fov</span> maps to the larger dimension
(e.g. <span class="monosp">y</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
</ol>
<p>The default is <span class="monosp">x</span>.</p>
</td>
</tr>
</tbody>
</table>
<p>This emitter is the reciprocal counterpart of the perspective camera
implemented by the <a class="reference internal" href="#sensor-perspective"><span class="std std-ref">perspective</span></a> plugin. It
accepts exactly the same parameters and employs the same pixel-to-direction
mapping. In contrast to the perspective camera, it takes an extra texture
(typically of type <a class="reference internal" href="#texture-bitmap"><span class="std std-ref">bitmap</span></a>) as input that it then
projects into the scene, with an optional scaling factor.</p>
<p>Pixels are importance sampled according to their density, hence this
operation remains efficient even if only a single pixel is turned on.</p>
<div class="figure compound align-center" id="fig-projector-light">
<div style="width: 49%" class="subfigure align-center" id="id82">
<a class="reference internal image-reference" href="../_images/emitter_projector_constant.jpg"><img alt="../_images/emitter_projector_constant.jpg" src="../_images/emitter_projector_constant.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A projector lights with constant irradiance (no texture specified).</span><a class="headerlink" href="#id82" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id83">
<a class="reference internal image-reference" href="../_images/emitter_projector_textured.jpg"><img alt="../_images/emitter_projector_textured.jpg" src="../_images/emitter_projector_textured.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">A projector light with a texture specified.</span><a class="headerlink" href="#id83" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="distant-directional-emitter-directional">
<span id="emitter-distant"></span><span id="fig-projector-light"></span><h2>Distant directional emitter (<span class="monosp">directional</span>)<a class="headerlink" href="#distant-directional-emitter-directional" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">irradiance</span></p></td>
<td><p><span class="paramtype">spectrum</span></p></td>
<td><p>Spectral irradiance, which corresponds to the amount of spectral power
per unit area received by a hypothetical surface normal to the specified
direction.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Emitter-to-world transformation matrix.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">direction</span></p></td>
<td><p><span class="paramtype">vector</span></p></td>
<td><p>Alternative (and exclusive) to <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">to_world</span></code>. Direction towards which the
emitter is radiating in world coordinates.</p></td>
</tr>
</tbody>
</table>
<p>This emitter plugin implements a distant directional source which radiates a
specified power per unit area along a fixed direction. By default, the emitter
radiates in the direction of the positive Z axis, i.e. <span class="math notranslate nohighlight">\((0, 0, 1)\)</span>.</p>
</div>
</div>
<div class="section" id="sec-sensors">
<span id="id17"></span><h1>传感器<a class="headerlink" href="#sec-sensors" title="Permalink to this headline">¶</a></h1>
<p>在 Mitsuba 2 中  <em>sensors</em> 以及 <em>film</em> 都是以一些可用格式来纪录辐射度的表达方式。</p>
<p>在 XML 场景描述语言中，一个 sensor 可以如下进行定义：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- .. scene contents .. --&gt;</span>

    <span class="nt">&lt;sensor</span> <span class="na">type=</span><span class="s">&quot;.. sensor type ..&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- .. sensor parameters .. --&gt;</span>

        <span class="nt">&lt;sampler</span> <span class="na">type=</span><span class="s">&quot;.. sampler type ..&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- .. sampler parameters .. --&gt;</span>
        <span class="nt">&lt;/samplers&gt;</span>

        <span class="nt">&lt;film</span> <span class="na">type=</span><span class="s">&quot;.. film type ..&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- .. film parameters .. --&gt;</span>
        <span class="nt">&lt;/film&gt;</span>
    <span class="nt">&lt;/sensor&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>换句话说，<code class="docutils literal notranslate"><span class="pre">sensor</span></code> 是  <code class="docutils literal notranslate"><span class="pre">&lt;scene&gt;</span></code> 的子类（对于场景文件中的特定位置不起作用）。嵌套在 sensor 声明中的
是一个 sampler 实例（详见 <a class="reference internal" href="#sec-samplers"><span class="std std-ref">Samplers</span></a>）和一个 film 实例（详见 <a class="reference internal" href="#sec-films"><span class="std std-ref">Films</span></a>）。</p>
<p>在 Mitsuba 2 中 sensor 遵循的是 <em>右手系</em> 。对他们进行任意旋转或平移操作都无法动摇这一属性。默认情况下，
它们位于坐标系原点并朝着渲染图规定的方向，其中 <span class="math notranslate nohighlight">\(+X\)</span> 指向左方，<span class="math notranslate nohighlight">\(+Y\)</span> 指向上方，<span class="math notranslate nohighlight">\(+Z\)</span> 则沿着观察方向。
当然左手系也是支持的。改变坐标系性质，只需要反转任意轴即可，例如，通过对 sensor 的 <span class="monosp">to_world</span> 参数执行一个缩放变换 <code class="docutils literal notranslate"><span class="pre">&lt;scale</span> <span class="pre">x=&quot;-1&quot;/&gt;</span></code> 。</p>
<div class="section" id="perspective-pinhole-camera-perspective">
<span id="sensor-perspective"></span><h2>Perspective pinhole camera (<span class="monosp">perspective</span>)<a class="headerlink" href="#perspective-pinhole-camera-perspective" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional camera-to-world transformation.
(Default: none (i.e. camera space = world space))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fov</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Denotes the camera’s field of view in degrees—must be between 0 and 180,
excluding the extremes. Alternatively, it is also possible to specify a
field of view using the <span class="monosp">focal_length</span> parameter.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">focal_length</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Denotes the camera’s focal length specified using <em>35mm</em> film
equivalent units. Alternatively, it is also possible to specify a field of
view using the <span class="monosp">fov</span> parameter. See the main description for further
details. (Default: <span class="monosp">50mm</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fov_axis</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>When the parameter <span class="monosp">fov</span> is given (and only then), this parameter further specifies
the image axis, to which it applies.</p>
<ol class="arabic simple">
<li><p><span class="monosp">x</span>: <span class="monosp">fov</span> maps to the <span class="monosp">x</span>-axis in screen space.</p></li>
<li><p><span class="monosp">y</span>: <span class="monosp">fov</span> maps to the <span class="monosp">y</span>-axis in screen space.</p></li>
<li><p><span class="monosp">diagonal</span>: <span class="monosp">fov</span> maps to the screen diagonal.</p></li>
<li><p><span class="monosp">smaller</span>: <span class="monosp">fov</span> maps to the smaller dimension
(e.g. <span class="monosp">x</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
<li><p><span class="monosp">larger</span>: <span class="monosp">fov</span> maps to the larger dimension
(e.g. <span class="monosp">y</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
</ol>
<p>The default is <span class="monosp">x</span>.</p>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">near_clip, far_clip</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Distance to the near/far clip planes. (Default: <span class="monosp">near_clip=1e-2</span> (i.e. <span class="monosp">0.01</span>)
and <span class="monosp">far_clip=1e4</span> (i.e. <span class="monosp">10000</span>))</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-perspective">
<div style="width: 49%" class="subfigure align-center" id="id84">
<a class="reference internal image-reference" href="../_images/sensor_perspective.jpg"><img alt="../_images/sensor_perspective.jpg" src="../_images/sensor_perspective.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The material test ball viewed through a perspective pinhole camera. (<span class="monosp">fov=28</span>)</span><a class="headerlink" href="#id84" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id85">
<a class="reference internal image-reference" href="../_images/sensor_perspective_large_fov.jpg"><img alt="../_images/sensor_perspective_large_fov.jpg" src="../_images/sensor_perspective_large_fov.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The material test ball viewed through a perspective pinhole camera. (<span class="monosp">fov=40</span>)</span><a class="headerlink" href="#id85" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-perspective">This plugin implements a simple idealizied perspective camera model, which
has an infinitely small aperture. This creates an infinite depth of field,
i.e. no optical blurring occurs.</p>
<p>By default, the camera’s field of view is specified using a 35mm film
equivalent focal length, which is first converted into a diagonal field
of view and subsequently applied to the camera. This assumes that
the film’s aspect ratio matches that of 35mm film (1.5:1), though the
parameter still behaves intuitively when this is not the case.
Alternatively, it is also possible to specify a field of view in degrees
along a given axis (see the <span class="monosp">fov</span> and <span class="monosp">fov_axis</span> parameters).</p>
<p>The exact camera position and orientation is most easily expressed using the
<span class="monosp">lookat</span> tag, i.e.:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sensor</span> <span class="na">type=</span><span class="s">&quot;perspective&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Move and rotate the camera so that looks from (1, 1, 1) to (1, 2, 1)</span>
<span class="c">            and the direction (0, 0, 1) points &quot;up&quot; in the output image --&gt;</span>
        <span class="nt">&lt;lookat</span> <span class="na">origin=</span><span class="s">&quot;1, 1, 1&quot;</span> <span class="na">target=</span><span class="s">&quot;1, 2, 1&quot;</span> <span class="na">up=</span><span class="s">&quot;0, 0, 1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transform&gt;</span>
<span class="nt">&lt;/sensor&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="perspective-camera-with-a-thin-lens-thinlens">
<span id="sensor-thinlens"></span><h2>Perspective camera with a thin lens (<span class="monosp">thinlens</span>)<a class="headerlink" href="#perspective-camera-with-a-thin-lens-thinlens" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional camera-to-world transformation.
(Default: none (i.e. camera space = world space))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">aperture_radius</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Denotes the radius of the camera’s aperture in scene units.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">focus_distance</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Denotes the world-space distance from the camera’s aperture to the focal plane.
(Default: <span class="monosp">0</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">focal_length</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Denotes the camera’s focal length specified using <em>35mm</em> film equivalent units.
See the main description for further details. (Default: <span class="monosp">50mm</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">fov</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>An alternative to <span class="monosp">focal_length</span>: denotes the camera’s field of view in degrees—must be
between 0 and 180, excluding the extremes.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">fov_axis</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>When the parameter <span class="monosp">fov</span> is given (and only then), this parameter further specifies
the image axis, to which it applies.</p>
<ol class="arabic simple">
<li><p><span class="monosp">x</span>: <span class="monosp">fov</span> maps to the <span class="monosp">x</span>-axis in screen space.</p></li>
<li><p><span class="monosp">y</span>: <span class="monosp">fov</span> maps to the <span class="monosp">y</span>-axis in screen space.</p></li>
<li><p><span class="monosp">diagonal</span>: <span class="monosp">fov</span> maps to the screen diagonal.</p></li>
<li><p><span class="monosp">smaller</span>: <span class="monosp">fov</span> maps to the smaller dimension
(e.g. <span class="monosp">x</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
<li><p><span class="monosp">larger</span>: <span class="monosp">fov</span> maps to the larger dimension
(e.g. <span class="monosp">y</span> when <span class="monosp">width</span> &lt; <span class="monosp">height</span>)</p></li>
</ol>
<p>The default is <span class="monosp">x</span>.</p>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">near_clip, far_clip</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Distance to the near/far clip planes. (Default: <span class="monosp">near_clip=1e-2</span> (i.e. <span class="monosp">0.01</span>)
and <span class="monosp">far_clip=1e4</span> (i.e. <span class="monosp">10000</span>))</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-thinlens">
<div style="width: 49%" class="subfigure align-center" id="id86">
<a class="reference internal image-reference" href="../_images/sensor_thinlens_small_aperture.jpg"><img alt="../_images/sensor_thinlens_small_aperture.jpg" src="../_images/sensor_thinlens_small_aperture.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The material test ball viewed through a perspective thin lens camera. (<span class="monosp">aperture_radius=0.1</span>)</span><a class="headerlink" href="#id86" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id87">
<a class="reference internal image-reference" href="../_images/sensor_thinlens.jpg"><img alt="../_images/sensor_thinlens.jpg" src="../_images/sensor_thinlens.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">The material test ball viewed through a perspective thin lens camera. (<span class="monosp">aperture_radius=0.2</span>)</span><a class="headerlink" href="#id87" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-thinlens">This plugin implements a simple perspective camera model with a thin lens
at its circular aperture. It is very similar to the
<a class="reference internal" href="#sensor-perspective"><span class="std std-ref">perspective</span></a> plugin except that the extra lens element
permits rendering with a specifiable (i.e. non-infinite) depth of field.
To configure this, it has two extra parameters named <span class="monosp">aperture_radius</span>
and <span class="monosp">focus_distance</span>.</p>
<p>By default, the camera’s field of view is specified using a 35mm film
equivalent focal length, which is first converted into a diagonal field
of view and subsequently applied to the camera. This assumes that
the film’s aspect ratio matches that of 35mm film (1.5:1), though the
parameter still behaves intuitively when this is not the case.
Alternatively, it is also possible to specify a field of view in degrees
along a given axis (see the <span class="monosp">fov</span> and <span class="monosp">fov_axis</span> parameters).</p>
<p>The exact camera position and orientation is most easily expressed using the
<span class="monosp">lookat</span> tag, i.e.:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sensor</span> <span class="na">type=</span><span class="s">&quot;thinlens&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_world&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Move and rotate the camera so that looks from (1, 1, 1) to (1, 2, 1)</span>
<span class="c">            and the direction (0, 0, 1) points &quot;up&quot; in the output image --&gt;</span>
        <span class="nt">&lt;lookat</span> <span class="na">origin=</span><span class="s">&quot;1, 1, 1&quot;</span> <span class="na">target=</span><span class="s">&quot;1, 2, 1&quot;</span> <span class="na">up=</span><span class="s">&quot;0, 0, 1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transform&gt;</span>

    <span class="c">&lt;!-- Focus on the target --&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;focus_distance&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;aperture_radius&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/sensor&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="radiance-meter-radiancemeter">
<span id="sensor-radiancemeter"></span><h2>Radiance meter (<span class="monosp">radiancemeter</span>)<a class="headerlink" href="#radiance-meter-radiancemeter" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">to_world</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional camera-to-world transformation.
(Default: none (i.e. camera space = world space))</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">origin</span></p></td>
<td><p><span class="paramtype">point</span></p></td>
<td><p>Location from which the sensor will be recording in world coordinates.
Must be used with <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">origin</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">direction</span></p></td>
<td><p><span class="paramtype">vector</span></p></td>
<td><p>Alternative (and exclusive) to <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">to_world</span></code>. Direction in which the
sensor is pointing in world coordinates. Must be used with <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">origin</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>This sensor plugin implements a simple radiance meter, which measures
the incident power per unit area per unit solid angle along a
certain ray. It can be thought of as the limit of a standard
perspective camera as its field of view tends to zero.
This sensor is used with films of 1 by 1 pixels.</p>
<p>Such a sensor is useful for conducting virtual experiments and
testing the renderer for correctness.</p>
<p>By default, the sensor is located at the origin and performs
a measurement in the positive Z direction <span class="monosp">(0,0,1)</span>. This can
be changed by providing a custom <span class="monosp">to_world</span> transformation, or a pair
of <span class="monosp">origin</span> and <span class="monosp">direction</span> values. If both types of
transformation are specified, the <span class="monosp">to_world</span> transformation has higher
priority.</p>
</div>
<div class="section" id="irradiance-meter-irradiancemeter">
<span id="sensor-irradiancemeter"></span><h2>Irradiance meter (<span class="monosp">irradiancemeter</span>)<a class="headerlink" href="#irradiance-meter-irradiancemeter" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">none</span></p></td>
</tr>
</tbody>
</table>
<p>This sensor plugin implements an irradiance meter, which measures
the incident power per unit area over a shape which it is attached to.
This sensor is used with films of 1 by 1 pixels.</p>
<p>If the irradiance meter is attached to a mesh-type shape, it will measure the
irradiance over all triangles in the mesh.</p>
<p>This sensor is not instantiated on its own but must be defined as a child
object to a shape in a scene. To create an irradiance meter,
simply instantiate the desired sensor shape and specify an
<span class="monosp">irradiancemeter</span> instance as its child:</p>
<div class="highlight-xml notranslate" id="sphere-meter"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sensor</span> <span class="na">type=</span><span class="s">&quot;irradiancemeter&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- film --&gt;</span>
    <span class="nt">&lt;/sensor&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sec-textures">
<span id="id18"></span><h1>纹理<a class="headerlink" href="#sec-textures" title="Permalink to this headline">¶</a></h1>
<p>接下来的小节描述的是纹理数据资源。在 Mitsuba 2 中纹理作为对象存在，纹理对象可以作为附加到某些表面散射模型的参数，以
引入空间变化。在本文档中，以下列出了支持的 <span class="paramtype">texture</span> 类型。有关 BSDF 的更多示例，请参阅最后几节。</p>
<p>Texture 有一个可选参数 <code class="docutils literal notranslate"><span class="pre">&lt;transform&gt;</span></code> 叫做 <span class="paramtype">to_uv</span> ，该参数可以用作平移、缩放、旋转以查找纹理。</p>
<p>一个 XML 的例子如下所示：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Create a BSDF that supports textured parameters --&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span> <span class="na">id=</span><span class="s">&quot;my_textured_material&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;texture</span> <span class="na">type=</span><span class="s">&quot;.. texture type ..&quot;</span> <span class="na">name=</span><span class="s">&quot;.. parameter name ..&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- .. Texture parameters go here .. --&gt;</span>

            <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_uv&quot;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!-- Scale texture by factor of 2 --&gt;</span>
                <span class="nt">&lt;scale</span> <span class="na">x=</span><span class="s">&quot;2&quot;</span> <span class="na">y=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
                <span class="c">&lt;!-- Offset texture by [0.5, 1.0] --&gt;</span>
                <span class="nt">&lt;translate</span> <span class="na">x=</span><span class="s">&quot;0.5&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/transform&gt;</span>
        <span class="nt">&lt;/texture&gt;</span>

        <span class="c">&lt;!-- .. Non-spatially varying BSDF parameters ..--&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>与 BSDF 类似，命名了的纹理可以在场景的顶层定义并在之后进行引用。如果相同的纹理需要多次加载，这将会特别有用。</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Create a named texture at the top level --&gt;</span>
    <span class="nt">&lt;texture</span> <span class="na">type=</span><span class="s">&quot;.. texture type ..&quot;</span> <span class="na">id=</span><span class="s">&quot;my_named_texture&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- .. Texture parameters go here .. --&gt;</span>

        <span class="nt">&lt;transform</span> <span class="na">name=</span><span class="s">&quot;to_uv&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- .. Transform parameters .. --&gt;</span>
        <span class="nt">&lt;/transform&gt;</span>
    <span class="nt">&lt;/texture&gt;</span>

    <span class="c">&lt;!-- Create a BSDF that supports textured parameters --&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Example of referencing a named texture --&gt;</span>
        <span class="nt">&lt;ref</span> <span class="na">id=</span><span class="s">&quot;my_named_texture&quot;</span> <span class="na">name=</span><span class="s">&quot;.. parameter name ..&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- .. Non-spatially varying BSDF parameters ..--&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<div class="section" id="bitmap-texture-bitmap">
<span id="texture-bitmap"></span><h2>Bitmap texture (<span class="monosp">bitmap</span>)<a class="headerlink" href="#bitmap-texture-bitmap" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">filename</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Filename of the bitmap to be loaded</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">filter_type</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies how pixel values are interpolated and filtered when queried over larger
UV regions. The following options are currently available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bilinear</span></code> (default): perform bilinear interpolation, but no filtering.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nearest</span></code>: disable filtering and interpolation. In this mode, the plugin
performs nearest neighbor lookups of texture values.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">wrap_mode</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Controls the behavior of texture evaluations that fall outside of the
<span class="math notranslate nohighlight">\([0, 1]\)</span> range. The following options are currently available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repeat</span></code> (default): tile the texture infinitely.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mirror</span></code>: mirror the texture along its boundaries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clamp</span></code>: clamp coordinates to the edge of the texture.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">raw</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Should the transformation to the stored color data (e.g. sRGB to linear,
spectral upsampling) be disabled? You will want to enable this when working
with bitmaps storing normal maps that use a linear encoding. (Default: false)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">to_uv</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional 3x3 transformation matrix that will be applied to UV
values. A 4x4 matrix can also be provided, in which case the extra row and
column are ignored.</p></td>
</tr>
</tbody>
</table>
<p>This plugin provides a bitmap texture that performs interpolated lookups given
a JPEG, PNG, OpenEXR, RGBE, TGA, or BMP input file.</p>
<p>When loading the plugin, the data is first converted into a usable color representation
for the renderer:</p>
<ul class="simple">
<li><p>In <span class="monosp">rgb</span> modes, sRGB textures are converted into a linear color space.</p></li>
<li><p>In <span class="monosp">spectral</span> modes, sRGB textures are <em>spectrally upsampled</em> to plausible
smooth spectra <a class="bibtex reference internal" href="../zz_bibliography.html#jakob2019spectral" id="id19">[JH19]</a> and stored an intermediate representation
that enables efficient queries at render time.</p></li>
<li><p>In <span class="monosp">monochrome</span> modes, sRGB textures are converted to grayscale.</p></li>
</ul>
<p>These conversions can alternatively be disabled with the <span class="paramtype">raw</span> flag,
e.g. when textured data is already in linear space or does not represent colors
at all.</p>
</div>
<div class="section" id="checkerboard-texture-checkerboard">
<span id="texture-checkerboard"></span><h2>Checkerboard texture (<span class="monosp">checkerboard</span>)<a class="headerlink" href="#checkerboard-texture-checkerboard" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">color0, color1</span></p></td>
<td><p><span class="paramtype">spectrum</span> or <span class="paramtype">texture</span></p></td>
<td><p>Color values for the two differently-colored patches (Default: 0.4 and 0.2)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">to_uv</span></p></td>
<td><p><span class="paramtype">transform</span></p></td>
<td><p>Specifies an optional 3x3 UV transformation matrix. A 4x4 matrix can also be provided.
In that case, the last row and columns will be ignored.  (Default: none)</p></td>
</tr>
</tbody>
</table>
<p>This plugin provides a simple procedural checkerboard texture with customizable colors.</p>
<div class="figure compound align-center" id="fig-texture-checkerboard">
<div style="width: 49%" class="subfigure align-center" id="id88">
<a class="reference internal image-reference" href="../_images/texture_checkerboard.jpg"><img alt="../_images/texture_checkerboard.jpg" src="../_images/texture_checkerboard.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Checkerboard applied to the material test object as well as the ground plane.</span><a class="headerlink" href="#id88" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="mesh-attribute-texture-mesh-attribute">
<span id="texture-meshattribute"></span><span id="fig-texture-checkerboard"></span><h2>Mesh attribute texture (<span class="monosp">mesh_attribute</span>)<a class="headerlink" href="#mesh-attribute-texture-mesh-attribute" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">name</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Name of the attribute to evaluate. It should always start with <code class="docutils literal notranslate"><span class="pre">&quot;vertex_&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;face_&quot;</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">scale</span></p></td>
<td><p><span class="paramtype">float</span></p></td>
<td><p>Scaling factor applied to the interpolated attribute value during evalutation.
(Default: 1.0)</p></td>
</tr>
</tbody>
</table>
<p>This plugin provides a simple mechanism to expose Mesh attributes (e.g. vertex color)
as a texture.</p>
<div class="figure compound align-center" id="fig-texture-mesh-attribute">
<div style="width: 49%" class="subfigure align-center" id="id89">
<a class="reference internal image-reference" href="../_images/texture_mesh_attribute_vertex.jpg"><img alt="../_images/texture_mesh_attribute_vertex.jpg" src="../_images/texture_mesh_attribute_vertex.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Bunny with random vertex color (using barycentric interpolation).</span><a class="headerlink" href="#id89" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id90">
<a class="reference internal image-reference" href="../_images/texture_mesh_attribute_face.jpg"><img alt="../_images/texture_mesh_attribute_face.jpg" src="../_images/texture_mesh_attribute_face.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Bunny with random face color.</span><a class="headerlink" href="#id90" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-texture-mesh-attribute">The following XML snippet describes a mesh with diffuse material,
whose reflectance is specified using the <code class="docutils literal notranslate"><span class="pre">vertex_color</span></code> attribute of that mesh:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;ply&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;filename&quot;</span> <span class="na">value=</span><span class="s">&quot;my_mesh_with_vertex_color_attr.ply&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;texture</span> <span class="na">type=</span><span class="s">&quot;mesh_attribute&quot;</span> <span class="na">name=</span><span class="s">&quot;reflectance&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="na">value=</span><span class="s">&quot;vertex_color&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/texture&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For spectral variants of the renderer (e.g. <code class="docutils literal notranslate"><span class="pre">scalar_spectral</span></code>), when a mesh attribute name
contains the string <code class="docutils literal notranslate"><span class="pre">&quot;color&quot;</span></code>, the tri-stimulus RGB values will be converted to <code class="docutils literal notranslate"><span class="pre">rgb2spec</span></code>
model coefficients automatically.</p>
</div>
</div>
</div>
<div class="section" id="sec-spectra">
<span id="id20"></span><h1>光谱<a class="headerlink" href="#sec-spectra" title="Permalink to this headline">¶</a></h1>
<p>本节介绍的是 Mitsuba 2 在光谱反射或发光背后的插件。在实现的层面上，它们的行为与之前 <a class="reference internal" href="#sec-textures"><span class="std std-ref">texture plugins</span></a>
中的描述非常相似（但是要缺少空间变化属性），因此，可以类似地作为 BSDF 或 emitter 的参数使用：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;.. BSDF type ..&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Explicitly add a uniform spectrum plugin --&gt;</span>
        <span class="nt">&lt;spectrum</span> <span class="na">type=</span><span class="s">&quot;.. spectrum type ..&quot;</span> <span class="na">name=</span><span class="s">&quot;.. parameter name ..&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- Spectrum parameters go here --&gt;</span>
        <span class="nt">&lt;/spectrum&gt;</span>
    <span class="nt">&lt;/bsdf&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>但是在实际工作中，不鼓励以这种显式方式实例化插件，XML 场景描述解析器会直接解析许多常用的插件（较短的）
如 <code class="docutils literal notranslate"><span class="pre">&lt;spectrum&gt;</span></code> 和 <code class="docutils literal notranslate"><span class="pre">&lt;rgb&gt;</span></code> 标签。请参阅 <a class="reference internal" href="../src/getting_started/file_format.html#sec-file-format"><span class="std std-ref">scene file format</span></a> 相关章节
以获得更多信息。</p>
<p>接下来的两个表格总结了底层插件在每种情况下的实例化，考虑到了反射和发射属性以及不同颜色模式之间的差异。
下面对于了每个插件都有简要的介绍。</p>
<div class="figure align-center" id="spectrum-reflectance-table-list">
<center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>XML description</p></th>
<th class="head"><p>Monochrome mode</p></th>
<th class="head"><p>RGB mode</p></th>
<th class="head"><p>Spectral mode</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;0.5&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;400:0.1,</span> <span class="pre">700:0.2&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-regular"><span class="std std-ref">regular</span></a>/<a class="reference internal" href="#spectrum-irregular"><span class="std std-ref">irregular</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">filename=&quot;..&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-regular"><span class="std std-ref">regular</span></a>/<a class="reference internal" href="#spectrum-irregular"><span class="std std-ref">irregular</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;rgb</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;0.5,</span> <span class="pre">0.2,</span> <span class="pre">0.5&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a></p></td>
</tr>
</tbody>
</table>
<p class="caption"><span class="caption-text">Spectra used for reflectance (within BSDFs)</span></p>
</center></div><div class="figure align-center" id="spectrum-emission-table-list">
<span id="spectrum-reflectance-table-list"></span><center><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>XML description</p></th>
<th class="head"><p>Monochrome mode</p></th>
<th class="head"><p>RGB mode</p></th>
<th class="head"><p>Spectral mode</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;0.5&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-d65"><span class="std std-ref">d65</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;400:0.1,</span> <span class="pre">700:0.2&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb-d65"><span class="std std-ref">srgb_d65</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-regular"><span class="std std-ref">regular</span></a>/<a class="reference internal" href="#spectrum-irregular"><span class="std std-ref">irregular</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;spectrum</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">filename=&quot;..&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-uniform"><span class="std std-ref">uniform</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb-d65"><span class="std std-ref">srgb_d65</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-regular"><span class="std std-ref">regular</span></a>/<a class="reference internal" href="#spectrum-irregular"><span class="std std-ref">irregular</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;rgb</span> <span class="pre">name=&quot;..&quot;</span> <span class="pre">value=&quot;0.5,</span> <span class="pre">0.2,</span> <span class="pre">0.5&quot;/&gt;</span></code></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb-d65"><span class="std std-ref">srgb_d65</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb-d65"><span class="std std-ref">srgb_d65</span></a></p></td>
<td><p><a class="reference internal" href="#spectrum-srgb-d65"><span class="std std-ref">srgb_d65</span></a></p></td>
</tr>
</tbody>
</table>
<p class="caption"><span class="caption-text">Spectra used for emission (within emitters)</span></p>
</center></div><div class="section" id="uniform-spectrum-uniform">
<span id="spectrum-uniform"></span><span id="spectrum-emission-table-list"></span><h2>Uniform spectrum (<span class="monosp">uniform</span>)<a class="headerlink" href="#uniform-spectrum-uniform" title="Permalink to this headline">¶</a></h2>
<p>This spectrum returns a constant reflectance or emission value between 360 and 830nm.</p>
</div>
<div class="section" id="regular-spectrum-regular">
<span id="spectrum-regular"></span><h2>Regular spectrum (<span class="monosp">regular</span>)<a class="headerlink" href="#regular-spectrum-regular" title="Permalink to this headline">¶</a></h2>
<p>This spectrum returns linearly interpolated reflectance or emission values from <em>regularly</em>
placed samples.</p>
</div>
<div class="section" id="irregular-spectrum-irregular">
<span id="spectrum-irregular"></span><h2>Irregular spectrum (<span class="monosp">irregular</span>)<a class="headerlink" href="#irregular-spectrum-irregular" title="Permalink to this headline">¶</a></h2>
<p>This spectrum returns linearly interpolated reflectance or emission values from <em>irregularly</em>
placed samples.</p>
</div>
<div class="section" id="srgb-spectrum-srgb">
<span id="spectrum-srgb"></span><h2>sRGB spectrum (<span class="monosp">srgb</span>)<a class="headerlink" href="#srgb-spectrum-srgb" title="Permalink to this headline">¶</a></h2>
<p>In spectral render modes, this smooth spectrum is the result of the
<em>spectral upsampling</em> process <a class="bibtex reference internal" href="../zz_bibliography.html#jakob2019spectral" id="id21">[JH19]</a> used by the system.
In RGB render modes, this spectrum represents a constant RGB value.
In monochrome modes, this spectrum represents a constant luminance value.</p>
</div>
<div class="section" id="d65-spectrum-d65">
<span id="spectrum-d65"></span><h2>D65 spectrum (<span class="monosp">d65</span>)<a class="headerlink" href="#d65-spectrum-d65" title="Permalink to this headline">¶</a></h2>
<p>The CIE Standard Illuminant D65 corresponds roughly to the average midday light in Europe,
also called a daylight illuminant. It is the default emission spectrum used for light sources
in all spectral rendering modes.</p>
</div>
<div class="section" id="srgb-d65-spectrum-srgb-d65">
<span id="spectrum-srgb-d65"></span><h2>sRGB D65 spectrum (<span class="monosp">srgb_d65</span>)<a class="headerlink" href="#srgb-d65-spectrum-srgb-d65" title="Permalink to this headline">¶</a></h2>
<p>This is a convenience wrapper around both the <a class="reference internal" href="#spectrum-srgb"><span class="std std-ref">srgb</span></a> and
<a class="reference internal" href="#spectrum-d65"><span class="std std-ref">d65</span></a> plugins and returns their product.
This is the current default behavior in spectral rendering modes for light sources
specified from an RGB color value.</p>
</div>
<div class="section" id="srgb-d65-spectrum-blackbody">
<span id="spectrum-blackbody"></span><h2>sRGB D65 spectrum (<span class="monosp">blackbody</span>)<a class="headerlink" href="#srgb-d65-spectrum-blackbody" title="Permalink to this headline">¶</a></h2>
<p>This is a black body radiation spectrum for a specified temperature
And therefore takes a single <span class="monosp">float</span>-valued parameter <span class="paramtype">temperature</span> (in Kelvins).</p>
<p>This is the only spectrum type that needs to be explicitly instantiated in its full XML description:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;.. shape type ..&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;emitter</span> <span class="na">type=</span><span class="s">&quot;area&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;spectrum</span> <span class="na">type=</span><span class="s">&quot;blackbody&quot;</span> <span class="na">name=</span><span class="s">&quot;radiance&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;float</span> <span class="na">name=</span><span class="s">&quot;temperature&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/spectrum&gt;</span>
    <span class="nt">&lt;/emitter&gt;</span>
<span class="nt">&lt;/shape&gt;</span>
</pre></div>
</div>
<p>This spectrum type only makes sense for specifying emission and is unavailable
in non-spectral rendering modes.</p>
<p>Note that attaching a black body spectrum to the intensity property of a emitter introduces
physical units into the rendering process of Mitsuba 2, which is ordinarily a unitless system.
Specifically, the black body spectrum has units of power (<span class="math notranslate nohighlight">\(W\)</span>) per unit area (<span class="math notranslate nohighlight">\(m^{-2}\)</span>)
per steradian (<span class="math notranslate nohighlight">\(sr^{-1}\)</span>) per unit wavelength (<span class="math notranslate nohighlight">\(nm^{-1}\)</span>). As a consequence,
your scene should be modeled in meters for this plugin to work properly.</p>
</div>
</div>
<div class="section" id="sec-integrators">
<span id="id22"></span><h1>积分器<a class="headerlink" href="#sec-integrators" title="Permalink to this headline">¶</a></h1>
<p>在 Mitsuba 2中，与众不同的渲染技术都和 <em>integrator</em> 的使用相关，积分器是在高维度计算积分的。
每个积分器表示的都是解决光线传播方程的一种特定方法，通常在某些情况下有利，但同时又受其自身固有的局限性的影响。
因此，根据指定精度的要求以及待渲染场景的特性认真选择合适的积分器求解非常重要。</p>
<p>在 XML 场景描述语言中，一个简单的积分器通常应在场景顶部声明来实例化，例如：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Instantiate a unidirectional path tracer,</span>
<span class="c">         which renders paths up to a depth of 5 --&gt;</span>
    <span class="nt">&lt;integrator</span> <span class="na">type=</span><span class="s">&quot;path&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;integer</span> <span class="na">name=</span><span class="s">&quot;max_depth&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/integrator&gt;</span>

    <span class="c">&lt;!-- Some geometry to be rendered --&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">type=</span><span class="s">&quot;sphere&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bsdf</span> <span class="na">type=</span><span class="s">&quot;diffuse&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/shape&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p>这一小节给出的是积分器参数可用选项的概览。</p>
<p>几乎所有的积分器都使用了 <em>path depth</em> 的概念。在这里，一条路径是指从光源开始到相机结束的一系列散射行为。
在预览渲染场景时限制路径深度是非常有用的，因为这减少了每个像素需要的计算量。除此之外，这类渲染通常收敛速度更快，
因此每个像素需要的样本会更少。如果随后想要参考渲染质量，此时应该允许路径深度无限制即可。</p>
<p>下面 Cornell box 的渲染图展示了最大路径深度的视觉效果。随着允许光路长度的增加，更多的散射和着色表面进行交互从而
颜色的饱和度也在增加，同时渲染用时也会相应增加。</p>
<div class="figure compound align-center" id="fig-integrators-depth">
<div style="width: 23%" class="subfigure align-center" id="id91">
<a class="reference internal image-reference" href="../_images/integrator_depth_1.jpg"><img alt="../_images/integrator_depth_1.jpg" src="../_images/integrator_depth_1.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">max. depth = 1</span><a class="headerlink" href="#id91" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 23%" class="subfigure align-center" id="id92">
<a class="reference internal image-reference" href="../_images/integrator_depth_2.jpg"><img alt="../_images/integrator_depth_2.jpg" src="../_images/integrator_depth_2.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">max. depth = 2</span><a class="headerlink" href="#id92" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 23%" class="subfigure align-center" id="id93">
<a class="reference internal image-reference" href="../_images/integrator_depth_3.jpg"><img alt="../_images/integrator_depth_3.jpg" src="../_images/integrator_depth_3.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">max. depth = 3</span><a class="headerlink" href="#id93" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 23%" class="subfigure align-center" id="id94">
<a class="reference internal image-reference" href="../_images/integrator_depth_inf.jpg"><img alt="../_images/integrator_depth_inf.jpg" src="../_images/integrator_depth_inf.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">max. depth = <span class="math notranslate nohighlight">\(\infty\)</span></span><a class="headerlink" href="#id94" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-integrators-depth">Mitsuba 从 1 开始计算路径深度，这与可见光源相对应（即，光线从光源开始到相机结束，其间没有与任何物体交互）。
深度为 2 的路径（即我们所熟知的 “直接照明”）包含了如下图一样一个简单的散射事件：</p>
<a class="reference internal image-reference" href="../_images/path_explanation.jpg"><img alt="../_images/path_explanation.jpg" class="align-center" src="../_images/path_explanation.jpg" style="width: 80%;" /></a>
<div class="section" id="direct-illumination-integrator-direct">
<span id="integrator-direct"></span><h2>Direct illumination integrator (<span class="monosp">direct</span>)<a class="headerlink" href="#direct-illumination-integrator-direct" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">shading_samples</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>This convenience parameter can be used to set both <code class="code docutils literal notranslate"><span class="pre">emitter_samples</span></code> and
<code class="code docutils literal notranslate"><span class="pre">bsdf_samples</span></code> at the same time.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">emitter_samples</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Optional more fine-grained parameter: specifies the number of samples that should be generated
using the direct illumination strategies implemented by the scene’s emitters.
(Default: set to the value of <span class="monosp">shading_samples</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">bsdf_samples</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Optional more fine-grained parameter: specifies the number of samples that should be generated
using the BSDF sampling strategies implemented by the scene’s surfaces.
(Default: set to the value of <span class="monosp">shading_samples</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">hide_emitters</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Hide directly visible emitters.
(Default: no, i.e. <span class="monosp">false</span>)</p></td>
</tr>
</tbody>
</table>
<div class="figure compound align-center" id="fig-direct">
<div style="width: 32%" class="subfigure align-center" id="fig-direct-bsdf">
<a class="reference internal image-reference" href="../_images/integrator_direct_bsdf.jpg"><img alt="../_images/integrator_direct_bsdf.jpg" src="../_images/integrator_direct_bsdf.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">(<strong>a</strong>) BSDF sampling only</span><a class="headerlink" href="#fig-direct-bsdf" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 32%" class="subfigure align-center" id="fig-direct-lum">
<a class="reference internal image-reference" href="../_images/integrator_direct_lum.jpg"><img alt="../_images/integrator_direct_lum.jpg" src="../_images/integrator_direct_lum.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">(<strong>b</strong>) Emitter sampling only</span><a class="headerlink" href="#fig-direct-lum" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 32%" class="subfigure align-center" id="fig-direct-both">
<a class="reference internal image-reference" href="../_images/integrator_direct_both.jpg"><img alt="../_images/integrator_direct_both.jpg" src="../_images/integrator_direct_both.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">(<strong>c</strong>) MIS between both sampling strategies</span><a class="headerlink" href="#fig-direct-both" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-direct">This integrator implements a direct illumination technique that makes use
of <em>multiple importance sampling</em>: for each pixel sample, the
integrator generates a user-specifiable number of BSDF and emitter
samples and combines them using the power heuristic. Usually, the BSDF
sampling technique works very well on glossy objects but does badly
everywhere else (<strong>a</strong>), while the opposite is true for the emitter sampling
technique (<strong>b</strong>). By combining these approaches, one can obtain a rendering
technique that works well in both cases (<strong>c</strong>).</p>
<p>The number of samples spent on either technique is configurable, hence
it is also possible to turn this plugin into an emitter sampling-only
or BSDF sampling-only integrator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This integrator does not handle participating media or indirect illumination.</p>
</div>
</div>
<div class="section" id="path-tracer-path">
<span id="integrator-path"></span><h2>Path tracer (<span class="monosp">path</span>)<a class="headerlink" href="#path-tracer-path" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">max_depth</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Specifies the longest path depth in the generated output image (where -1 corresponds to
<span class="math notranslate nohighlight">\(\infty\)</span>). A value of 1 will only render directly visible light sources. 2 will lead
to single-bounce (direct-only) illumination, and so on. (Default: -1)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">rr_depth</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Specifies the minimum path depth, after which the implementation will start to use the
<em>russian roulette</em> path termination criterion. (Default: 5)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">hide_emitters</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Hide directly visible emitters. (Default: no, i.e. <span class="monosp">false</span>)</p></td>
</tr>
</tbody>
</table>
<p>This integrator implements a basic path tracer and is a <strong>good default choice</strong>
when there is no strong reason to prefer another method.</p>
<p>To use the path tracer appropriately, it is instructive to know roughly how
it works: its main operation is to trace many light paths using <em>random walks</em>
starting from the sensor. A single random walk is shown below, which entails
casting a ray associated with a pixel in the output image and searching for
the first visible intersection. A new direction is then chosen at the intersection,
and the ray-casting step repeats over and over again (until one of several
stopping criteria applies).</p>
<a class="reference internal image-reference" href="../_images/integrator_path_figure.png"><img alt="../_images/integrator_path_figure.png" class="align-center" src="../_images/integrator_path_figure.png" style="width: 95%;" /></a>
<p>At every intersection, the path tracer tries to create a connection to
the light source in an attempt to find a <em>complete</em> path along which
light can flow from the emitter to the sensor. This of course only works
when there is no occluding object between the intersection and the emitter.</p>
<p>This directly translates into a category of scenes where
a path tracer can be expected to produce reasonable results: this is the case
when the emitters are easily “accessible” by the contents of the scene. For instance,
an interior scene that is lit by an area light will be considerably harder
to render when this area light is inside a glass enclosure (which
effectively counts as an occluder).</p>
<p>Like the <a class="reference internal" href="#integrator-direct"><span class="std std-ref">direct</span></a> plugin, the path tracer internally relies on multiple importance
sampling to combine BSDF and emitter samples. The main difference in comparison
to the former plugin is that it considers light paths of arbitrary length to compute
both direct and indirect illumination.</p>
<span class="target" id="sec-path-strictnormals"></span><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This integrator does not handle participating media</p>
</div>
</div>
<div class="section" id="arbitrary-output-variables-integrator-aov">
<span id="integrator-aov"></span><h2>Arbitrary Output Variables integrator (<span class="monosp">aov</span>)<a class="headerlink" href="#arbitrary-output-variables-integrator-aov" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">aovs</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>List of <span class="monosp">&lt;name&gt;:&lt;type&gt;</span> pairs denoting the enabled AOVs.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">integrator</span></p></td>
<td><p>Sub-integrators (can have more than one) which will be sampled along the AOV integrator. Their
respective output will be put into distinct images.</p></td>
</tr>
</tbody>
</table>
<p>This integrator returns one or more AOVs (Arbitraty Output Variables) describing the visible
surfaces.</p>
<div class="figure compound align-center" id="fig-diffuse">
<div style="width: 49%" class="subfigure align-center" id="id95">
<a class="reference internal image-reference" href="../_images/bsdf_diffuse_plain.jpg"><img alt="../_images/bsdf_diffuse_plain.jpg" src="../_images/bsdf_diffuse_plain.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Scene rendered with a path tracer</span><a class="headerlink" href="#id95" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id96">
<a class="reference internal image-reference" href="../_images/integrator_aov_depth.y.jpg"><img alt="../_images/integrator_aov_depth.y.jpg" src="../_images/integrator_aov_depth.y.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Depth AOV</span><a class="headerlink" href="#id96" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id97">
<a class="reference internal image-reference" href="../_images/integrator_aov_nn.jpg"><img alt="../_images/integrator_aov_nn.jpg" src="../_images/integrator_aov_nn.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Normal AOV</span><a class="headerlink" href="#id97" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id98">
<a class="reference internal image-reference" href="../_images/integrator_aov_position.jpg"><img alt="../_images/integrator_aov_position.jpg" src="../_images/integrator_aov_position.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Position AOV</span><a class="headerlink" href="#id98" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-diffuse">Here is an example on how to enable the <em>depth</em> and <em>shading normal</em> AOVs while still rendering the
image with a path tracer. The <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">RGBA</span></code> image produces by the path tracer will be stored in the
[<code class="code docutils literal notranslate"><span class="pre">my_image.R</span></code>, <code class="code docutils literal notranslate"><span class="pre">my_image.G</span></code>, <code class="code docutils literal notranslate"><span class="pre">my_image.B</span></code>, <code class="code docutils literal notranslate"><span class="pre">my_image.A</span></code>] channels of the EXR
output file.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;integrator</span> <span class="na">type=</span><span class="s">&quot;aov&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;aovs&quot;</span> <span class="na">value=</span><span class="s">&quot;dd.y:depth,nn:sh_normal&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;integrator</span> <span class="na">type=</span><span class="s">&quot;path&quot;</span> <span class="na">name=</span><span class="s">&quot;my_image&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/integrator&gt;</span>
</pre></div>
</div>
<p>Currently, the following AOVs types are available:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="monosp">depth</span>: Distance from the pinhole.</p></li>
<li><p><span class="monosp">position</span>: World space position value.</p></li>
<li><p><span class="monosp">uv</span>: UV coordinates.</p></li>
<li><p><span class="monosp">geo_normal</span>: Geometric normal.</p></li>
<li><p><span class="monosp">sh_normal</span>: Shading normal.</p></li>
<li><p><span class="monosp">dp_du</span>, <span class="monosp">dp_dv</span>: Position partials wrt. the UV parameterization.</p></li>
<li><p><span class="monosp">duv_dx</span>, <span class="monosp">duv_dy</span>: UV partials wrt. changes in screen-space.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="volumetric-path-tracer-with-null-scattering-volpath">
<span id="integrator-volpath"></span><h2>Volumetric path tracer with null scattering (<span class="monosp">volpath</span>)<a class="headerlink" href="#volumetric-path-tracer-with-null-scattering-volpath" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id23">
<p class="admonition-title">Todo</p>
<p>Not documented yet.</p>
</div>
</div>
<div class="section" id="moment-integrator-moment">
<span id="integrator-moment"></span><h2>Moment integrator (<span class="monosp">moment</span>)<a class="headerlink" href="#moment-integrator-moment" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">integrator</span></p></td>
<td><p>Sub-integrators (can have more than one) which will be sampled along the AOV integrator. Their
respective XYZ output will be put into distinct images.</p></td>
</tr>
</tbody>
</table>
<p>This integrator returns one AOVs recording the second moment of the samples of the nested
integrator.</p>
</div>
<div class="section" id="stokes-vector-integrator-stokes">
<span id="integrator-stokes"></span><h2>Stokes vector integrator (<span class="monosp">stokes</span>)<a class="headerlink" href="#stokes-vector-integrator-stokes" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">integrator</span></p></td>
<td><p>Sub-integrator (only one can be specified) which will be sampled along the Stokes
integrator. In polarized rendering modes, its output Stokes vector is written
into distinct images.</p></td>
</tr>
</tbody>
</table>
<p>This integrator returns a multi-channel image describing the complete measured
polarization state at the sensor, represented as a Stokes vector <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>.</p>
<p>Here we show an example monochrome output in a scene with two dielectric and one
conductive sphere that all affect the polarization state of the
(initially unpolarized) light.</p>
<p>The first entry corresponds to usual radiance, whereas the remaining three entries
describe the polarization of light shown as false color images (green: positive, red: negative).</p>
<div class="figure compound align-center" id="fig-stokes">
<div style="width: 49%" class="subfigure align-center" id="id99">
<a class="reference internal image-reference" href="../_images/integrator_stokes_cbox.jpg"><img alt="../_images/integrator_stokes_cbox.jpg" src="../_images/integrator_stokes_cbox.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">“<span class="math notranslate nohighlight">\(\mathbf{s}_0\)</span>”: radiance</span><a class="headerlink" href="#id99" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id100">
<a class="reference internal image-reference" href="../_images/integrator_stokes_cbox_s1.jpg"><img alt="../_images/integrator_stokes_cbox_s1.jpg" src="../_images/integrator_stokes_cbox_s1.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">“<span class="math notranslate nohighlight">\(\mathbf{s}_1\)</span>”: horizontal vs. vertical polarization</span><a class="headerlink" href="#id100" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id101">
<a class="reference internal image-reference" href="../_images/integrator_stokes_cbox_s2.jpg"><img alt="../_images/integrator_stokes_cbox_s2.jpg" src="../_images/integrator_stokes_cbox_s2.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">“<span class="math notranslate nohighlight">\(\mathbf{s}_2\)</span>”: positive vs. negative diagonal polarization</span><a class="headerlink" href="#id101" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id102">
<a class="reference internal image-reference" href="../_images/integrator_stokes_cbox_s3.jpg"><img alt="../_images/integrator_stokes_cbox_s3.jpg" src="../_images/integrator_stokes_cbox_s3.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">“<span class="math notranslate nohighlight">\(\mathbf{s}_3\)</span>”: right vs. left circular polarization</span><a class="headerlink" href="#id102" title="Permalink to this image">¶</a></p>
</div>
</div><p id="fig-stokes">In the following example, a normal path tracer is nested inside the Stokes vector
integrator:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;integrator</span> <span class="na">type=</span><span class="s">&quot;stokes&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;integrator</span> <span class="na">type=</span><span class="s">&quot;path&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- path tracer parameters --&gt;</span>
    <span class="nt">&lt;/integrator&gt;</span>
<span class="nt">&lt;/integrator&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sec-samplers">
<span id="id24"></span><h1>采样器<a class="headerlink" href="#sec-samplers" title="Permalink to this headline">¶</a></h1>
<p>在渲染图像时，Mitsuba 2 必须解决涉及构成场景的几何、材质、灯光和传感器的高维积分问题。由于这些积分的数学复杂性，
通常不可能用解析法来解决它们，而是通过在大量不同位置采样来对要积分的函数求值并整合起来估算要求的积分。
样本生成器是这个过程的基本组成部分：它们在无限维超立方体（假设的） <span class="math notranslate nohighlight">\([0, 1]^{\infty}\)</span> 中生成点，
这些生层点构成了样本的标准表示。</p>
<p>为了完成这一工作，渲染算法和积分器都会向样本生成器发出大量查询。通常，它们会请求这个 <em>无限维点</em> 的后面 1D 或 2D 分量，
并将它们映射到一个更便利的空间（例如，曲面上某个位置）。这允许它构建光路，最终估算通过场景的光强。</p>
<div class="section" id="independent-sampler-independent">
<span id="sampler-independent"></span><h2>Independent sampler (<span class="monosp">independent</span>)<a class="headerlink" href="#independent-sampler-independent" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">sample_count</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Number of samples per pixel (Default: 4)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">seed</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Seed offset (Default: 0)</p></td>
</tr>
</tbody>
</table>
<p>The independent sampler produces a stream of independent and uniformly
distributed pseudorandom numbers. Internally, it relies on the
<a class="reference external" href="https://www.pcg-random.org/">PCG32 random number generator</a>
by Melissa O’Neill.</p>
<p>This is the most basic sample generator; because no precautions are taken to avoid
sample clumping, images produced using this plugin will usually take longer to converge.
Looking at the figures below where samples are projected onto a 2D unit square, we see that there
are both regions that don’t receive many samples (i.e. we don’t know much about the behavior of
the function there), and regions where many samples are very close together (which likely have very
similar values), which will result in higher variance in the rendered image.</p>
<p>This sampler is initialized using a deterministic procedure, which means that subsequent runs
of Mitsuba should create the same image. In practice, when rendering with multiple threads
and/or machines, this is not true anymore, since the ordering of samples is influenced by the
operating system scheduler. Although these should be absolutely negligible, with relative errors
on the order of the machine epsilon (<span class="math notranslate nohighlight">\(6\cdot 10^{-8}\)</span>) in single precision.</p>
<div class="figure compound align-center" id="fig-independent-pattern">
<div style="width: 49%" class="subfigure align-center" id="id103">
<a class="reference internal image-reference" href="../_images/independent_1024_samples.svg"><img alt="../_images/independent_1024_samples.svg" src="../_images/independent_1024_samples.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1024 samples projected onto the first two dimensions.</span><a class="headerlink" href="#id103" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id104">
<a class="reference internal image-reference" href="../_images/independent_64_samples_and_proj.svg"><img alt="../_images/independent_64_samples_and_proj.svg" src="../_images/independent_64_samples_and_proj.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">64 samples projected onto the first two dimensions and their
projection on both 1D axis (top and right plot).</span><a class="headerlink" href="#id104" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="stratified-sampler-stratified">
<span id="sampler-stratified"></span><span id="fig-independent-pattern"></span><h2>Stratified sampler (<span class="monosp">stratified</span>)<a class="headerlink" href="#stratified-sampler-stratified" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">sample_count</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Number of samples per pixel. This number should be a square number (Default: 4)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">seed</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Seed offset (Default: 0)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">jitter</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Adds additional random jitter withing the stratum (Default: True)</p></td>
</tr>
</tbody>
</table>
<p>The stratified sample generator divides the domain into a discrete number of strata and produces
a sample within each one of them. This generally leads to less sample clumping when compared to
the independent sampler, as well as better convergence.</p>
<div class="figure compound align-center" id="fig-stratified-renders">
<div style="width: 49%" class="subfigure align-center" id="id105">
<a class="reference internal image-reference" href="../_images/sampler_independent_16spp.jpg"><img alt="../_images/sampler_independent_16spp.jpg" src="../_images/sampler_independent_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Independent sampler - 16 samples per pixel</span><a class="headerlink" href="#id105" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id106">
<a class="reference internal image-reference" href="../_images/sampler_stratified_16spp.jpg"><img alt="../_images/sampler_stratified_16spp.jpg" src="../_images/sampler_stratified_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Stratified sampler - 16 samples per pixel</span><a class="headerlink" href="#id106" title="Permalink to this image">¶</a></p>
</div>
</div><div class="figure compound align-center" id="fig-stratified-pattern">
<div style="width: 49%" class="subfigure align-center" id="id107">
<a class="reference internal image-reference" href="../_images/stratified_1024_samples.svg"><img alt="../_images/stratified_1024_samples.svg" src="../_images/stratified_1024_samples.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1024 samples projected onto the first two dimensions which are well distributed
if we compare to the <span class="monosp">independent</span> sampler.</span><a class="headerlink" href="#id107" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id108">
<a class="reference internal image-reference" href="../_images/stratified_64_samples_and_proj.svg"><img alt="../_images/stratified_64_samples_and_proj.svg" src="../_images/stratified_64_samples_and_proj.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">64 samples projected in 2D and on both 1D axis (top and right plot). Every strata
contains a single sample creating a good distribution when projected in 2D. Projections
on both 1D axis still exhibit sample clumping which will result in higher variance, for
instance when sampling a thin streched rectangular area light.</span><a class="headerlink" href="#id108" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="correlated-multi-jittered-sampler-multijitter">
<span id="sampler-multijitter"></span><span id="fig-stratified-pattern"></span><h2>Correlated Multi-Jittered sampler (<span class="monosp">multijitter</span>)<a class="headerlink" href="#correlated-multi-jittered-sampler-multijitter" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">sample_count</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Number of samples per pixel. The sampler may internally choose to slightly increase this
value to create a subdivision into strata that has an aspect ratio close to one. (Default: 4)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">seed</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Seed offset (Default: 0)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">jitter</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Adds additional random jitter withing the substratum (Default: True)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements the methods introduced in Pixar’s tech memo <a class="bibtex reference internal" href="../zz_bibliography.html#kensler1967correlated" id="id25">[Ken67]</a>.</p>
<p>Unlike the previously described stratified sampler, multi-jittered sample patterns produce samples
that are well stratified in 2D but also well stratified when projected onto one dimension. This can
greatly reduce the variance of a Monte-Carlo estimator when the function to evaluate exhibits more
variation along one axis of the sampling domain than the other.</p>
<p>This sampler achieves this by first placing samples in a canonical arrangement that is stratified in
both 2D and 1D. It then shuffles the x-coordinate of the samples in every columns and the
y-coordinate in every rows. Fortunately, this process doesn’t break the 2D and 1D stratification.
Kensler’s method futher reduces sample clumpiness by correlating the shuffling applied to the
columns and the rows.</p>
<div class="figure compound align-center" id="fig-multijitter-renders">
<div style="width: 49%" class="subfigure align-center" id="id109">
<a class="reference internal image-reference" href="../_images/sampler_independent_16spp.jpg"><img alt="../_images/sampler_independent_16spp.jpg" src="../_images/sampler_independent_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Independent sampler - 16 samples per pixel</span><a class="headerlink" href="#id109" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id110">
<a class="reference internal image-reference" href="../_images/sampler_multijitter_16spp.jpg"><img alt="../_images/sampler_multijitter_16spp.jpg" src="../_images/sampler_multijitter_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Correlated Multi-Jittered sampler - 16 samples per pixel</span><a class="headerlink" href="#id110" title="Permalink to this image">¶</a></p>
</div>
</div><div class="figure compound align-center" id="fig-multijitter-pattern">
<div style="width: 49%" class="subfigure align-center" id="id111">
<a class="reference internal image-reference" href="../_images/multijitter_1024_samples.svg"><img alt="../_images/multijitter_1024_samples.svg" src="../_images/multijitter_1024_samples.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1024 samples projected onto the first two dimensions.</span><a class="headerlink" href="#id111" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id112">
<a class="reference internal image-reference" href="../_images/multijitter_64_samples_and_proj.svg"><img alt="../_images/multijitter_64_samples_and_proj.svg" src="../_images/multijitter_64_samples_and_proj.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">64 samples projected onto the first two dimensions and their projection on both 1D axis
(top and right plot). As expected, the samples are well stratified both in 2D and 1D.</span><a class="headerlink" href="#id112" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="orthogonal-array-sampler-orthogonal">
<span id="sampler-orthogonal"></span><span id="fig-multijitter-pattern"></span><h2>Orthogonal Array sampler (<span class="monosp">orthogonal</span>)<a class="headerlink" href="#orthogonal-array-sampler-orthogonal" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">sample_count</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Number of samples per pixel. This value has to be the square of a prime number. (Default: 4)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">strength</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Orthogonal array’s strength (Default: 2)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">seed</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Seed offset (Default: 0)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">jitter</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>Adds additional random jitter withing the substratum (Default: True)</p></td>
</tr>
</tbody>
</table>
<p>This plugin implements the Orthogonal Array sampler generator introduced by Jarosz et al.
<a class="bibtex reference internal" href="../zz_bibliography.html#jarosz19orthogonal" id="id26">[JEK+19]</a>. It generalizes correlated multi-jittered sampling to higher dimensions
by using <em>orthogonal arrays (OAs)</em>. An OA of strength <span class="math notranslate nohighlight">\(s\)</span> has the property that projecting
the generated samples to any combination of <span class="math notranslate nohighlight">\(s\)</span> dimensions will always result in a well
stratified pattern. In other words, when <span class="math notranslate nohighlight">\(s=2\)</span> (default value), the high-dimentional samples
are simultaneously stratified in all 2D projections as if they had been produced by correlated
multi-jittered sampling. By construction, samples produced by this generator are also well
stratified when projected on both 1D axis.</p>
<p>This sampler supports OA of strength other than 2, although this isn’t recommended as the
stratification of 2D projections of those samples wouldn’t be ensured anymore.</p>
<div class="figure compound align-center" id="fig-orthogonal-renders">
<div style="width: 49%" class="subfigure align-center" id="id113">
<a class="reference internal image-reference" href="../_images/sampler_independent_25spp.jpg"><img alt="../_images/sampler_independent_25spp.jpg" src="../_images/sampler_independent_25spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Independent sampler - 25 samples per pixel</span><a class="headerlink" href="#id113" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id114">
<a class="reference internal image-reference" href="../_images/sampler_orthogonal_25spp.jpg"><img alt="../_images/sampler_orthogonal_25spp.jpg" src="../_images/sampler_orthogonal_25spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Orthogonal Array sampler - 25 samples per pixel</span><a class="headerlink" href="#id114" title="Permalink to this image">¶</a></p>
</div>
</div><div class="figure compound align-center" id="fig-orthogonal-pattern">
<div style="width: 49%" class="subfigure align-center" id="id115">
<a class="reference internal image-reference" href="../_images/orthogonal_1369_samples.svg"><img alt="../_images/orthogonal_1369_samples.svg" src="../_images/orthogonal_1369_samples.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1369 samples projected onto the first two dimensions.</span><a class="headerlink" href="#id115" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id116">
<a class="reference internal image-reference" href="../_images/orthogonal_49_samples_and_proj.svg"><img alt="../_images/orthogonal_49_samples_and_proj.svg" src="../_images/orthogonal_49_samples_and_proj.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">49 samples projected onto the first two dimensions and their
projection on both 1D axis (top and right plot). The pattern is well stratified
in both 2D and 1D projections. This is true for every pair of dimensions of the
high-dimentional samples.</span><a class="headerlink" href="#id116" title="Permalink to this image">¶</a></p>
</div>
</div></div>
<div class="section" id="low-discrepancy-sampler-ldsampler">
<span id="sampler-ldsampler"></span><span id="fig-orthogonal-pattern"></span><h2>Low discrepancy sampler (<span class="monosp">ldsampler</span>)<a class="headerlink" href="#low-discrepancy-sampler-ldsampler" title="Permalink to this headline">¶</a></h2>
<p>This plugin implements a simple hybrid sampler that combines aspects of a Quasi-Monte Carlo sequence
with a pseudorandom number generator based on a technique proposed by Kollig and Keller
<a class="bibtex reference internal" href="../zz_bibliography.html#kollig2002efficient" id="id27">[KK02]</a>. It is a good and fast general-purpose sample generator. Other QMC
samplers exist that can generate even better distributed samples, but this comes at a higher
cost in terms of performance. This plugin is based on Mitsuba 1’s default sampler (also called
<span class="monosp">ldsampler</span>).</p>
<p>Roughly, the idea of this sampler is that all of the individual 2D sample dimensions are first
filled using the same (0, 2)-sequence, which is then randomly scrambled and permuted using a
shuffle network. The name of this plugin stems from the fact that, by construction,
(0, 2)-sequences achieve a low
<a class="reference external" href="https://en.wikipedia.org/wiki/Low-discrepancy_sequence">star discrepancy</a>,
which is a quality criterion on their spatial distribution.</p>
<div class="figure compound align-center" id="fig-ldsampler-renders">
<div style="width: 49%" class="subfigure align-center" id="id117">
<a class="reference internal image-reference" href="../_images/sampler_independent_16spp.jpg"><img alt="../_images/sampler_independent_16spp.jpg" src="../_images/sampler_independent_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Independent sampler - 16 samples per pixel</span><a class="headerlink" href="#id117" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id118">
<a class="reference internal image-reference" href="../_images/sampler_ldsampler_16spp.jpg"><img alt="../_images/sampler_ldsampler_16spp.jpg" src="../_images/sampler_ldsampler_16spp.jpg" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">Low-discrepancy sampler - 16 samples per pixel</span><a class="headerlink" href="#id118" title="Permalink to this image">¶</a></p>
</div>
</div><div class="figure compound align-center" id="fig-ldsampler-pattern">
<div style="width: 49%" class="subfigure align-center" id="id119">
<a class="reference internal image-reference" href="../_images/ldsampler_1024_samples.svg"><img alt="../_images/ldsampler_1024_samples.svg" src="../_images/ldsampler_1024_samples.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1024 samples projected onto the first two dimensions.</span><a class="headerlink" href="#id119" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id120">
<a class="reference internal image-reference" href="../_images/ldsampler_64_samples_and_proj.svg"><img alt="../_images/ldsampler_64_samples_and_proj.svg" src="../_images/ldsampler_64_samples_and_proj.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">A projection of the first 64 samples onto the first two dimensions and their
projection on both 1D axis (top and right plot). The 1D stratification is perfect as
this sampler doesn’t add additional random perturbation to the sample positions.</span><a class="headerlink" href="#id120" title="Permalink to this image">¶</a></p>
</div>
</div><div class="figure compound align-center" id="fig-ldsampler-pattern_dim32">
<div style="width: 49%" class="subfigure align-center" id="id121">
<a class="reference internal image-reference" href="../_images/ldsampler_1024_samples_dim_32.svg"><img alt="../_images/ldsampler_1024_samples_dim_32.svg" src="../_images/ldsampler_1024_samples_dim_32.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">1024 samples projected onto the 32th and 33th dimensions, which look almost identical.
However, note that the points have been scrambled to reduce correlations between
dimensions.</span><a class="headerlink" href="#id121" title="Permalink to this image">¶</a></p>
</div>
<div style="width: 49%" class="subfigure align-center" id="id122">
<a class="reference internal image-reference" href="../_images/ldsampler_64_samples_and_proj_dim_32.svg"><img alt="../_images/ldsampler_64_samples_and_proj_dim_32.svg" src="../_images/ldsampler_64_samples_and_proj_dim_32.svg" width="95%" /></a>
<p class="caption"><span class="caption-text">A projection of the first 64 samples onto the 32th and 33th dimensions.</span><a class="headerlink" href="#id122" title="Permalink to this image">¶</a></p>
</div>
</div></div>
</div>
<div class="section" id="sec-films">
<span id="fig-ldsampler-pattern_dim32"></span><span id="id28"></span><h1>胶片<a class="headerlink" href="#sec-films" title="Permalink to this headline">¶</a></h1>
<p>film 定义了如何存储所进行的测量并将其转换为最终的输出文件，该文件将在渲染过程结束时写入磁盘。</p>
<p>在 XML 场景描述语言中，一个常规的 film 配置应该看上去如下所示：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scene</span> <span class="na">version=</span><span class="s">2.0.0</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- .. scene contents --&gt;</span>

    <span class="nt">&lt;sensor</span> <span class="na">type=</span><span class="s">&quot;.. sensor type ..&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- .. sensor parameters .. --&gt;</span>

        <span class="c">&lt;!-- Write to a high dynamic range EXR image --&gt;</span>
        <span class="nt">&lt;film</span> <span class="na">type=</span><span class="s">&quot;hdrfilm&quot;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- Specify the desired resolution (e.g. full HD) --&gt;</span>
            <span class="nt">&lt;integer</span> <span class="na">name=</span><span class="s">&quot;width&quot;</span> <span class="na">value=</span><span class="s">&quot;1920&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;integer</span> <span class="na">name=</span><span class="s">&quot;height&quot;</span> <span class="na">value=</span><span class="s">&quot;1080&quot;</span><span class="nt">/&gt;</span>

            <span class="c">&lt;!-- Use a Gaussian reconstruction filter. For details</span>
<span class="c">                 on these, refor to the next subsection --&gt;</span>
            <span class="nt">&lt;rfilter</span> <span class="na">type=</span><span class="s">&quot;gaussian&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/film&gt;</span>
    <span class="nt">&lt;/sensor&gt;</span>
<span class="nt">&lt;/scene&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;film&gt;</span></code> 插件应该嵌套在 <code class="docutils literal notranslate"><span class="pre">&lt;sensor&gt;</span></code> 声明中实例化。请注意输出文件名是不指定的，它从场景文件名自动推断出来，
同时也可以在命令行渲染时通过将配置参数 <code class="docutils literal notranslate"><span class="pre">-o</span></code> 传递给 <code class="docutils literal notranslate"><span class="pre">mitsuba</span></code> 可执行文件来手动覆盖。</p>
<div class="section" id="high-dynamic-range-film-hdrfilm">
<span id="film-hdrfilm"></span><h2>High dynamic range film (<span class="monosp">hdrfilm</span>)<a class="headerlink" href="#high-dynamic-range-film-hdrfilm" title="Permalink to this headline">¶</a></h2>
<table class="paramstable docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="paramtype">width, height</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>Width and height of the camera sensor in pixels Default: 768, 576)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">file_format</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Denotes the desired output file format. The options are <span class="monosp">openexr</span>
(for ILM’s OpenEXR format), <span class="monosp">rgbe</span> (for Greg Ward’s RGBE format), or
<span class="monosp">pfm</span> (for the Portable Float Map format). (Default: <span class="monosp">openexr</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">pixel_format</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies the desired pixel format of output images. The options are <span class="monosp">luminance</span>,
<span class="monosp">luminance_alpha</span>, <span class="monosp">rgb</span>, <span class="monosp">rgba</span>, <span class="monosp">xyz</span> and <span class="monosp">xyza</span>.
(Default: <span class="monosp">rgba</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">component_format</span></p></td>
<td><p><span class="paramtype">string</span></p></td>
<td><p>Specifies the desired floating  point component format of output images. The options are
<span class="monosp">float16</span>, <span class="monosp">float32</span>, or <span class="monosp">uint32</span>. (Default: <span class="monosp">float16</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">crop_offset_y, crop_offset_y, crop_width, crop_height</span></p></td>
<td><p><span class="paramtype">integer</span></p></td>
<td><p>These parameters can optionally be provided to select a sub-rectangle
of the output. In this case, only the requested regions
will be rendered. (Default: Unused)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="paramtype">high_quality_edges</span></p></td>
<td><p><span class="paramtype">boolean</span></p></td>
<td><p>If set to <span class="monosp">true</span>, regions slightly outside of the film plane will also be sampled. This may
improve the image quality at the edges, especially when using very large reconstruction
filters. In general, this is not needed though. (Default: <span class="monosp">false</span>, i.e. disabled)</p></td>
</tr>
<tr class="row-even"><td><p><span class="paramtype">(Nested plugin)</span></p></td>
<td><p><span class="paramtype">rfilter</span></p></td>
<td><p>Reconstruction filter that should be used by the film. (Default: <span class="monosp">gaussian</span>, a windowed
Gaussian filter)</p></td>
</tr>
</tbody>
</table>
<p>This is the default film plugin that is used when none is explicitly specified. It stores the
captured image as a high dynamic range OpenEXR file and tries to preserve the rendering as much as
possible by not performing any kind of post processing, such as gamma correction—the output file
will record linear radiance values.</p>
<p>When writing OpenEXR files, the film will either produce a luminance, luminance/alpha, RGB(A),
or XYZ(A) tristimulus bitmap having a <span class="monosp">float16</span>,
<span class="monosp">float32</span>, or <span class="monosp">uint32</span>-based internal representation based on the chosen parameters.
The default configuration is RGBA with a <span class="monosp">float16</span> component format, which is appropriate for
most purposes.</p>
<p>For OpenEXR files, Mitsuba 2 also supports fully general multi-channel output; refer to
the <a class="reference internal" href="#integrator-aov"><span class="std std-ref">aov</span></a> or <a class="reference internal" href="#integrator-stokes"><span class="std std-ref">stokes</span></a> plugins for
details on how this works.</p>
<p>The plugin can also write RLE-compressed files in the Radiance RGBE format pioneered by Greg Ward
(set <span class="monosp">file_format=rgbe</span>), as well as the Portable Float Map format
(set <span class="monosp">file_format=pfm</span>). In the former case, the <span class="monosp">component_format</span> and
<span class="monosp">pixel_format</span> parameters are ignored, and the output is <span class="monosp">float8</span>-compressed RGB
data. PFM output is restricted to <span class="monosp">float32</span>-valued images using the <span class="monosp">rgb</span> or
<span class="monosp">luminance</span> pixel formats. Due to the superior accuracy and adoption of OpenEXR, the use of
these two alternative formats is discouraged however.</p>
<p>When RGB(A) output is selected, the measured spectral power distributions are
converted to linear RGB based on the CIE 1931 XYZ color matching curves and
the ITU-R Rec. BT.709-3 primaries with a D65 white point.</p>
<p>The following XML snippet discribes a film that writes a full-HD RGBA OpenEXR file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;film</span> <span class="na">type=</span><span class="s">&quot;hdrfilm&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;pixel_format&quot;</span> <span class="na">value=</span><span class="s">&quot;rgba&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;integer</span> <span class="na">name=</span><span class="s">&quot;width&quot;</span> <span class="na">value=</span><span class="s">&quot;1920&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;integer</span> <span class="na">name=</span><span class="s">&quot;height&quot;</span> <span class="na">value=</span><span class="s">&quot;1080&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/film&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sec-rfilters">
<span id="id29"></span><h1>重构滤波器<a class="headerlink" href="#sec-rfilters" title="Permalink to this headline">¶</a></h1>
<p>图像重构滤波器（Image reconstruction filter）负责将 sampler 和 integrator 共同生成的一系列辐射度样本转换为最终输出图像，并在渲染过程结束时写入磁盘。
本节给出了 Mitsuba 中可用重构滤波器的一个简明概览。没有一种普遍来讲更好的滤波器，最终的选择在于锐度、振铃和走样以及计算效率之间的权衡。</p>
<p>重建滤波器的理想特性是它能在要求的图像分辨率下清晰地捕捉到所有的细节，同时避免走样和振铃现象。走样是不正确的以低频采样高频细节，
而振铃则表示不连续点附近的振荡图像误差，如 light-shadow transiton。</p>
<div class="section" id="box-filter-box">
<span id="rfilter-box"></span><h2>Box filter (<span class="monosp">box</span>)<a class="headerlink" href="#box-filter-box" title="Permalink to this headline">¶</a></h2>
<p>This is the fastest, but also about the worst possible reconstruction filter,
since it is prone to severe aliasing. It is included mainly for completeness,
though some rare situations may warrant its use.</p>
</div>
<div class="section" id="tent-filter-tent">
<span id="rfilter-tent"></span><h2>Tent filter (<span class="monosp">tent</span>)<a class="headerlink" href="#tent-filter-tent" title="Permalink to this headline">¶</a></h2>
<p>Simple tent (triangular) filter. This reconstruction filter never suffers
from ringing and usually causes less aliasing than a naive box filter. When
rendering scenes with sharp brightness discontinuities, this may be useful;
otherwise, negative-lobed filters may be preferable (e.g. Mitchell-Netravali
or Lanczos Sinc).</p>
</div>
<div class="section" id="gaussian-filter-gaussian">
<span id="rfilter-gaussian"></span><h2>Gaussian filter (<span class="monosp">gaussian</span>)<a class="headerlink" href="#gaussian-filter-gaussian" title="Permalink to this headline">¶</a></h2>
<p>This is a windowed Gaussian filter with configurable standard deviation.
It often produces pleasing results, and never suffers from ringing, but may
occasionally introduce too much blurring.</p>
<p>When no reconstruction filter is explicitly requested, this is the default
choice in Mitsuba.</p>
<p>Takes a standard deviation parameter (<span class="paramtype">stddev</span>) which is set to 0.5
pixels be default.</p>
</div>
<div class="section" id="mitchell-filter-mitchell">
<span id="rfilter-mitchell"></span><h2>Mitchell filter (<span class="monosp">mitchell</span>)<a class="headerlink" href="#mitchell-filter-mitchell" title="Permalink to this headline">¶</a></h2>
<p>Separable cubic spline reconstruction filter by Mitchell and Netravali <a class="bibtex reference internal" href="../zz_bibliography.html#mitchellnetravali88" id="id30">[MN88]</a>.
This is often a good compromise between sharpness and ringing.</p>
<p>This plugin has two <span class="paramtype">float</span>-valued parameters <span class="paramtype">B</span> and
<span class="paramtype">C</span> that correspond to the two parameters in the original paper.
By default, these are set to the recommended value of <span class="math notranslate nohighlight">\(1/3\)</span>, but can be
tweaked if desired.</p>
</div>
<div class="section" id="catmull-rom-filter-catmullrom">
<span id="rfilter-catmullrom"></span><h2>Catmull-Rom filter (<span class="monosp">catmullrom</span>)<a class="headerlink" href="#catmull-rom-filter-catmullrom" title="Permalink to this headline">¶</a></h2>
<p>Special version of the Mitchell-Netravali filter with constants B and C configured
to match the Catmull-Rom spline. It usually does a better job at at preserving sharp
features at the cost of more ringing.</p>
</div>
<div class="section" id="lanczos-filter-lanczos">
<span id="rfilter-lanczos"></span><h2>Lanczos filter (<span class="monosp">lanczos</span>)<a class="headerlink" href="#lanczos-filter-lanczos" title="Permalink to this headline">¶</a></h2>
<p>This is a windowed version of the theoretically optimal low-pass filter. It
is generally one of the best available filters in terms of producing sharp
high-quality output. Its main disadvantage is that it produces strong ringing
around discontinuities, which can become a serious problem when rendering
bright objects with sharp edges (a directly visible light source will for
instance have black fringing artifacts around it). This is also the
computationally slowest reconstruction filter.</p>
<p>This plugin has an <span class="paramtype">integer</span>-valued parameter named
<span class="paramtype">lobes</span>, that sets the desired number of filter side-lobes. The
higher, the closer the filter will approximate an optimal low-pass filter, but
this also increases ringing. Values of 2 or 3 are common (3 is the default).</p>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="../src/plugin_reference/intro.html" title="previous chapter (use the left arrow)">Plugin 参考</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="../src/api_reference/intro.html" title="next chapter (use the right arrow)">Introduction</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../src/api_reference/intro.html" title="Introduction"
             >next</a> |</li>
        <li class="right" >
          <a href="../src/plugin_reference/intro.html" title="Plugin 参考"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mitsuba2 0.1.dev0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">形状插件 Shape</a></li> 
      </ul>
    </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>